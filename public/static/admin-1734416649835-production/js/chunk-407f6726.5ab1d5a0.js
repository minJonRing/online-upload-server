(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-407f6726"],{"0e40":function(e,t,i){"use strict";i("a1af")},"14a4":function(e,t,i){},3346:function(e,t,i){"use strict";i("14a4")},"5de8":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"project"},[i("el-form",{ref:"search",attrs:{model:e.search,inline:""}},[i("el-form-item",{attrs:{label:"企业名称"}},[i("el-select",{attrs:{"value-key":"value",placeholder:"请选择",clearable:""},model:{value:e.search.companyId,callback:function(t){e.$set(e.search,"companyId",t)},expression:"search.companyId"}},e._l(e.list.company,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),i("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(t){return e.handleAddOrEdit({handle:"add"})}}},[e._v("新增项目")])],1)],1),i("el-table",{attrs:{data:e.table,border:""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("div",{staticClass:"box"},e._l(n.files,(function(t,r){return i("div",{key:r,staticClass:"item"},[i("div",{staticClass:"w"},[i("span",[e._v(e._s(r+1)+". 版本号： "+e._s(t.version)+" ")]),i("span",{staticStyle:{color:"#1890ff"}},[e._v("创建时间："+e._s(t.createdTime))])]),i("div",{staticClass:"edit"},[i("el-button",{attrs:{type:"text",icon:"el-icon-document"},on:{click:function(i){return e.handleSeeVersion(t)}}}),e._t("tableBtns",null,{data:{row:n}}),i("el-popconfirm",{staticClass:"ml10",attrs:{title:"确定删除？",placement:"top"},on:{confirm:function(i){return e.handleDeleteVersion(n,t)}}},[i("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text",icon:"el-icon-delete"},slot:"reference"})],1)],2)])})),0)]}}],null,!0)}),i("el-table-column",{attrs:{label:"名称",prop:"name"}}),i("el-table-column",{attrs:{label:"唯一编码",prop:"sign"}}),i("el-table-column",{attrs:{label:"创建时间",prop:"createdTime",width:"200"}}),i("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAddVersion(n)}}},[e._v(" 新增版本 ")]),i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAddOrEdit({handle:"edit",data:n})}}},[e._v(" 编辑 ")]),e._t("tableBtns",null,{data:{row:n}}),i("el-popconfirm",{staticClass:"ml10",attrs:{title:"确定删除？",placement:"top"},on:{confirm:function(t){return e.handleDelete(n)}}},[i("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(" 删除 ")])],1)]}}],null,!0)})],1),i("el-dialog",{attrs:{title:"新增/编辑",visible:e.isShow,width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[i("div",{staticStyle:{"padding-top":"18px"}},[i("el-form",{ref:"form",attrs:{model:e.editForm,rules:e.editRules}},[i("el-form-item",{attrs:{label:"企业",prop:"companyId"}},[i("el-select",{staticClass:"w100",attrs:{"value-key":"value",placeholder:"请选择",clearable:"",filterable:""},model:{value:e.editForm.companyId,callback:function(t){e.$set(e.editForm,"companyId",t)},expression:"editForm.companyId"}},e._l(e.list.company,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),i("el-form-item",{attrs:{label:"唯一标识",prop:"sign"}},[i("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.editForm.sign,callback:function(t){e.$set(e.editForm,"sign",t)},expression:"editForm.sign"}})],1),i("el-form-item",{attrs:{label:"简介",prop:"describe"}},[i("el-input",{attrs:{type:"textarea",rows:"2",placeholder:"请输入",clearable:""},model:{value:e.editForm.describe,callback:function(t){e.$set(e.editForm,"describe",t)},expression:"editForm.describe"}})],1)],1)],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.isShow=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleComfirn}},[e._v("确认")])],1)]),i("el-dialog",{attrs:{title:"新增",visible:e.isVersion,width:"600px"},on:{"update:visible":function(t){e.isVersion=t}}},[i("div",{staticStyle:{"padding-top":"18px"}},[i("el-form",{ref:"version",attrs:{model:e.versionForm,rules:e.versionRules}},[i("el-form-item",{attrs:{label:"版本",prop:"version"}},[i("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.versionForm.version,callback:function(t){e.$set(e.versionForm,"version",t)},expression:"versionForm.version"}})],1),i("el-form-item",{attrs:{label:"build",prop:"build"}},[i("div",{staticStyle:{display:"inline-block",width:"100%",height:"28px"}},[i("UploadFile",{attrs:{url:"/upload/electron/build"},model:{value:e.versionForm.build,callback:function(t){e.$set(e.versionForm,"build",t)},expression:"versionForm.build"}})],1)]),i("el-form-item",{attrs:{label:"renderer",prop:"renderer"}},[i("div",{staticStyle:{display:"inline-block",width:"100%",height:"28px"}},[i("UploadFile",{attrs:{url:"/upload/electron/renderer"},model:{value:e.versionForm.renderer,callback:function(t){e.$set(e.versionForm,"renderer",t)},expression:"versionForm.renderer"}})],1)]),i("el-form-item",{attrs:{label:"dist",prop:"dist"}},[i("div",{staticStyle:{display:"inline-block",width:"100%",height:"28px"}},[i("UploadFile",{attrs:{url:"/upload/electron/static"},model:{value:e.versionForm.dist,callback:function(t){e.$set(e.versionForm,"dist",t)},expression:"versionForm.dist"}})],1)]),i("el-form-item",{attrs:{label:"views",prop:"views"}},[i("div",{staticStyle:{display:"inline-block",width:"100%",height:"28px"}},[i("UploadFile",{attrs:{url:"/upload/electron/views"},model:{value:e.versionForm.views,callback:function(t){e.$set(e.versionForm,"views",t)},expression:"versionForm.views"}})],1)]),i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{type:"textarea",rows:"2",placeholder:"请输入",clearable:""},model:{value:e.versionForm.describe,callback:function(t){e.$set(e.versionForm,"describe",t)},expression:"versionForm.describe"}})],1)],1)],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.isVersion=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleComfirnVersion}},[e._v("确认")])],1)]),i("el-dialog",{attrs:{title:"版本信息",visible:e.isDescriptions,width:"900px"},on:{"update:visible":function(t){e.isDescriptions=t}}},[i("div",{staticStyle:{padding:"12px 0"}},[i("el-descriptions",{attrs:{column:2,border:"",labelStyle:{width:"100px"}}},[i("el-descriptions-item",{attrs:{label:"版本号",span:"2"}},[e._v(e._s(e.descriptions.version))]),i("el-descriptions-item",{attrs:{label:"描述",span:"2"}},[e._v(e._s(e.descriptions.describe))]),i("el-descriptions-item",{attrs:{label:"build"}},[e._v(e._s(e.descriptions.build))]),i("el-descriptions-item",{attrs:{label:"renderer"}},[e._v(e._s(e.descriptions.renderer))]),i("el-descriptions-item",{attrs:{label:"dist"}},[e._v(e._s(e.descriptions.dist))]),i("el-descriptions-item",{attrs:{label:"views"}},[e._v(e._s(e.descriptions.views))]),i("el-descriptions-item",{attrs:{label:"创建时间",span:"2"}},[e._v(e._s(e.descriptions.createdTime))])],1)],1)])],1)},r=[],l=i("5530"),a=(i("4ec9"),i("b64b"),i("d3b7"),i("6062"),i("0eb6"),i("b7ef"),i("8bd4"),i("ad1f"),i("d81d"),i("ac1f"),i("841c"),i("14d9"),i("2f62")),o=i("4279"),s=i("0238"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"e-upload"},[i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"e-avatar-uploader",attrs:{"show-file-list":!1,"element-loading-text":e.progress+"%",action:"#","before-upload":e.beforeAvatarUpload,"http-request":e.handleUploadLearnSignVoucherFileChange,"attr-icon":"注:只能上传"+e.type.join()}},[e.filePath?i("div",{staticClass:"file"},[e._v(e._s(e.filePath))]):i("i",{staticClass:"el-icon el-icon-upload2"})])],1)},d=[],u=(i("a9e3"),i("4de4"),i("00b4"),i("4d63"),i("c607"),i("2c3e"),i("25f0"),i("5319"),i("b0c0"),i("a15b"),{name:"UploadProT",props:{model:s["rulesT"].Any,read:s["rulesT"].Boolean,url:s["rulesT"].String,deleteUrl:s["rulesT"].String,type:{type:Array,default:function(){return["zip"]}},size:{type:Number,default:80},param:s["rulesT"].Object,filterData:{type:Function},auto:{type:Boolean,default:!1}},model:{prop:"model",event:"change"},data:function(){return{loading:!1,progress:0,cwidth:this.width}},computed:Object(l["a"])({filePath:{get:function(){return this.model},set:function(e){this.$emit("change",e)}}},Object(a["b"])(["local"])),created:function(){},methods:{beforeAvatarUpload:function(e){var t=this.type.filter((function(t){return new RegExp(t).test(e.type)||t===e.name.replace(/.+(?=\.)|\./g,"")})).length>0,i=e.size/1024/1024<this.size;return t||this.$message.error("请上传格式正确的文件 [ ".concat(this.type.join(",")," ] ")),i||this.$message.error("上传文件大小不能超过".concat(this.size,"MB!")),t&&i},handleUploadLearnSignVoucherFileChange:function(e){var t=this;this.$global.loading=!0;var i=e.file,n=new FormData;n.append("file",i);var r=Object.keys(this.param);r.length&&r.map((function(e){n.append(e,t.param[e])})),this.$AJAX({url:this.url,method:"post",data:n,onUploadProgress:function(e){var i=e.loaded,n=e.total;t.progress=Math.ceil(i/n*100)}}).then((function(e){var i=e.data,n=i[0].filePath;t.filePath=n})).finally((function(){t.$global.loading=!1}))},handleDelete:function(e,t){this.filePath=""}}}),p=u,m=(i("0e40"),i("2877")),f=Object(m["a"])(p,c,d,!1,null,"652c85f6",null),h=f.exports,b={name:"ProjectIndex",props:{noBtns:{type:Array,default:function(){return[]}},otherBtns:s["rulesT"].Array,selection:s["rulesT"].Array},components:{UploadFile:h},data:function(){return{search:{companyId:""},pages:{pageNum:1,pageSize:10,total:0},list:{company:[]},table:[],isShow:!1,editForm:{companyId:"",name:"",sign:"",describe:""},editRules:{companyId:s["change"],name:s["blur"],sign:s["blur"]},editFormInit:{},isVersion:!1,versionParent:{},versionForm:{version:"",describe:"",build:"",renderer:"",dist:"",views:""},versionRules:{version:s["blur"]},versionFormInit:{},isDescriptions:!1,descriptions:{version:"",describe:"",build:"",renderer:"",dist:"",views:""}}},computed:Object(l["a"])({},Object(a["b"])([])),created:function(){this.editFormInit=structuredClone(this.editForm),this.versionFormInit=structuredClone(this.versionForm),this.getCompany(),this.handleSearch()},methods:{getCompany:function(){var e=this;Object(o["a"])({url:"/company"}).then((function(t){var i=t.data;e.list.company=i.map((function(e){var t=e._id,i=e.company;return{label:i,value:t}}))}))},handleSearch:function(){var e=this;this.$global.loading=!0,Object(o["a"])({url:"/project",data:Object(l["a"])(Object(l["a"])({},this.search),this.pages)}).then((function(t){var i=t.data,n=i.data,r=i.total;e.table=n,e.pages.total=r})).finally((function(){e.$global.loading=!1}))},handleAddVersion:function(e){this.versionParent=structuredClone(e),this.versionForm=structuredClone(this.versionFormInit),this.isVersion=!0},handleAddOrEdit:function(e){var t=e.handle,i=e.data,n=i;"add"===t&&(n=structuredClone(this.editFormInit)),this.editForm=structuredClone(n),this.isShow=!0},handleDelete:function(e){var t=this,i=e._id;this.$global.loading=!0,Object(o["a"])({url:"/project/".concat(i),method:"delete"}).then((function(){t.$notify.success("删除成功"),t.handleSearch()})).finally((function(){t.$global.loading=!1}))},getData:function(e){this.$emit("getData",e)},handleComfirn:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$notify.warning("必填项未填写完整，请检查！"),!1;e.$global.loading=!0;var i=e.editForm._id;if(i){var n=e.editForm,r=n.icon,l=n.background,a=n.company,s=n.describe,c={icon:r,background:l,company:a,describe:s};Object(o["a"])({url:"/project/".concat(i),method:"put",data:c}).then((function(){e.handleSearch(),e.isShow=!1})).finally((function(){e.$global.loading=!1}))}else Object(o["a"])({url:"/project",method:"post",data:e.editForm}).then((function(){e.handleSearch(),e.isShow=!1})).finally((function(){e.$global.loading=!1}))}))},handleSeeVersion:function(e){this.descriptions=structuredClone(e),this.isDescriptions=!0},handleDeleteVersion:function(e,t){var i=this;this.$global.loading=!0;var n=e._id,r=t._id;Object(o["a"])({url:"/project/files/".concat(n),method:"put",data:{versionId:r}}).then((function(){i.handleSearch()})).finally((function(){i.$global.loading=!1}))},handleComfirnVersion:function(){var e=this;this.$refs.version.validate((function(t){if(!t)return e.$notify.warning("必填项未填写完整，请检查！"),!1;e.$global.loading=!0;var i=e.versionParent._id;e.versionParent.files.push(e.versionForm),Object(o["a"])({url:"/project/".concat(i),method:"put",data:e.versionParent}).then((function(){e.isVersion=!1,e.handleSearch()})).finally((function(){e.$global.loading=!1}))}))}}},v=b,g=(i("3346"),Object(m["a"])(v,n,r,!1,null,"2e497289",null));t["default"]=g.exports},a1af:function(e,t,i){}}]);