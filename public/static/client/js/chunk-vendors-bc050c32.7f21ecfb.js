(self["webpackChunkd1"]=self["webpackChunkd1"]||[]).push([[277],{1576:function(e){!function(t,i){e.exports=i()}(0,(function(){"use strict";var e=1e3,t=6e4,i=36e5,r="millisecond",n="second",o="minute",a="hour",s="day",l="week",h="month",d="quarter",u="year",c="date",g="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],i=e%100;return"["+e+(t[(i-20)%10]||t[i]||t[0])+"]"}},v=function(e,t,i){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(i)+e},_={s:v,z:function(e){var t=-e.utcOffset(),i=Math.abs(t),r=Math.floor(i/60),n=i%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(n,2,"0")},m:function e(t,i){if(t.date()<i.date())return-e(i,t);var r=12*(i.year()-t.year())+(i.month()-t.month()),n=t.clone().add(r,h),o=i-n<0,a=t.clone().add(r+(o?-1:1),h);return+(-(r+(i-n)/(o?n-a:a-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:h,y:u,w:l,d:s,D:c,h:a,m:o,s:n,ms:r,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",x={};x[y]=m;var w="$isDayjsObject",A=function(e){return e instanceof D||!(!e||!e[w])},S=function e(t,i,r){var n;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();x[o]&&(n=o),i&&(x[o]=i,n=o);var a=t.split("-");if(!n&&a.length>1)return e(a[0])}else{var s=t.name;x[s]=t,n=s}return!r&&n&&(y=n),n||!r&&y},b=function(e,t){if(A(e))return e.clone();var i="object"==typeof t?t:{};return i.date=e,i.args=arguments,new D(i)},M=_;M.l=S,M.i=A,M.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var D=function(){function m(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var v=m.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,i=e.utc;if(null===t)return new Date(NaN);if(M.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var n=r[2]-1||0,o=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return M},v.isValid=function(){return!(this.$d.toString()===g)},v.isSame=function(e,t){var i=b(e);return this.startOf(t)<=i&&i<=this.endOf(t)},v.isAfter=function(e,t){return b(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<b(e)},v.$g=function(e,t,i){return M.u(e)?this[t]:this.set(i,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var i=this,r=!!M.u(t)||t,d=M.p(e),g=function(e,t){var n=M.w(i.$u?Date.UTC(i.$y,t,e):new Date(i.$y,t,e),i);return r?n:n.endOf(s)},p=function(e,t){return M.w(i.toDate()[e].apply(i.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),i)},f=this.$W,m=this.$M,v=this.$D,_="set"+(this.$u?"UTC":"");switch(d){case u:return r?g(1,0):g(31,11);case h:return r?g(1,m):g(0,m+1);case l:var y=this.$locale().weekStart||0,x=(f<y?f+7:f)-y;return g(r?v-x:v+(6-x),m);case s:case c:return p(_+"Hours",0);case a:return p(_+"Minutes",1);case o:return p(_+"Seconds",2);case n:return p(_+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var i,l=M.p(e),d="set"+(this.$u?"UTC":""),g=(i={},i[s]=d+"Date",i[c]=d+"Date",i[h]=d+"Month",i[u]=d+"FullYear",i[a]=d+"Hours",i[o]=d+"Minutes",i[n]=d+"Seconds",i[r]=d+"Milliseconds",i)[l],p=l===s?this.$D+(t-this.$W):t;if(l===h||l===u){var f=this.clone().set(c,1);f.$d[g](p),f.init(),this.$d=f.set(c,Math.min(this.$D,f.daysInMonth())).$d}else g&&this.$d[g](p);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[M.p(e)]()},v.add=function(r,d){var c,g=this;r=Number(r);var p=M.p(d),f=function(e){var t=b(g);return M.w(t.date(t.date()+Math.round(e*r)),g)};if(p===h)return this.set(h,this.$M+r);if(p===u)return this.set(u,this.$y+r);if(p===s)return f(1);if(p===l)return f(7);var m=(c={},c[o]=t,c[a]=i,c[n]=e,c)[p]||1,v=this.$d.getTime()+r*m;return M.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,i=this.$locale();if(!this.isValid())return i.invalidDate||g;var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=M.z(this),o=this.$H,a=this.$m,s=this.$M,l=i.weekdays,h=i.months,d=i.meridiem,u=function(e,i,n,o){return e&&(e[i]||e(t,r))||n[i].slice(0,o)},c=function(e){return M.s(o%12||12,e,"0")},p=d||function(e,t,i){var r=e<12?"AM":"PM";return i?r.toLowerCase():r};return r.replace(f,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return M.s(t.$y,4,"0");case"M":return s+1;case"MM":return M.s(s+1,2,"0");case"MMM":return u(i.monthsShort,s,h,3);case"MMMM":return u(h,s);case"D":return t.$D;case"DD":return M.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(i.weekdaysMin,t.$W,l,2);case"ddd":return u(i.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return M.s(o,2,"0");case"h":return c(1);case"hh":return c(2);case"a":return p(o,a,!0);case"A":return p(o,a,!1);case"m":return String(a);case"mm":return M.s(a,2,"0");case"s":return String(t.$s);case"ss":return M.s(t.$s,2,"0");case"SSS":return M.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,c,g){var p,f=this,m=M.p(c),v=b(r),_=(v.utcOffset()-this.utcOffset())*t,y=this-v,x=function(){return M.m(f,v)};switch(m){case u:p=x()/12;break;case h:p=x();break;case d:p=x()/3;break;case l:p=(y-_)/6048e5;break;case s:p=(y-_)/864e5;break;case a:p=y/i;break;case o:p=y/t;break;case n:p=y/e;break;default:p=y}return g?p:M.a(p)},v.daysInMonth=function(){return this.endOf(h).$D},v.$locale=function(){return x[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var i=this.clone(),r=S(e,t,!0);return r&&(i.$L=r),i},v.clone=function(){return M.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},m}(),T=D.prototype;return b.prototype=T,[["$ms",r],["$s",n],["$m",o],["$H",a],["$W",s],["$M",h],["$y",u],["$D",c]].forEach((function(e){T[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),b.extend=function(e,t){return e.$i||(e(t,D,b),e.$i=!0),b},b.locale=S,b.isDayjs=A,b.unix=function(e){return b(1e3*e)},b.en=x[y],b.Ls=x,b.p={},b}))},42712:function(e,t,i){"use strict";i(96176)},83e3:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(504)),o=i(73737),a=o.A.vec3,s=r.dw.dataStack.isDimensionStacked;function l(e){var t=e[0],i=e[1];return!(t>0&&i>0||t<0&&i<0)}function h(e,t){var i=e.getData(),n=e.get("barSize");if(null==n){var o,h,d=t.size,u=t.getAxis("x"),c=t.getAxis("y");o="category"===u.type?.7*u.getBandWidth():.6*Math.round(d[0]/Math.sqrt(i.count())),h="category"===c.type?.7*c.getBandWidth():.6*Math.round(d[1]/Math.sqrt(i.count())),n=[o,h]}else r.ZS.isArray(n)||(n=[n,n]);var g=t.getAxis("z").scale.getExtent(),p=l(g),f=["x","y","z"].map((function(t){return e.coordDimToDataDim(t)[0]})),m=s(i,f[2]),v=m?i.getCalculationInfo("stackResultDimension"):f[2];i.each(f,(function(e,r,o,s){var l=i.get(v,s),h=m?l-o:p?0:g[0],d=t.dataToPoint([e,r,h]),u=t.dataToPoint([e,r,l]),c=a.dist(d,u),f=[0,u[1]<d[1]?-1:1,0];0===Math.abs(c)&&(c=.1);var _=[n[0],c,n[1]];i.setItemLayout(s,[d,f,_])})),i.setLayout("orient",[1,0,0])}var d=h;i(16573),i(78100),i(77936),i(37467),i(44732),i(79577);function u(e,t,i){for(var r=e.getDataExtent(t),n=e.getDataExtent(i),o=r[1]-r[0]||r[0],a=n[1]-n[0]||n[0],s=50,l=new Uint8Array(s*s),h=0;h<e.count();h++){var d=e.get(t,h),u=e.get(i,h),c=Math.floor((d-r[0])/o*(s-1)),g=Math.floor((u-n[0])/a*(s-1)),p=g*s+c;l[p]=l[p]||1}var f=0;for(h=0;h<l.length;h++)l[h]&&f++;return f/l.length}var c=o.A.vec3,g=r.dw.dataStack.isDimensionStacked;function p(e,t){var i=e.getData(),o=e.get("minHeight")||0,a=e.get("barSize"),s=["lng","lat","alt"].map((function(t){return e.coordDimToDataDim(t)[0]}));if(null==a){var l=t.radius*Math.PI,h=u(i,s[0],s[1]);a=[l/Math.sqrt(i.count()/h),l/Math.sqrt(i.count()/h)]}else r.ZS.isArray(a)||(a=[a,a]);var d=v(i,s);i.each(s,(function(e,r,n,s){var l=i.get(d.dimension,s),h=d.isStacked?l-n:t.altitudeAxis.scale.getExtent()[0],u=Math.max(t.altitudeAxis.dataToCoord(n),o),g=t.dataToPoint([e,r,h]),p=t.dataToPoint([e,r,l]),f=c.sub([],p,g);c.normalize(f,f);var m=[a[0],u,a[1]];i.setItemLayout(s,[g,f,m])})),i.setLayout("orient",n.A.UP.array)}function f(e,t){var i=e.getData(),n=e.get("barSize"),o=e.get("minHeight")||0,a=["lng","lat","alt"].map((function(t){return e.coordDimToDataDim(t)[0]}));if(null==n){var s=Math.min(t.size[0],t.size[2]),l=u(i,a[0],a[1]);n=[s/Math.sqrt(i.count()/l),s/Math.sqrt(i.count()/l)]}else r.ZS.isArray(n)||(n=[n,n]);var h=[0,1,0],d=v(i,a);i.each(a,(function(e,r,a,s){var l=i.get(d.dimension,s),u=d.isStacked?l-a:t.altitudeAxis.scale.getExtent()[0],c=Math.max(t.altitudeAxis.dataToCoord(a),o),g=t.dataToPoint([e,r,u]),p=[n[0],c,n[1]];i.setItemLayout(s,[g,h,p])})),i.setLayout("orient",[1,0,0])}function m(e,t){var i=e.getData(),n=e.coordDimToDataDim("lng")[0],o=e.coordDimToDataDim("lat")[0],a=e.coordDimToDataDim("alt")[0],s=e.get("barSize"),l=e.get("minHeight")||0;if(null==s){var h=i.getDataExtent(n),d=i.getDataExtent(o),c=t.dataToPoint([h[0],d[0]]),g=t.dataToPoint([h[1],d[1]]),p=Math.min(Math.abs(c[0]-g[0]),Math.abs(c[1]-g[1]))||1,f=u(i,n,o);s=[p/Math.sqrt(i.count()/f),p/Math.sqrt(i.count()/f)]}else r.ZS.isArray(s)||(s=[s,s]),s[0]/=t.getScale()/16,s[1]/=t.getScale()/16;var m=[0,0,1],_=[n,o,a],y=v(i,_);i.each(_,(function(e,r,n,o){var a=i.get(y.dimension,o),h=y.isStacked?a-n:0,d=t.dataToPoint([e,r,h]),u=t.dataToPoint([e,r,a]),c=Math.max(u[2]-d[2],l),g=[s[0],c,s[1]];i.setItemLayout(o,[d,m,g])})),i.setLayout("orient",[1,0,0])}function v(e,t){var i=g(e,t[2]);return{dimension:i?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:i}}function _(e){e.registerLayout((function(e,t){e.eachSeriesByType("bar3D",(function(e){var t=e.coordinateSystem,i=t&&t.type;"globe"===i?p(e,t):"cartesian3D"===i?d(e,t):"geo3D"===i?f(e,t):("mapbox3D"===i||"maptalks3D"===i)&&m(e,t)}))}))}var y=i(59176),x=i(31550),w=i(195),A=i(76621),S=r.rP.extend({type:"series.bar3D",dependencies:["globe"],visualStyleAccessPathvisu:"itemStyle",getInitialData:function(e,t){return(0,A.A)(this)},getFormattedLabel:function(e,t,i,r){var n=x.A.getFormattedLabel(this,e,t,i,r);return null==n&&(n=this.getData().get("z",e)),n},formatTooltip:function(e){return(0,w.A)(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});r.ZS.merge(S.prototype,y.A);var b=S,M=i(9489),D=i(69665),T=i(40981),L=i(4678),C=i(46685),P=o.A.vec3,E=r.OZ.extend({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new M.A.Node,this._api=t,this._labelsBuilder=new L.A(256,256,t);var i=this;this._labelsBuilder.getLabelPosition=function(e,t,r){if(i._data){var n=i._data.getItemLayout(e),o=n[0],a=n[1],s=n[2][1];return P.scaleAndAdd([],o,a,r+s)}return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,i){var r=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=r,this._barMesh||(this._barMesh=new M.A.Mesh({geometry:new T.A,shadowDepthMaterial:new M.A.Material({shader:new M.A.Shader(M.A.Shader.source("ecgl.sm.depth.vertex"),M.A.Shader.source("ecgl.sm.depth.fragment"))}),culling:"cartesian3D"===e.coordinateSystem.type,renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var n=e.coordinateSystem;if(this._doRender(e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[o]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){M.A.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var i=e.getData(),r=e.get("shading"),n="color"!==r,o=this,a=this._barMesh,s="ecgl."+r;a.material&&a.material.shader.name===s||(a.material=M.A.createMaterial(s,["VERTEX_COLOR"])),M.A.setMaterialFromModel(r,a.material,e,t),a.geometry.enableNormal=n,a.geometry.resetOffset();var l=e.get("bevelSize"),h=e.get("bevelSmoothness");a.geometry.bevelSegments=h,a.geometry.bevelSize=l;var d=[],u=new Float32Array(4*i.count()),c=0,g=0,p=!1;i.each((function(e){if(i.hasValue(e)){var t=(0,C.DQ)(i,e),r=(0,C.fz)(i,e);null==r&&(r=1),M.A.parseColor(t,d),d[3]*=r,u[c++]=d[0],u[c++]=d[1],u[c++]=d[2],u[c++]=d[3],d[3]>0&&(g++,d[3]<.99&&(p=!0))}})),a.geometry.setBarCount(g);var f=i.getLayout("orient"),m=this._barIndexOfData=new Int32Array(i.count());g=0;i.each((function(e){if(i.hasValue(e)){var t=i.getItemLayout(e),r=t[0],n=t[1],a=t[2],s=4*e;d[0]=u[s++],d[1]=u[s++],d[2]=u[s++],d[3]=u[s++],d[3]>0&&(o._barMesh.geometry.addBar(r,n,f,a,d,e),m[e]=g++)}else m[e]=-1})),a.geometry.dirty(),a.geometry.updateBoundingBox();var v=a.material;v.transparent=p,v.depthMask=!p,a.geometry.sortTriangles=p,this._initHandler(e,t)},_initHandler:function(e,t){var i=e.getData(),r=this._barMesh,n="cartesian3D"===e.coordinateSystem.type;r.seriesIndex=e.seriesIndex;var o=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",(function(e){var a=r.geometry.getDataIndexOfVertex(e.triangle[0]);a!==o&&(this._downplay(o),this._highlight(a),this._labelsBuilder.updateLabels([a]),n&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",a),i.get("y",a),i.get("z",a,!0)]})),o=a,r.dataIndex=a}),this),r.on("mouseout",(function(e){this._downplay(o),this._labelsBuilder.updateLabels(),o=-1,r.dataIndex=-1,n&&t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_highlight:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var n=t.getItemModel(e),o=n.getModel("emphasis.itemStyle"),a=o.get("color"),s=o.get("opacity");if(null==a){var l=(0,C.DQ)(t,e);a=r.yW.lift(l,-.4)}null==s&&(s=(0,C.fz)(t,e));var h=M.A.parseColor(a);h[3]*=s,this._barMesh.geometry.setColor(i,h),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var i=this._barIndexOfData[e];if(!(i<0)){var r=(0,C.DQ)(t,e),n=(0,C.fz)(t,e),o=M.A.parseColor(r);o[3]*=n,this._barMesh.geometry.setColor(i,o),this._api.getZr().refresh()}}},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,n,o){var a=t.getData(),s=D.A.queryDataIndex(a,o),l=this;null!=s?r.ZS.each(x.A.normalizeToArray(s),(function(t){"highlight"===e?this._highlight(t):this._downplay(t)}),this):a.each((function(t){"highlight"===e?l._highlight(t):l._downplay(t)}))},remove:function(){this.groupGL.removeAll()},dispose:function(){this._labelsBuilder.dispose(),this.groupGL.removeAll()}});function I(e){e.registerChartView(E),e.registerSeriesModel(b),_(e),e.registerProcessor((function(e,t){e.eachSeriesByType("bar3d",(function(e){var t=e.getData();t.filterSelf((function(e){return t.hasValue(e)}))}))}))}(0,r.Yx)(I)},32115:function(e,t,i){"use strict";var r=i(3944),n=i(79006);function o(e){this.viewGL=e}o.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=r.vt(),this.updateTransform(e,t)},o.prototype.updateTransform=function(e,t){var i=e.coordinateSystem;i.getRoamTransform&&(r.B8(this._viewTransform,i.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())},o.prototype.dataToPoint=function(e,t,i){i=e.dataToPoint(t,null,i);var r=this._viewTransform;r&&n.NW(i,i,r)},o.prototype.removeTransformInPoint=function(e){return this._viewTransform&&n.NW(e,e,this._viewTransform),e},o.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1},o.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)},o.prototype._updateCamera=function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.top=0,r.bottom=t,r.right=e,r.near=0,r.far=100},t.A=o},6786:function(e,t,i){"use strict";i.d(t,{A:function(){return x}});i(16573),i(78100),i(77936),i(37467),i(44732),i(79577);var r=i(85811),n=i(9489),o=i(65532),a=(i(44114),i(47430)),s=i(73737),l="@export ecgl.sdfSprite.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float elapsedTime : 0;\n\nattribute vec3 position : POSITION;\n\n#ifdef VERTEX_SIZE\nattribute float size;\n#else\nuniform float u_Size;\n#endif\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_FillColor: COLOR;\nvarying vec4 v_Color;\n#endif\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nattribute float prevSize;\nuniform float percent : 1.0;\n#endif\n\n\n#ifdef POSITIONTEXTURE_ENABLED\nuniform sampler2D positionTexture;\n#endif\n\nvarying float v_Size;\n\nvoid main()\n{\n\n#ifdef POSITIONTEXTURE_ENABLED\n gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);\n#else\n\n #ifdef VERTEX_ANIMATION\n vec3 pos = mix(prevPosition, position, percent);\n #else\n vec3 pos = position;\n #endif\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n#endif\n\n#ifdef VERTEX_SIZE\n#ifdef VERTEX_ANIMATION\n v_Size = mix(prevSize, size, percent);\n#else\n v_Size = size;\n#endif\n#else\n v_Size = u_Size;\n#endif\n\n#ifdef VERTEX_COLOR\n v_Color = a_FillColor;\n #endif\n\n gl_PointSize = v_Size;\n}\n\n@end\n\n@export ecgl.sdfSprite.fragment\n\nuniform vec4 color: [1, 1, 1, 1];\nuniform vec4 strokeColor: [1, 1, 1, 1];\nuniform float smoothing: 0.07;\n\nuniform float lineWidth: 0.0;\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying float v_Size;\n\nuniform sampler2D sprite;\n\n@import clay.util.srgb\n\nvoid main()\n{\n gl_FragColor = color;\n\n vec4 _strokeColor = strokeColor;\n\n#ifdef VERTEX_COLOR\n gl_FragColor *= v_Color;\n #endif\n\n#ifdef SPRITE_ENABLED\n float d = texture2D(sprite, gl_PointCoord).r;\n gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);\n\n if (lineWidth > 0.0) {\n float sLineWidth = lineWidth / 2.0;\n\n float outlineMaxValue0 = 0.5 + sLineWidth;\n float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;\n float outlineMinValue0 = 0.5 - sLineWidth - smoothing;\n float outlineMinValue1 = 0.5 - sLineWidth;\n\n if (d <= outlineMaxValue1 && d >= outlineMinValue0) {\n float a = _strokeColor.a;\n if (d <= outlineMinValue1) {\n a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);\n }\n else {\n a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);\n }\n gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);\n gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;\n }\n }\n#endif\n\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(gl_FragColor);\n#endif\n}\n@end",h=s.A.vec4;n.A.Shader.import(l);var d=n.A.Mesh.extend((function(){var e=new n.A.Geometry({dynamic:!0,attributes:{color:new n.A.Geometry.Attribute("color","float",4,"COLOR"),position:new n.A.Geometry.Attribute("position","float",3,"POSITION"),size:new n.A.Geometry.Attribute("size","float",1),prevPosition:new n.A.Geometry.Attribute("prevPosition","float",3),prevSize:new n.A.Geometry.Attribute("prevSize","float",1)}});Object.assign(e,a.A);var t=new n.A.Material({shader:n.A.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var i=new n.A.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",i),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:n.A.Mesh.POINTS,sizeScale:1}}),{_pick:function(e,t,i,r,o,a){var s=this._positionNDC;if(s)for(var l=i.viewport,h=2/l.width,d=2/l.height,u=this.geometry.vertexCount-1;u>=0;u--){var c;c=this.geometry.indices?this.geometry.indices[u]:u;var g=s[2*c],p=s[2*c+1],f=this.geometry.attributes.size.get(c)/this.sizeScale,m=f/2;if(e>g-m*h&&e<g+m*h&&t>p-m*d&&t<p+m*d){var v=new n.A.Vector3,_=new n.A.Vector3;this.geometry.attributes.position.get(c,v.array),n.A.Vector3.transformMat4(_,v,this.worldTransform),a.push({vertexIndex:c,point:v,pointWorld:_,target:this,distance:_.distance(r.getWorldPosition())})}}},updateNDCPosition:function(e,t,i){var r=this._positionNDC,n=this.geometry;r&&r.length/2===n.vertexCount||(r=this._positionNDC=new Float32Array(2*n.vertexCount));for(var o=h.create(),a=0;a<n.vertexCount;a++)n.attributes.position.get(a,o),o[3]=1,h.transformMat4(o,o,e.array),h.scale(o,o,1/o[3]),r[2*a]=o[0],r[2*a+1]=o[1]}}),u=d,c=i(4678),g=i(21647),p=i(69665),f=i(46685),m=20,v=-10;function _(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function y(e,t){this.rootNode=new n.A.Node,this.is2D=e,this._labelsBuilder=new c.A(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}y.prototype={constructor:y,highlightOnMouseover:!0,update:function(e,t,i,r,o){var a=this._prevMesh;this._prevMesh=this._mesh,this._mesh=a;var s=e.getData();if(null==r&&(r=0),null==o&&(o=s.count()),this._startDataIndex=r,this._endDataIndex=o-1,!this._mesh){var l=this._prevMesh&&this._prevMesh.material;this._mesh=new u({renderOrder:10,frustumCulling:!1}),l&&(this._mesh.material=l)}l=this._mesh.material;var h=this._mesh.geometry,d=h.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var c=this._getSymbolInfo(e,r,o),g=i.getDevicePixelRatio(),p=e.getModel("itemStyle").getItemStyle(),m=e.get("large"),_=1;c.maxSize>2?(_=this._updateSymbolSprite(e,p,c,g),l.enableTexture("sprite")):l.disableTexture("sprite"),d.position.init(o-r);var y=[];if(m){l.undefine("VERTEX_SIZE"),l.undefine("VERTEX_COLOR");var x=(0,f.yz)(s),w=(0,f.iu)(s);n.A.parseColor(x,y),y[3]*=w,l.set({color:y,u_Size:c.maxSize*this._sizeScale})}else l.set({color:[1,1,1,1]}),l.define("VERTEX_SIZE"),l.define("VERTEX_COLOR"),d.size.init(o-r),d.color.init(o-r),this._originalOpacity=new Float32Array(o-r);for(var A=s.getLayout("points"),S=d.position.value,b=0;b<o-r;b++){var M=3*b,D=2*b;if(this.is2D?(S[M]=A[D],S[M+1]=A[D+1],S[M+2]=v):(S[M]=A[M],S[M+1]=A[M+1],S[M+2]=A[M+2]),!m){x=(0,f.DQ)(s,b),w=(0,f.fz)(s,b);n.A.parseColor(x,y),y[3]*=w,d.color.set(b,y),y[3]<.99&&!0;var T=s.getItemVisual(b,"symbolSize");T=T instanceof Array?Math.max(T[0],T[1]):T,isNaN(T)&&(T=0),d.size.value[b]=T*_*this._sizeScale,this._originalOpacity[b]=y[3]}}this._mesh.sizeScale=_,h.updateBoundingBox(),h.dirty(),this._updateMaterial(e,p);var L=e.coordinateSystem;if(L&&L.viewGL){var C=L.viewGL.isLinearSpace()?"define":"undefine";l[C]("fragment","SRGB_DECODE")}m||this._updateLabelBuilder(e,r,o),this._updateHandler(e,t,i),this._updateAnimation(e),this._api=i},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},dispose:function(){this._labelsBuilder.dispose()},_updateSymbolSprite:function(e,t,i,r){i.maxSize=Math.min(2*i.maxSize,200);var n=[];return i.aspect>1?(n[0]=i.maxSize,n[1]=i.maxSize/i.aspect):(n[1]=i.maxSize,n[0]=i.maxSize*i.aspect),n[0]=n[0]||1,n[1]=n[1]||1,this._symbolType===i.type&&_(this._symbolSize,n)&&this._lineWidth===t.lineWidth||(o.A.createSymbolSprite(i.type,n,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(n[0]/2,10)},this._spriteImageCanvas),o.A.createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),m,this._mesh.material.get("sprite").image),this._symbolType=i.type,this._symbolSize=n,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/i.maxSize*r},_updateMaterial:function(e,t){var i="lighter"===e.get("blendMode")?n.A.additiveBlend:null,r=this._mesh.material;r.blend=i,r.set("lineWidth",t.lineWidth/m);var o=n.A.parseColor(t.stroke);r.set("strokeColor",o),r.transparent=!0,r.depthMask=!1,r.depthTest=!this.is2D,r.sortVertices=!this.is2D},_updateLabelBuilder:function(e,t,i){var r=e.getData(),n=this._mesh.geometry,o=n.attributes.position.value,a=(t=this._startDataIndex,this._mesh.sizeScale);this._labelsBuilder.updateData(r,t,i),this._labelsBuilder.getLabelPosition=function(e,i,r){var n=3*(e-t);return[o[n],o[n+1],o[n+2]]},this._labelsBuilder.getLabelDistance=function(e,i,r){var o=n.attributes.size.get(e-t)/a;return o/2+r},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){n.A.updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,i){var r,n=e.getData(),o=this._mesh,a=this,s=-1,l=e.coordinateSystem&&"cartesian3D"===e.coordinateSystem.type;l&&(r=e.coordinateSystem.model),o.seriesIndex=e.seriesIndex,o.off("mousemove"),o.off("mouseout"),o.on("mousemove",(function(t){var h=t.vertexIndex+a._startDataIndex;h!==s&&(this.highlightOnMouseover&&(this.downplay(n,s),this.highlight(n,h),this._labelsBuilder.updateLabels([h])),l&&i.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get(e.coordDimToDataDim("x")[0],h),n.get(e.coordDimToDataDim("y")[0],h),n.get(e.coordDimToDataDim("z")[0],h)],grid3DIndex:r.componentIndex})),o.dataIndex=h,s=h}),this),o.on("mouseout",(function(e){var t=e.vertexIndex+a._startDataIndex;this.highlightOnMouseover&&(this.downplay(n,t),this._labelsBuilder.updateLabels()),s=-1,o.dataIndex=-1,l&&i.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:r.componentIndex})}),this)},updateLayout:function(e,t,i){var r=e.getData();if(this._mesh){var n=this._mesh.geometry.attributes.position.value,o=r.getLayout("points");if(this.is2D)for(var a=0;a<o.length/2;a++){var s=3*a,l=2*a;n[s]=o[l],n[s+1]=o[l+1],n[s+2]=v}else for(a=0;a<o.length;a++)n[a]=o[a];this._mesh.geometry.dirty(),i.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new g.A;g.A.mul(t,e.viewMatrix,this._mesh.worldTransform),g.A.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=e.getItemModel(t),o=i.getModel("emphasis.itemStyle"),a=o.get("color"),s=o.get("opacity");if(null==a){var l=(0,f.DQ)(e,t);a=r.yW.lift(l,-.4)}null==s&&(s=(0,f.fz)(e,t));var h=n.A.parseColor(a);h[3]*=s,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,h),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var i=(0,f.DQ)(e,t),r=(0,f.fz)(e,t),o=n.A.parseColor(i);o[3]*=r,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,o),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,i=0;i<t.vertexCount;i++){var r=this._originalOpacity[i]*e;t.attributes.color.value[4*i+3]=r}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var i=this._mesh.geometry.attributes;if(i.size.value)for(var r=0;r<i.size.value.length;r++)i.size.value[r]=i.size.value[r]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,i){if(e.get("large")){var r=p.A.firstNotNull(e.get("symbolSize"),1);return r instanceof Array?(s=Math.max(r[0],r[1]),n=r[0]/r[1]):(s=r,n=1),{maxSize:r,type:e.get("symbol"),aspect:n}}for(var n,o=e.getData(),a=o.getItemVisual(0,"symbol")||"circle",s=0,l=t;l<i;l++){r=o.getItemVisual(l,"symbolSize");var h,d=o.getItemVisual(l,"symbol");if(r instanceof Array)h=r[0]/r[1],s=Math.max(Math.max(r[0],r[1]),s);else{if(isNaN(r))continue;h=1,s=Math.max(r,s)}0,a=d,n=h}return{maxSize:s,type:a,aspect:n}}};var x=y},76621:function(e,t,i){"use strict";i.d(t,{A:function(){return n}});var r=i(85811);function n(e,t,i){i=i||e.getSource();var n=t||r.Bo(e.get("coordinateSystem"))||["x","y","z"],o=r.dw.createDimensions(i,{dimensionsDefine:i.dimensionsDefine||e.get("dimensions"),encodeDefine:i.encodeDefine||e.get("encode"),coordDimensions:n.map((function(t){var i=e.getReferringComponents(t+"Axis3D").models[0];return{type:i&&"category"===i.get("type")?"ordinal":"float",name:t}}))});"cartesian3D"===e.get("coordinateSystem")&&o.forEach((function(t){if(n.indexOf(t.coordDim)>=0){var i=e.getReferringComponents(t.coordDim+"Axis3D").models[0];i&&"category"===i.get("type")&&(t.ordinalMeta=i.getOrdinalMeta())}}));var a=r.dw.dataStack.enableDataStack(e,o,{byIndex:!0,stackedCoordDimension:"z"}),s=new r.B8(o,e);return s.setCalculationInfo(a),s.initData(i),s}},195:function(e,t,i){"use strict";i.d(t,{A:function(){return a}});i(44114);var r=i(85811),n=i(46685);function o(e,t){var i=[];return r.ZS.each(e.dimensions,(function(r){var n=e.getDimensionInfo(r),o=n.otherDims,a=o[t];null!=a&&!1!==a&&(i[a]=n.name)})),i}function a(e,t,i){function a(e){var n=!0,a=[],l=o(s,"tooltip");function h(e,t){var o=s.getDimensionInfo(t);if(o&&!1!==o.otherDims.tooltip){var l=o.type,h=(n?"- "+(o.tooltipName||o.name)+": ":"")+("ordinal"===l?e+"":"time"===l?i?"":r.GP.formatTime("yyyy/MM/dd hh:mm:ss",e):r.GP.addCommas(e));h&&a.push(r.GP.encodeHTML(h))}}return l.length?r.ZS.each(l,(function(e){h(s.get(e,t),e)})):r.ZS.each(e,h),(n?"<br/>":"")+a.join(n?"<br/>":", ")}var s=e.getData(),l=e.getRawValue(t),h=r.ZS.isArray(l)?a(l):r.GP.encodeHTML(r.GP.addCommas(l)),d=s.getName(t),u=(0,n.DQ)(s,t);r.ZS.isObject(u)&&u.colorStops&&(u=(u.colorStops[0]||{}).color),u=u||"transparent";var c=r.GP.getTooltipMarker(u),g=e.name;return"\0-"===g&&(g=""),g=g?r.GP.encodeHTML(g)+(i?": ":"<br/>"):"",i?c+g+h:g+c+(d?r.GP.encodeHTML(d)+": "+h:h)}},24727:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),r.rP.extend({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualStyleAccessPath:"itemStyle",getInitialData:function(e,t){var i=this.get("coordinateSystem"),n="geo"===i?["lng","lat"]:r.Bo(i)||["x","y"];n.push("vx","vy");var o=r.dw.createDimensions(this.getSource(),{coordDimensions:n,encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),a=new r.B8(o,this);return a.initData(this.getSource()),a},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}})),o=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(9489)),a=i(69665),s=i(63858),l=i(74998),h=i(21788),d=i(83992),u=i(5148),c=i(50296),g=i(33672),p=i(68718),f=i(16631),m=i(13360),v=i(87322),_=h.A.extend((function(){return{dynamic:!0,attributes:{position:new h.A.Attribute("position","float",3,"POSITION")}}}),{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,i=4*e,r=2*e;this.vertexCount!==i&&t.position.init(i),this.triangleCount!==r&&(this.indices=0===r?null:this.vertexCount>65535?new Uint32Array(3*r):new Uint16Array(3*r))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}}),y=_,x="@export ecgl.vfParticle.particle.fragment\n\nuniform sampler2D particleTexture;\nuniform sampler2D spawnTexture;\nuniform sampler2D velocityTexture;\n\nuniform float deltaTime;\nuniform float elapsedTime;\n\nuniform float speedScaling : 1.0;\n\nuniform vec2 textureSize;\nuniform vec4 region : [0, 0, 1, 1];\nuniform float firstFrameTime;\n\nvarying vec2 v_Texcoord;\n\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, v_Texcoord);\n bool spawn = false;\n if (p.w <= 0.0) {\n p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));\n p.w -= firstFrameTime;\n spawn = true;\n }\n vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;\n v = (v - 0.5) * 2.0;\n p.z = length(v);\n p.xy += v * deltaTime / 10.0 * speedScaling;\n p.w -= deltaTime;\n\n if (spawn || p.xy != fract(p.xy)) {\n p.z = 0.0;\n }\n p.xy = fract(p.xy);\n\n gl_FragColor = p;\n}\n@end\n\n@export ecgl.vfParticle.renderPoints.vertex\n\n#define PI 3.1415926\n\nattribute vec2 texcoord : TEXCOORD_0;\n\nuniform sampler2D particleTexture;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nuniform float size : 1.0;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, texcoord);\n\n if (p.w > 0.0 && p.z > 1e-5) {\n gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);\n }\n else {\n gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n }\n\n v_Mag = p.z;\n v_Uv = p.xy;\n\n gl_PointSize = size;\n}\n\n@end\n\n@export ecgl.vfParticle.renderPoints.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform sampler2D gradientTexture;\nuniform sampler2D colorTexture;\nuniform sampler2D spriteTexture;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n gl_FragColor = color;\n#ifdef SPRITETEXTURE_ENABLED\n gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);\n if (color.a == 0.0) {\n discard;\n }\n#endif\n#ifdef GRADIENTTEXTURE_ENABLED\n gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));\n#endif\n#ifdef COLORTEXTURE_ENABLED\n gl_FragColor *= texture2D(colorTexture, v_Uv);\n#endif\n}\n\n@end\n\n@export ecgl.vfParticle.renderLines.vertex\n\n#define PI 3.1415926\n\nattribute vec3 position : POSITION;\n\nuniform sampler2D particleTexture;\nuniform sampler2D prevParticleTexture;\n\nuniform float size : 1.0;\nuniform vec4 vp: VIEWPORT;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\n@import clay.util.rand\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, position.xy);\n vec4 p2 = texture2D(prevParticleTexture, position.xy);\n\n p.xy = p.xy * 2.0 - 1.0;\n p2.xy = p2.xy * 2.0 - 1.0;\n\n if (p.w > 0.0 && p.z > 1e-5) {\n vec2 dir = normalize(p.xy - p2.xy);\n vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;\n if (abs(position.z) == 2.0) {\n gl_Position = vec4(p.xy + norm, 0.0, 1.0);\n v_Uv = p.xy;\n v_Mag = p.z;\n }\n else {\n gl_Position = vec4(p2.xy + norm, 0.0, 1.0);\n v_Mag = p2.z;\n v_Uv = p2.xy;\n }\n gl_Position = worldViewProjection * gl_Position;\n }\n else {\n gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n }\n}\n\n@end\n\n@export ecgl.vfParticle.renderLines.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform sampler2D gradientTexture;\nuniform sampler2D colorTexture;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n gl_FragColor = color;\n #ifdef GRADIENTTEXTURE_ENABLED\n gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));\n#endif\n#ifdef COLORTEXTURE_ENABLED\n gl_FragColor *= texture2D(colorTexture, v_Uv);\n#endif\n}\n\n@end\n";function w(e){var t=document.createElement("canvas");t.width=t.height=e;var i=t.getContext("2d");return i.fillStyle="#fff",i.arc(e/2,e/2,e/2,0,2*Math.PI),i.fill(),t}c.A["import"](x);var A=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new g.A({type:p.A.FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};A.prototype={constructor:A,init:function(){var e={type:p.A.FLOAT,minFilter:p.A.NEAREST,magFilter:p.A.NEAREST,useMipmap:!1};this._spawnTexture=new g.A(e),this._particleTexture0=new g.A(e),this._particleTexture1=new g.A(e),this._frameBuffer=new v.A({depthBuffer:!1}),this._particlePass=new l.A({fragment:c.A.source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new l.A({fragment:c.A.source("clay.compositor.downsample")});var t=new d.A({renderOrder:10,material:new u.A({shader:new c.A(c.A.source("ecgl.vfParticle.renderPoints.vertex"),c.A.source("ecgl.vfParticle.renderPoints.fragment"))}),mode:d.A.POINTS,geometry:new h.A({dynamic:!0,mainAttribute:"texcoord0"})}),i=new d.A({renderOrder:10,material:new u.A({shader:new c.A(c.A.source("ecgl.vfParticle.renderLines.vertex"),c.A.source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new y,culling:!1}),r=new d.A({material:new u.A({shader:new c.A(c.A.source("ecgl.color.vertex"),c.A.source("ecgl.color.fragment"))}),geometry:new m.A});r.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=i,this._lastFrameFullQuadMesh=r,this._camera=new f.A,this._thisFrameTexture=new g.A,this._lastFrameTexture=new g.A},setParticleDensity:function(e,t){for(var i=e*t,r=new Float32Array(4*i),n=0,o=this.particleLife,a=0;a<e;a++)for(var s=0;s<t;s++,n++){r[4*n]=Math.random(),r[4*n+1]=Math.random(),r[4*n+2]=Math.random();var l=(o[1]-o[0])*Math.random()+o[0];r[4*n+3]=l}"line"===this._particleType?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=r,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var i=e*t,r=this._particlePointsMesh.geometry,n=r.attributes;n.texcoord0.init(i);for(var o=0,a=0;a<e;a++)for(var s=0;s<t;s++,o++)n.texcoord0.value[2*o]=a/e,n.texcoord0.value[2*o+1]=s/t;r.dirty()},_setLineGeometry:function(e,t){var i=e*t,r=this._getParticleMesh().geometry;r.setLineCount(i),r.resetOffset();for(var n=0;n<e;n++)for(var o=0;o<t;o++)r.addLine([n/e,o/t]);r.dirty()},_getParticleMesh:function(){return"line"===this._particleType?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,i,r){var n=this._getParticleMesh(),o=this._frameBuffer,a=this._particlePass;r&&this._updateDownsampleTextures(e,t),n.material.set("size",this._particleSize*this._supersampling),n.material.set("color",this.particleColor),a.setUniform("speedScaling",this.particleSpeedScaling),o.attach(this._particleTexture1),a.setUniform("firstFrameTime",r?(this.particleLife[1]+this.particleLife[0])/2:0),a.setUniform("particleTexture",this._particleTexture0),a.setUniform("deltaTime",i),a.setUniform("elapsedTime",this._elapsedTime),a.render(e,o),n.material.set("particleTexture",this._particleTexture1),n.material.set("prevParticleTexture",this._particleTexture0),o.attach(this._thisFrameTexture),o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,n],this._camera),o.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=i},_downsample:function(e){var t=this._downsampleTextures;if(0!==t.length){var i=0,r=this._thisFrameTexture,n=t[i];while(n)this._frameBuffer.attach(n),this._downsamplePass.setUniform("texture",r),this._downsamplePass.setUniform("textureSize",[r.width,r.height]),this._downsamplePass.render(e,this._frameBuffer),r=n,n=t[++i]}},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2)return t.material.disableTexture("spriteTexture"),void(t.material.transparent=!1);this._spriteTexture||(this._spriteTexture=new g.A),this._spriteTexture.image&&this._spriteTexture.image.width===e||(this._spriteTexture.image=w(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var i=this._getParticleMesh().material;i.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var i=this._downsampleTextures,r=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),n=2,o=this._width*this._supersampling,a=this._height*this._supersampling,s=0;s<r;s++)i[s]=i[s]||new g.A,i[s].width=o/n,i[s].height=a/n,n*=2;for(;s<i.length;s++)i[s].dispose(e);i.length=r},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach((function(t){t.dispose(e)}))}};var S=A,b=r.OZ.extend({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new s.A("orthographic"),this.groupGL=new o.A.Node,this.viewGL.add(this.groupGL),this._particleSurface=new S;var i=new o.A.Mesh({geometry:new o.A.PlaneGeometry,material:new o.A.Material({shader:new o.A.Shader({vertex:o.A.Shader.source("ecgl.color.vertex"),fragment:o.A.Shader.source("ecgl.color.fragment")}),transparent:!0})});i.material.enableTexture("diffuseMap"),this.groupGL.add(i),this._planeMesh=i},render:function(e,t,i){var r=this._particleSurface;r.setParticleType(e.get("particleType")),r.setSupersampling(e.get("supersampling")),this._updateData(e,i),this._updateCamera(i.getWidth(),i.getHeight(),i.getDevicePixelRatio());var n=a.A.firstNotNull(e.get("particleDensity"),128);r.setParticleDensity(n,n);var s=this._planeMesh,l=+new Date,h=this,d=!0;s.__percent=0,s.stopAnimation(),s.animate("",{loop:!0}).when(1e5,{__percent:1}).during((function(){var e=+new Date,t=Math.min(e-l,20);l+=t,h._renderer&&(r.update(h._renderer,i,t/1e3,d),s.material.set("diffuseMap",r.getSurfaceTexture())),d=!1})).start();var u=e.getModel("itemStyle"),c=o.A.parseColor(u.get("color"));c[3]*=a.A.firstNotNull(u.get("opacity"),1),s.material.set("color",c),r.setColorTextureImage(e.get("colorTexture"),i),r.setParticleSize(e.get("particleSize")),r.particleSpeedScaling=e.get("particleSpeed"),r.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,i){this._updateData(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._renderer=n},_updateData:function(e,t){var i=e.coordinateSystem,r=i.dimensions.map((function(t){return e.coordDimToDataDim(t)[0]})),n=e.getData(),o=n.getDataExtent(r[0]),a=n.getDataExtent(r[1]),s=e.get("gridWidth"),l=e.get("gridHeight");if(null==s||"auto"===s){var h=(o[1]-o[0])/(a[1]-a[0]);s=Math.round(Math.sqrt(h*n.count()))}null!=l&&"auto"!==l||(l=Math.ceil(n.count()/s));var d=this._particleSurface.vectorFieldTexture,u=d.pixels;if(u&&u.length===l*s*4)for(var c=0;c<u.length;c++)u[c]=0;else u=d.pixels=new Float32Array(s*l*4);var g=0,p=1/0,f=new Float32Array(2*n.count()),m=0,v=[[1/0,1/0],[-1/0,-1/0]];n.each([r[0],r[1],"vx","vy"],(function(e,t,r,n){var o=i.dataToPoint([e,t]);f[m++]=o[0],f[m++]=o[1],v[0][0]=Math.min(o[0],v[0][0]),v[0][1]=Math.min(o[1],v[0][1]),v[1][0]=Math.max(o[0],v[1][0]),v[1][1]=Math.max(o[1],v[1][1]);var a=Math.sqrt(r*r+n*n);g=Math.max(g,a),p=Math.min(p,a)})),n.each(["vx","vy"],(function(e,t,i){var r=Math.round((f[2*i]-v[0][0])/(v[1][0]-v[0][0])*(s-1)),n=l-1-Math.round((f[2*i+1]-v[0][1])/(v[1][1]-v[0][1])*(l-1)),o=4*(n*s+r);u[o]=e/g*.5+.5,u[o+1]=t/g*.5+.5,u[o+3]=1})),d.width=s,d.height=l,"bmap"===e.get("coordinateSystem")&&this._fillEmptyPixels(d),d.dirty(),this._updatePlanePosition(v[0],v[1],e,t),this._updateGradientTexture(n.getVisual("visualMeta"),[p,g])},_fillEmptyPixels:function(e){var t=e.pixels,i=e.width,r=e.height;function n(e,n,o){e=Math.max(Math.min(e,i-1),0),n=Math.max(Math.min(n,r-1),0);var a=4*(n*(i-1)+e);return 0!==t[a+3]&&(o[0]=t[a],o[1]=t[a+1],!0)}function o(e,t,i){i[0]=e[0]+t[0],i[1]=e[1]+t[1]}for(var a=[],s=[],l=[],h=[],d=[],u=0,c=0;c<r;c++)for(var g=0;g<i;g++){var p=4*(c*(i-1)+g);0===t[p+3]&&(u=a[0]=a[1]=0,n(g-1,c,s)&&(u++,o(s,a,a)),n(g+1,c,l)&&(u++,o(l,a,a)),n(g,c-1,h)&&(u++,o(h,a,a)),n(g,c+1,d)&&(u++,o(d,a,a)),a[0]/=u,a[1]/=u,t[p]=a[0],t[p+1]=a[1]),t[p+3]=1}},_updateGradientTexture:function(e,t){if(e&&e.length){this._gradientTexture=this._gradientTexture||new o.A.Texture2D({image:document.createElement("canvas")});var i=this._gradientTexture,r=i.image;r.width=200,r.height=1;var n=r.getContext("2d"),a=n.createLinearGradient(0,.5,r.width,.5);e[0].stops.forEach((function(e){var i;t[1]===t[0]?i=0:(i=e.value/t[1],i=Math.min(Math.max(i,0),1)),a.addColorStop(i,e.color)})),n.fillStyle=a,n.fillRect(0,0,r.width,r.height),i.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)}else this._particleSurface.setGradientTexture(null)},_updatePlanePosition:function(e,t,i,r){var n=this._limitInViewportAndFullFill(e,t,i,r);e=n.leftTop,t=n.rightBottom,this._particleSurface.setRegion(n.region),this._planeMesh.position.set((e[0]+t[0])/2,r.getHeight()-(e[1]+t[1])/2,0);var o=t[0]-e[0],a=t[1]-e[1];this._planeMesh.scale.set(o/2,a/2,1),this._particleSurface.resize(Math.max(Math.min(o,2048),1),Math.max(Math.min(a,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,i,r){var n=[Math.max(e[0],0),Math.max(e[1],0)],o=[Math.min(t[0],r.getWidth()),Math.min(t[1],r.getHeight())];if("bmap"===i.get("coordinateSystem")){var a=i.getData().getDataExtent(i.coordDimToDataDim("lng")[0]),s=Math.floor(a[1]-a[0])>=359;s&&(n[0]>0&&(n[0]=0),o[0]<r.getWidth()&&(o[0]=r.getWidth()))}var l=t[0]-e[0],h=t[1]-e[1],d=o[0]-n[0],u=o[1]-n[1],c=[(n[0]-e[0])/l,1-u/h-(n[1]-e[1])/h,d/l,u/h];return{leftTop:n,rightBottom:o,region:c}},_updateCamera:function(e,t,i){this.viewGL.setViewport(0,0,e,t,i);var r=this.viewGL.camera;r.left=r.bottom=0,r.top=t,r.right=e,r.near=0,r.far=100,r.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}});function M(e){e.registerChartView(b),e.registerSeriesModel(n)}(0,r.Yx)(M)},70580:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),i(8594)),o=i(56159),a=i(69665);function s(e,t,i,s,l){for(var h=new n.Ay(s),d=0;d<e.length;d++)h.addNode(a.A.firstNotNull(e[d].id,e[d].name,d),d);var u,c=[],g=[],p=0;for(d=0;d<t.length;d++){var f=t[d],m=f.source,v=f.target;h.addEdge(m,v,p)&&(g.push(f),c.push(a.A.firstNotNull(f.id,m+" > "+v)),p++)}var _=r.dw.createDimensions(e,{coordDimensions:["value"]});u=new r.B8(_,i),u.initData(e);var y=new r.B8(["value"],i);return y.initData(g,c),l&&l(u,y),(0,o.A)({mainData:u,struct:h,structAttr:"graph",datas:{node:u,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),h.update(),h}var l=i(31550),h=r.rP.extend({type:"series.graphGL",visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,init:function(e){h.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){h.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,i,r){var n=l.A.getFormattedLabel(this,e,t,i,r);if(null==n){var o=this.getData(),a=o.dimensions[o.dimensions.length-1];n=o.get(a,e)}return n},getInitialData:function(e,t){var i=e.edges||e.links||[],r=e.data||e.nodes||[],n=this;if(r&&i)return s(r,i,this,!0,o).data;function o(e,i){e.wrapMethod("getItemModel",(function(e){const t=n._categoriesModels,i=e.getShallow("category"),r=t[i];return r&&(r.parentModel=e.parentModel,e.parentModel=r),e}));const r=t.getModel([]).getModel;function o(e,t){const i=r.call(this,e,t);return i.resolveParentPath=a,i}function a(e){if(e&&("label"===e[0]||"label"===e[1])){const t=e.slice();return"label"===e[0]?t[0]="edgeLabel":"label"===e[1]&&(t[1]="edgeLabel"),t}return e}i.wrapMethod("getItemModel",(function(e){return e.resolveParentPath=a,e.getModel=o,e}))}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,i){if("edge"===i){var n=this.getData(),o=this.getDataParams(e,i),a=n.graph.getEdgeByIndex(e),s=n.getName(a.node1.dataIndex),l=n.getName(a.node2.dataIndex),d=[];return null!=s&&d.push(s),null!=l&&d.push(l),d=r.GP.encodeHTML(d.join(" > ")),o.value&&(d+=" : "+r.GP.encodeHTML(o.value)),d}return h.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map((function(e){return null!=e.value?e:Object.assign({value:0},e)})),t=new r.B8(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray((function(e){return t.getItemModel(e,!0)}))},setView:function(e){null!=e.zoom&&(this.option.zoom=e.zoom),null!=e.offset&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var i=e[2*t],r=e[2*t+1],n=this.getData().getRawDataItem(t);n.x=i,n.y=r}},isAnimationEnabled:function(){return h.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}}),d=h,u=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(93398)),c=i(9489),g=i(63858),p=i(1163),f=i(74998),m=i(87322),v="@export ecgl.forceAtlas2.updateNodeRepulsion\n\n#define NODE_COUNT 0\n\nuniform sampler2D positionTex;\n\nuniform vec2 textureSize;\nuniform float gravity;\nuniform float scaling;\nuniform vec2 gravityCenter;\n\nuniform bool strongGravityMode;\nuniform bool preventOverlap;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n\n vec4 n0 = texture2D(positionTex, v_Texcoord);\n\n vec2 force = vec2(0.0);\n for (int i = 0; i < NODE_COUNT; i++) {\n vec2 uv = vec2(\n mod(float(i), textureSize.x) / (textureSize.x - 1.0),\n floor(float(i) / textureSize.x) / (textureSize.y - 1.0)\n );\n vec4 n1 = texture2D(positionTex, uv);\n\n vec2 dir = n0.xy - n1.xy;\n float d2 = dot(dir, dir);\n\n if (d2 > 0.0) {\n float factor = 0.0;\n if (preventOverlap) {\n float d = sqrt(d2);\n d = d - n0.w - n1.w;\n if (d > 0.0) {\n factor = scaling * n0.z * n1.z / (d * d);\n }\n else if (d < 0.0) {\n factor = scaling * 100.0 * n0.z * n1.z;\n }\n }\n else {\n factor = scaling * n0.z * n1.z / d2;\n }\n force += dir * factor;\n }\n }\n\n vec2 dir = gravityCenter - n0.xy;\n float d = 1.0;\n if (!strongGravityMode) {\n d = length(dir);\n }\n\n force += dir * n0.z * gravity / (d + 1.0);\n\n gl_FragColor = vec4(force, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.vertex\n\nattribute vec2 node1;\nattribute vec2 node2;\nattribute float weight;\n\nuniform sampler2D positionTex;\nuniform float edgeWeightInfluence;\nuniform bool preventOverlap;\nuniform bool linLogMode;\n\nuniform vec2 windowSize: WINDOW_SIZE;\n\nvarying vec2 v_Force;\n\nvoid main() {\n\n vec4 n0 = texture2D(positionTex, node1);\n vec4 n1 = texture2D(positionTex, node2);\n\n vec2 dir = n1.xy - n0.xy;\n float d = length(dir);\n float w;\n if (edgeWeightInfluence == 0.0) {\n w = 1.0;\n }\n else if (edgeWeightInfluence == 1.0) {\n w = weight;\n }\n else {\n w = pow(weight, edgeWeightInfluence);\n }\n vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);\n vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);\n vec2 pos = node1 * scale * 2.0 - 1.0;\n gl_Position = vec4(pos + offset, 0.0, 1.0);\n gl_PointSize = 1.0;\n\n float factor;\n if (preventOverlap) {\n d = d - n1.w - n0.w;\n }\n if (d <= 0.0) {\n v_Force = vec2(0.0);\n return;\n }\n\n if (linLogMode) {\n factor = w * log(d) / d;\n }\n else {\n factor = w;\n }\n v_Force = dir * factor;\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.fragment\n\nvarying vec2 v_Force;\n\nvoid main() {\n gl_FragColor = vec4(v_Force, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.vertex\n\nattribute vec2 node;\n\nvarying vec2 v_NodeUv;\n\nvoid main() {\n\n v_NodeUv = node;\n gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n gl_PointSize = 1.0;\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.fragment\n\nvarying vec2 v_NodeUv;\n\nuniform sampler2D positionTex;\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\n\nvoid main() {\n vec2 force = texture2D(forceTex, v_NodeUv).rg;\n vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;\n\n float mass = texture2D(positionTex, v_NodeUv).z;\n float swing = length(force - forcePrev) * mass;\n float traction = length(force + forcePrev) * 0.5 * mass;\n\n gl_FragColor = vec4(swing, traction, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcGlobalSpeed\n\nuniform sampler2D globalSpeedPrevTex;\nuniform sampler2D weightedSumTex;\nuniform float jitterTolerence;\n\nvoid main() {\n vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;\n float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;\n float globalSpeed = jitterTolerence * jitterTolerence\n * weightedSum.y / weightedSum.x;\n if (prevGlobalSpeed > 0.0) {\n globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;\n }\n gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updatePosition\n\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\nuniform sampler2D positionTex;\nuniform sampler2D globalSpeedTex;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n vec2 force = texture2D(forceTex, v_Texcoord).xy;\n vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;\n vec4 node = texture2D(positionTex, v_Texcoord);\n\n float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;\n float swing = length(force - forcePrev);\n float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));\n\n float df = length(force);\n if (df > 0.0) {\n speed = min(df * speed, 10.0) / df;\n\n gl_FragColor = vec4(node.xy + speed * force, node.zw);\n }\n else {\n gl_FragColor = node;\n }\n}\n@end\n\n@export ecgl.forceAtlas2.edges.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 node;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\nuniform sampler2D positionTex;\n\nvoid main()\n{\n gl_Position = worldViewProjection * vec4(\n texture2D(positionTex, node).xy, -10.0, 1.0\n );\n v_Color = a_Color;\n}\n@end\n\n@export ecgl.forceAtlas2.edges.fragment\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nvarying vec4 v_Color;\nvoid main() {\n gl_FragColor = color * v_Color;\n}\n@end";c.A.Shader.import(v);var _={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function y(e){var t={type:c.A.Texture.FLOAT,minFilter:c.A.Texture.NEAREST,magFilter:c.A.Texture.NEAREST};this._positionSourceTex=new c.A.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new c.A.Texture2D(t),this._positionPrevTex=new c.A.Texture2D(t),this._forceTex=new c.A.Texture2D(t),this._forcePrevTex=new c.A.Texture2D(t),this._weightedSumTex=new c.A.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new c.A.Texture2D(t),this._globalSpeedPrevTex=new c.A.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new f.A({fragment:c.A.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new f.A({fragment:c.A.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new f.A({fragment:c.A.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new f.A({fragment:c.A.Shader.source("clay.compositor.output")});var i=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE)};this._edgeForceMesh=new c.A.Mesh({geometry:new c.A.Geometry({attributes:{node1:new c.A.Geometry.Attribute("node1","float",2),node2:new c.A.Geometry.Attribute("node2","float",2),weight:new c.A.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new c.A.Material({transparent:!0,shader:c.A.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:i,depthMask:!1,depthText:!1}),mode:c.A.Mesh.POINTS}),this._weightedSumMesh=new c.A.Mesh({geometry:new c.A.Geometry({attributes:{node:new c.A.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new c.A.Material({transparent:!0,shader:c.A.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:i,depthMask:!1,depthText:!1}),mode:c.A.Mesh.POINTS}),this._framebuffer=new m.A({depthBuffer:!1}),this._dummyCamera=new c.A.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}y.prototype.updateOption=function(e){for(var t in _)this[t]=_[t];var i=this._nodes.length;if(this.jitterTolerence=i>5e4?10:i>5e3?1:.1,this.scaling=i>100?2:10,e)for(var t in _)null!=e[t]&&(this[t]=e[t]);if(this.repulsionByDegree)for(var r=this._positionSourceTex.pixels,n=0;n<this._nodes.length;n++)r[4*n+2]=(this._nodes[n].degree||0)+1},y.prototype._updateGravityCenter=function(e){var t=this._nodes,i=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var r=[1/0,1/0],n=[-1/0,-1/0],o=0;o<t.length;o++)r[0]=Math.min(t[o].x,r[0]),r[1]=Math.min(t[o].y,r[1]),n[0]=Math.max(t[o].x,n[0]),n[1]=Math.max(t[o].y,n[1]);this._gravityCenter=[.5*(r[0]+n[0]),.5*(r[1]+n[1])]}for(o=0;o<i.length;o++){var a=i[o].node1,s=i[o].node2;t[a].degree=(t[a].degree||0)+1,t[s].degree=(t[s].degree||0)+1}},y.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var i=Math.ceil(Math.sqrt(e.length)),r=i,n=new Float32Array(i*r*4);this._resize(i,r);for(var o=0,a=0;a<e.length;a++){var s=e[a];n[o++]=s.x||0,n[o++]=s.y||0,n[o++]=s.mass||1,n[o++]=s.size||1}this._positionSourceTex.pixels=n;var l=this._edgeForceMesh.geometry,h=t.length;l.attributes.node1.init(2*h),l.attributes.node2.init(2*h),l.attributes.weight.init(2*h);var d=[];for(a=0;a<t.length;a++){var u=l.attributes,c=t[a].weight;null==c&&(c=1),u.node1.set(a,this.getNodeUV(t[a].node1,d)),u.node2.set(a,this.getNodeUV(t[a].node2,d)),u.weight.set(a,c),u.node1.set(a+h,this.getNodeUV(t[a].node2,d)),u.node2.set(a+h,this.getNodeUV(t[a].node1,d)),u.weight.set(a+h,c)}var g=this._weightedSumMesh.geometry;g.attributes.node.init(e.length);for(a=0;a<e.length;a++)g.attributes.node.set(a,this.getNodeUV(a,d));l.dirty(),g.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[i,r]),this._inited=!1,this._frame=0},y.prototype.getNodes=function(){return this._nodes},y.prototype.getEdges=function(){return this._edges},y.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var i=this._edgeForceMesh;i.material.set("linLogMode",this.linLogMode),i.material.set("edgeWeightInfluence",this.edgeWeightInfluence),i.material.set("preventOverlap",this.preventOverlap),i.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([i],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var r=this._weightedSumMesh;r.material.set("positionTex",this._positionPrevTex),r.material.set("forceTex",this._forceTex),r.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var n=this._globalSpeedPass;n.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),n.setUniform("weightedSumTex",this._weightedSumTex),n.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),n.render(e);var o=this._positionPass;this._framebuffer.attach(this._positionTex),o.setUniform("globalSpeedTex",this._globalSpeedTex),o.setUniform("positionTex",this._positionPrevTex),o.setUniform("forceTex",this._forceTex),o.setUniform("forcePrevTex",this._forcePrevTex),o.render(e),this._framebuffer.unbind(e),this._swapTexture()},y.prototype.update=function(e,t,i){null==t&&(t=1),t=Math.max(t,1);for(var r=0;r<t;r++)this.step(e);i&&i()},y.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex},y.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1)||0,t},y.prototype.getNodePosition=function(e,t){var i=this._positionArr,r=this._positionTex.width,n=this._positionTex.height,o=r*n;i&&i.length===4*o||(i=this._positionArr=new Float32Array(4*o)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,i),this._framebuffer.unbind(e),t||(t=new Float32Array(2*this._nodes.length));for(var a=0;a<this._nodes.length;a++)t[2*a]=i[4*a],t[2*a+1]=i[4*a+1];return t},y.prototype.getTextureData=function(e,t){var i=this["_"+t+"Tex"],r=i.width,n=i.height;this._framebuffer.bind(e),this._framebuffer.attach(i);var o=new Float32Array(r*n*4);return e.gl.readPixels(0,0,r,n,e.gl.RGBA,e.gl.FLOAT,o),this._framebuffer.unbind(e),o},y.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}},y.prototype.isFinished=function(e){return this._frame>e},y.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e},y.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)},y.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach((function(i){this[i].width=e,this[i].height=t,this[i].dirty()}),this)},y.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)};var x=y,w=(i(14603),i(47566),i(98721),i(33672)),A=i(68718);function S(){var e={create:function(){return new Float32Array(2)},dist:function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)},len:function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},scaleAndAdd:function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e},scale:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},sub:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e},normalize:function(e,t){var i=t[0],r=t[1],n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,i){return e[0]=t,e[1]=i,e}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var i=t.prototype;function r(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function n(e,t){this.source=e,this.target=t,this.weight=1}function o(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}i.beforeUpdate=function(){for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},i.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].afterUpdate()},i.addNode=function(e){if(0===this.nSubRegions){if(null==this.node)return void(this.node=e);this._addNodeToSubRegion(this.node),this.node=null}this._addNodeToSubRegion(e),this._updateCenterOfMass(e)},i.findSubRegion=function(e,t){for(var i=0;i<this.nSubRegions;i++){var r=this.subRegions[i];if(r.contain(e,t))return r}},i.contain=function(e,t){return this.bbox[0]<=e&&this.bbox[2]>=e&&this.bbox[1]<=t&&this.bbox[3]>=t},i.setBBox=function(e,t,i,r){this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=i,this.bbox[3]=r,this.size=(i-e+r-t)/2},i._newSubRegion=function(){var e=this.subRegions[this.nSubRegions];return e||(e=new t,this.subRegions[this.nSubRegions]=e),this.nSubRegions++,e},i._addNodeToSubRegion=function(e){var t=this.findSubRegion(e.position[0],e.position[1]),i=this.bbox;if(!t){var r=(i[0]+i[2])/2,n=(i[1]+i[3])/2,o=(i[2]-i[0])/2,a=(i[3]-i[1])/2,s=e.position[0]>=r?1:0,l=e.position[1]>=n?1:0;t=this._newSubRegion();t.setBBox(s*o+i[0],l*a+i[1],(s+1)*o+i[0],(l+1)*a+i[1])}t.addNode(e)},i._updateCenterOfMass=function(e){null==this.centerOfMass&&(this.centerOfMass=new Float32Array(2));var t=this.centerOfMass[0]*this.mass,i=this.centerOfMass[1]*this.mass;t+=e.position[0]*e.mass,i+=e.position[1]*e.mass,this.mass+=e.mass,this.centerOfMass[0]=t/this.mass,this.centerOfMass[1]=i/this.mass};var a=o.prototype;a.initNodes=function(e,t,i){var n=t.length;this.nodes.length=0;for(var o="undefined"!=typeof i,a=0;a<n;a++){var s=new r;s.position[0]=e[2*a],s.position[1]=e[2*a+1],s.mass=t[a],o&&(s.size=i[a]),this.nodes.push(s)}this._massArr=t,this._swingingArr=new Float32Array(n),o&&(this._sizeArr=i)},a.initEdges=function(e,t){var i=e.length/2;this.edges.length=0;for(var r=0;r<i;r++){var o=e[2*r],a=e[2*r+1],s=this.nodes[o],l=this.nodes[a];if(!s||!l)return void console.error("Node not exists, try initNodes before initEdges");s.outDegree++,l.inDegree++;var h=new n(s,l);t&&(h.weight=t[r]),this.edges.push(h)}},a.updateSettings=function(){if(this.repulsionByDegree)for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];t.mass=t.inDegree+t.outDegree+1}else for(e=0;e<this.nodes.length;e++){t=this.nodes[e];t.mass=this._massArr[e]}},a.update=function(){var t=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var i=0;i<t;i++)this.rootRegion.addNode(this.nodes[i]);this.rootRegion.afterUpdate()}for(i=0;i<t;i++){var r=this.nodes[i];e.copy(r.forcePrev,r.force),e.set(r.force,0,0)}for(i=0;i<t;i++){var n=this.nodes[i];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,n);else for(var o=i+1;o<t;o++){var a=this.nodes[o];this.applyNodeToNodeRepulsion(n,a,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(n):this.applyNodeGravity(n))}for(i=0;i<this.edges.length;i++)this.applyEdgeAttraction(this.edges[i]);var s=0,l=0,h=e.create();for(i=0;i<t;i++){r=this.nodes[i];var d=e.dist(r.force,r.forcePrev);s+=d*r.mass,e.add(h,r.force,r.forcePrev);var u=.5*e.len(h);l+=u*r.mass,this._swingingArr[i]=d}var c=this.jitterTolerence*this.jitterTolerence*l/s;this._globalSpeed>0&&(c=Math.min(c/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=c;for(i=0;i<t;i++){r=this.nodes[i],d=this._swingingArr[i];var g=.1*c/(1+c*Math.sqrt(d)),p=e.len(r.force);p>0&&(g=Math.min(p*g,10)/p,e.scaleAndAdd(r.position,r.position,r.force,g))}},a.applyRegionToNodeRepulsion=function(){var t=e.create();return function(i,r){if(i.node)this.applyNodeToNodeRepulsion(i.node,r,!0);else{e.sub(t,r.position,i.centerOfMass);var n=t[0]*t[0]+t[1]*t[1];if(n>this.barnesHutTheta*i.size*i.size){var o=this.scaling*r.mass*i.mass/n;e.scaleAndAdd(r.force,r.force,t,o)}else for(var a=0;a<i.nSubRegions;a++)this.applyRegionToNodeRepulsion(i.subRegions[a],r)}}}(),a.applyNodeToNodeRepulsion=function(){var t=e.create();return function(i,r,n){if(i!=r){e.sub(t,i.position,r.position);var o=t[0]*t[0]+t[1]*t[1];if(0!==o){var a;if(this.preventOverlap){var s=Math.sqrt(o);if(s=s-i.size-r.size,s>0)a=this.scaling*i.mass*r.mass/(s*s);else{if(!(s<0))return;a=100*this.scaling*i.mass*r.mass}}else a=this.scaling*i.mass*r.mass/o;e.scaleAndAdd(i.force,i.force,t,a),e.scaleAndAdd(r.force,r.force,t,-a)}}}}(),a.applyEdgeAttraction=function(){var t=e.create();return function(i){var r=i.source,n=i.target;e.sub(t,r.position,n.position);var o,a,s=e.len(t);o=0===this.edgeWeightInfluence?1:1===this.edgeWeightInfluence?i.weight:Math.pow(i.weight,this.edgeWeightInfluence),this.preventOverlap&&(s=s-r.size-n.size,s<=0)||(a=this.linLogMode?-o*Math.log(s+1)/(s+1):-o,e.scaleAndAdd(r.force,r.force,t,a),e.scaleAndAdd(n.force,n.force,t,-a))}}(),a.applyNodeGravity=function(){var t=e.create();return function(i){e.sub(t,this.gravityCenter,i.position);var r=e.len(t);e.scaleAndAdd(i.force,i.force,t,this.gravity*i.mass/(r+1))}}(),a.applyNodeStrongGravity=function(){var t=e.create();return function(i){e.sub(t,this.gravityCenter,i.position),e.scaleAndAdd(i.force,i.force,t,this.gravity*i.mass)}}(),a.updateBBox=function(){for(var e=1/0,t=1/0,i=-1/0,r=-1/0,n=0;n<this.nodes.length;n++){var o=this.nodes[n].position;e=Math.min(e,o[0]),t=Math.min(t,o[1]),i=Math.max(i,o[0]),r=Math.max(r,o[1])}this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=i,this.bbox[3]=r},a.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(e){switch(e.data.cmd){case"init":s=new o,s.initNodes(e.data.nodesPosition,e.data.nodesMass,e.data.nodesSize),s.initEdges(e.data.edges,e.data.edgesWeight);break;case"updateConfig":if(s)for(var t in e.data.config)s[t]=e.data.config[t];break;case"update":var i=e.data.steps;if(s){for(var r=0;r<i;r++)s.update();var n=s.nodes.length,a=new Float32Array(2*n);for(r=0;r<n;r++){var l=s.nodes[r];a[2*r]=l.position[0],a[2*r+1]=l.position[1]}self.postMessage({buffer:a.buffer,globalSpeed:s.getGlobalSpeed()},[a.buffer])}else{var h=new Float32Array;self.postMessage({buffer:h.buffer,globalSpeed:s.getGlobalSpeed()},[h.buffer])}break}}}var b=S,M=b.toString();M=M.slice(M.indexOf("{")+1,M.lastIndexOf("}"));var D={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},T=function(e){for(var t in D)this[t]=D[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new w.A({type:A.A.FLOAT,flipY:!1,minFilter:A.A.NEAREST,magFilter:A.A.NEAREST})};T.prototype.initData=function(e,t){var i=new Blob([M]),r=window.URL.createObjectURL(i);this._worker=new Worker(r),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var n=e.length,o=t.length,a=new Float32Array(2*n),s=new Float32Array(n),l=new Float32Array(n),h=new Float32Array(2*o),d=new Float32Array(o),u=0;u<e.length;u++){var c=e[u];a[2*u]=c.x,a[2*u+1]=c.y,s[u]=null==c.mass?1:c.mass,l[u]=null==c.size?1:c.size}for(u=0;u<t.length;u++){var g=t[u],p=g.node1,f=g.node2;h[2*u]=p,h[2*u+1]=f,d[u]=null==g.weight?1:g.weight}var m=Math.ceil(Math.sqrt(e.length)),v=m,_=new Float32Array(m*v*4),y=this._positionTex;y.width=m,y.height=v,y.pixels=_,this._worker.postMessage({cmd:"init",nodesPosition:a,nodesMass:s,nodesSize:l,edges:h,edgesWeight:d}),this._globalSpeed=1/0},T.prototype.updateOption=function(e){var t={};for(var i in D)t[i]=D[i];var r=this._nodes,n=this._edges,o=r.length;if(t.jitterTolerence=o>5e4?10:o>5e3?1:.1,t.scaling=o>100?2:10,t.barnesHutOptimize=o>1e3,e)for(var i in D)null!=e[i]&&(t[i]=e[i]);if(!t.gravityCenter){for(var a=[1/0,1/0],s=[-1/0,-1/0],l=0;l<r.length;l++)a[0]=Math.min(r[l].x,a[0]),a[1]=Math.min(r[l].y,a[1]),s[0]=Math.max(r[l].x,s[0]),s[1]=Math.max(r[l].y,s[1]);t.gravityCenter=[.5*(a[0]+s[0]),.5*(a[1]+s[1])]}for(l=0;l<n.length;l++){var h=n[l].node1,d=n[l].node2;r[h].degree=(r[h].degree||0)+1,r[d].degree=(r[d].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})},T.prototype.update=function(e,t,i){null==t&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=i,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})},T.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}},T.prototype.getNodePositionTexture=function(){return this._positionTex},T.prototype.getNodeUV=function(e,t){t=t||[];var i=this._positionTex.width,r=this._positionTex.height;return t[0]=e%i/(i-1),t[1]=Math.floor(e/i)/(r-1),t},T.prototype.getNodes=function(){return this._nodes},T.prototype.getEdges=function(){return this._edges},T.prototype.isFinished=function(e){return this._frame>e},T.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(2*this._nodes.length)),this._positionArr)for(var i=0;i<this._positionArr.length;i++)t[i]=this._positionArr[i];return t},T.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,i=0,r=0;r<e.length;)t[i++]=e[r++],t[i++]=e[r++],t[i++]=1,t[i++]=1;this._positionTex.dirty()},T.prototype.dispose=function(e){this._disposed=!0,this._worker=null};var L=T,C=i(84438),P=i(73737),E=i(46685),I=i(79093),O=i(6786),N=i(34486),G=P.A.vec2;c.A.Shader.import(N.A);var R=1,z=r.OZ.extend({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new c.A.Node,this.viewGL=new g.A("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new O.A(!0,t),this._forceEdgesMesh=new c.A.Mesh({material:new c.A.Material({shader:c.A.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new c.A.Geometry({attributes:{node:new c.A.Geometry.Attribute("node","float",2),color:new c.A.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:c.A.Mesh.LINES}),this._edgesMesh=new c.A.Mesh({material:new c.A.Material({shader:c.A.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new p.A({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new I.A({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,i){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=i,this._initLayout(e,t,i),this._pointsBuilder.update(e,t,i),this._forceLayoutInstance instanceof x||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,i),this._control.off("update"),this._control.on("update",(function(){i.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)}),this),this._control.setZoom(a.A.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var r=this._pointsBuilder.getPointsMesh();if(r.off("mousemove",this._mousemoveHandler),r.off("mouseout",this._mouseOutHandler,this),i.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var n=e.get("focusNodeAdjacencyOn");"click"===n?i.getZr().on("click",this._clickHandler):"mouseover"===n&&(r.on("mousemove",this._mousemoveHandler,this),r.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var i=this._forceEdgesMesh.geometry,r=t.getEdgeData(),n=0,o=this._forceLayoutInstance,s=2*r.count();i.attributes.node.init(s),i.attributes.color.init(s),r.each((function(t){var s=e[t];i.attributes.node.set(n,o.getNodeUV(s.node1)),i.attributes.node.set(n+1,o.getNodeUV(s.node2));var l=(0,E.DQ)(r,s.dataIndex),h=c.A.parseColor(l);h[3]*=a.A.firstNotNull((0,E.fz)(r,s.dataIndex),1),i.attributes.color.set(n,h),i.attributes.color.set(n+1,h),n+=2})),i.dirty()},_updateMeshLinesGeometry:function(){var e=this._model.getEdgeData(),t=this._edgesMesh.geometry,i=(e=this._model.getEdgeData(),this._model.getData().getLayout("points"));t.resetOffset(),t.setVertexCount(e.count()*t.getLineVertexCount()),t.setTriangleCount(e.count()*t.getLineTriangleCount());var r=[],n=[],o=["lineStyle","width"];this._originalEdgeColors=new Float32Array(4*e.count()),this._edgeIndicesMap=new Float32Array(e.count()),e.each((function(s){var l=e.graph.getEdgeByIndex(s),h=2*l.node1.dataIndex,d=2*l.node2.dataIndex;r[0]=i[h],r[1]=i[h+1],n[0]=i[d],n[1]=i[d+1];var u=(0,E.DQ)(e,l.dataIndex),g=c.A.parseColor(u);g[3]*=a.A.firstNotNull((0,E.fz)(e,l.dataIndex),1);var p=e.getItemModel(l.dataIndex),f=a.A.firstNotNull(p.get(o),1)*this._api.getDevicePixelRatio();t.addLine(r,n,g,f);for(var m=0;m<4;m++)this._originalEdgeColors[4*l.dataIndex+m]=g[m];this._edgeIndicesMap[l.dataIndex]=s}),this),t.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),i=[],r=0;r<e.count();r++)this._forceLayoutInstance.getNodeUV(r,i),t.geometry.attributes.position.set(r,i);t.geometry.dirty("position")},_initLayout:function(e,t,i){var n=e.get("layout"),o=e.getGraph(),s=e.getBoxLayoutParams(),l=(0,u.dV)(s,{width:i.getWidth(),height:i.getHeight()});"force"===n&&(n="forceAtlas2"),this.stopLayout(e,t,i,{beforeLayout:!0});var h=e.getData(),d=e.getData();if("forceAtlas2"===n){var c=e.getModel("forceAtlas2"),g=this._forceLayoutInstance,p=[],f=[],m=h.getDataExtent("value"),v=d.getDataExtent("value"),_=a.A.firstNotNull(c.get("edgeWeight"),1),y=a.A.firstNotNull(c.get("nodeWeight"),1);"number"===typeof _&&(_=[_,_]),"number"===typeof y&&(y=[y,y]);var w=0,A={},S=new Float32Array(2*h.count());if(o.eachNode((function(e){var t,i,n=e.dataIndex,o=h.get("value",n);if(h.hasItemOption){var a=h.getItemModel(n);t=a.get("x"),i=a.get("y")}null==t&&(t=l.x+Math.random()*l.width,i=l.y+Math.random()*l.height),S[2*w]=t,S[2*w+1]=i,A[e.id]=w++;var s=r.ai.linearMap(o,m,y);isNaN(s)&&(s=isNaN(y[0])?1:y[0]),p.push({x:t,y:i,mass:s,size:h.getItemVisual(n,"symbolSize")})})),h.setLayout("points",S),o.eachEdge((function(e){var t=e.dataIndex,i=h.get("value",t),n=r.ai.linearMap(i,v,_);isNaN(n)&&(n=isNaN(_[0])?1:_[0]),f.push({node1:A[e.node1.id],node2:A[e.node2.id],weight:n,dataIndex:t})})),!g){var b=c.get("GPU");this._forceLayoutInstance&&((!b||this._forceLayoutInstance instanceof x)&&(b||this._forceLayoutInstance instanceof L)||(this._forceLayoutInstanceToDispose=this._forceLayoutInstance)),g=this._forceLayoutInstance=b?new x:new L}g.initData(p,f),g.updateOption(c.option),this._updateForceEdgesGeometry(g.getEdges(),e),this._updatePositionTexture(),i.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{S=new Float32Array(2*h.count()),w=0;o.eachNode((function(e){var t,i,r=e.dataIndex;if(h.hasItemOption){var n=h.getItemModel(r);t=n.get("x"),i=n.get("y")}S[w++]=t,S[w++]=i})),h.setLayout("points",S),this._updateAfterLayout(e,t,i)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,i,r){if(!r||null==r.from||r.from===this.uid){var n=this.viewGL,o=(i=this._api,this._forceLayoutInstance),a=this._model.getData(),s=this._model.getModel("forceAtlas2");if(o&&(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),this._forceLayoutInstance)){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var l=this,h=this._layoutId=R++,d=s.getShallow("maxSteps"),u=s.getShallow("steps"),c=0,g=Math.max(2*u,20),p=function(t){if(t===l._layoutId)return o.isFinished(d)?(i.dispatchAction({type:"graphGLStopLayout",from:l.uid}),void i.dispatchAction({type:"graphGLFinishLayout",points:a.getLayout("points"),from:l.uid})):void o.update(n.layer.renderer,u,(function(){l._updatePositionTexture(),c+=u,c>=g&&(l._syncNodePosition(e),c=0),i.getZr().refresh(),(0,C.A)((function(){p(t)}))}))};(0,C.A)((function(){l._forceLayoutInstanceToDispose&&(l._forceLayoutInstanceToDispose.dispose(n.layer.renderer),l._forceLayoutInstanceToDispose=null),p(h)})),this._layouting=!0}}},stopLayout:function(e,t,i,r){r&&null!=r.from&&r.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(r&&r.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,i)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,i){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,i),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,i,r){var n=this._model.getData();this._downplayAll();var o=r.dataIndex,a=n.graph,s=[],l=a.getNodeByIndex(o);s.push(l),l.edges.forEach((function(e){e.dataIndex<0||(e.node1!==l&&s.push(e.node1),e.node2!==l&&s.push(e.node2))}),this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach((function(e){this._pointsBuilder.highlight(n,e.dataIndex)}),this),this._pointsBuilder.updateLabels(s.map((function(e){return e.dataIndex})));var h=[];l.edges.forEach((function(e){e.dataIndex>=0&&(this._highlightEdge(e.dataIndex),h.push(e))}),this),this._focusNodes=s,this._focusEdges=h},unfocusNodeAdjacency:function(e,t,i,r){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),i=c.A.parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),r=a.A.firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);i[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],i)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach((function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)}),this),this._focusEdges&&this._focusEdges.forEach((function(e){this._downplayEdge(e.dataIndex)}),this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,i){this._getColor(t,e),e[3]*=i,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var i=0;i<4;i++)t[i]=this._originalEdgeColors[4*e+i];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge((function(t){this._setEdgeFade(t.dataIndex,e)}),this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var i=this.viewGL.camera,r=e.getData(),n=r.getLayout("points"),o=G.create(1/0,1/0),a=G.create(-1/0,-1/0),s=[],l=0;l<n.length;)s[0]=n[l++],s[1]=n[l++],G.min(o,o,s),G.max(a,a,s);var h=(a[1]+o[1])/2,d=(a[0]+o[0])/2;if(!(d>i.left&&d<i.right&&h<i.bottom&&h>i.top)){var u=Math.max(a[0]-o[0],10),c=u/t.getWidth()*t.getHeight();u*=1.4,c*=1.4,o[0]-=.2*u,i.left=o[0],i.top=h-c/2,i.bottom=h+c/2,i.right=u+o[0],i.near=0,i.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1,this._pointsBuilder.dispose()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}});function B(e){return e instanceof Array||(e=[e,e]),e}function F(e){function t(){}e.registerChartView(z),e.registerSeriesModel(d),e.registerVisual((function(e){const t={};e.eachSeriesByType("graphGL",(function(e){var i=e.getCategoriesData(),n=e.getData(),o={};i.each((function(r){var n=i.getName(r);o["ec-"+n]=r;var a=i.getItemModel(r),s=a.getModel("itemStyle").getItemStyle();s.fill||(s.fill=e.getColorFromPalette(n,t)),i.setItemVisual(r,"style",s);var l=["symbol","symbolSize","symbolKeepAspect"];for(let e=0;e<l.length;e++){var h=a.getShallow(l[e],!0);null!=h&&i.setItemVisual(r,l[e],h)}})),i.count()&&n.each((function(e){var t=n.getItemModel(e);let a=t.getShallow("category");if(null!=a){"string"===typeof a&&(a=o["ec-"+a]);var s=i.getItemVisual(a,"style"),l=n.ensureUniqueItemVisual(e,"style");r.ZS.extend(l,s);var h=["symbol","symbolSize","symbolKeepAspect"];for(let t=0;t<h.length;t++)n.setItemVisual(e,h[t],i.getItemVisual(a,h[t]))}}))}))})),e.registerVisual((function(e){e.eachSeriesByType("graphGL",(function(e){var t=e.getGraph(),i=e.getEdgeData(),n=B(e.get("edgeSymbol")),o=B(e.get("edgeSymbolSize"));i.setVisual("drawType","stroke"),i.setVisual("fromSymbol",n&&n[0]),i.setVisual("toSymbol",n&&n[1]),i.setVisual("fromSymbolSize",o&&o[0]),i.setVisual("toSymbolSize",o&&o[1]),i.setVisual("style",e.getModel("lineStyle").getLineStyle()),i.each((function(e){var n=i.getItemModel(e),o=t.getEdgeByIndex(e),a=B(n.getShallow("symbol",!0)),s=B(n.getShallow("symbolSize",!0)),l=n.getModel("lineStyle").getLineStyle(),h=i.ensureUniqueItemVisual(e,"style");switch(r.ZS.extend(h,l),h.stroke){case"source":var d=o.node1.getVisual("style");h.stroke=d&&d.fill;break;case"target":d=o.node2.getVisual("style");h.stroke=d&&d.fill;break}a[0]&&o.setVisual("fromSymbol",a[0]),a[1]&&o.setVisual("toSymbol",a[1]),s[0]&&o.setVisual("fromSymbolSize",s[0]),s[1]&&o.setVisual("toSymbolSize",s[1])}))}))})),e.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},(function(e,t){t.eachComponent({mainType:"series",query:e},(function(t){t.setView(e)}))})),e.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},t),e.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},t),e.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},t),e.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},t)}(0,r.Yx)(F)},2717:function(e,t,i){"use strict";var r=i(85811),n=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(48622),i(195)),o=i(76621),a=r.rP.extend({type:"series.line3D",dependencies:["grid3D"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){return(0,o.A)(this)},formatTooltip:function(e){return(0,n.A)(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}}),s=a,l=(i(44114),i(9489)),h=i(69665),d=i(97758),u=i(21647),c=i(504),g=i(52274),p=i(73737),f=i(46685),m=i(74133),v=p.A.vec3;l.A.Shader.import(m.A);var _=r.OZ.extend({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new l.A.Node,this._api=t},render:function(e,t,i){var r=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=r,this._line3DMesh||(this._line3DMesh=new l.A.Mesh({geometry:new d.A({useNativeLine:!1,sortTriangles:!0}),material:new l.A.Material({shader:l.A.createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var n=e.coordinateSystem;if(n&&n.viewGL){n.viewGL.add(this.groupGL);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[o]("fragment","SRGB_DECODE")}this._doRender(e,i),this._data=e.getData(),this._camera=n.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var i=e.getData(),r=this._line3DMesh;r.geometry.resetOffset();var n=i.getLayout("points"),o=[],a=new Float32Array(n.length/3*4),s=0,d=!1;i.each((function(e){var t=(0,f.DQ)(i,e),r=(0,f.fz)(i,e);null==r&&(r=1),l.A.parseColor(t,o),o[3]*=r,a[s++]=o[0],a[s++]=o[1],a[s++]=o[2],a[s++]=o[3],o[3]<.99&&(d=!0)})),r.geometry.setVertexCount(r.geometry.getPolylineVertexCount(n)),r.geometry.setTriangleCount(r.geometry.getPolylineTriangleCount(n)),r.geometry.addPolyline(n,a,h.A.firstNotNull(e.get("lineStyle.width"),1)),r.geometry.dirty(),r.geometry.updateBoundingBox();var u=r.material;u.transparent=d,u.depthMask=!d;var c=e.getModel("debug.wireframe");c.get("show")?(r.geometry.createAttribute("barycentric","float",3),r.geometry.generateBarycentric(),r.material.set("both","WIREFRAME_TRIANGLE"),r.material.set("wireframeLineColor",l.A.parseColor(c.get("lineStyle.color")||"rgba(0,0,0,0.5)")),r.material.set("wireframeLineWidth",h.A.firstNotNull(c.get("lineStyle.width"),1))):r.material.set("both","WIREFRAME_TRIANGLE"),this._points=n,this._initHandler(e,t)},_updateAnimation:function(e){l.A.updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var i=e.getData(),r=e.coordinateSystem,n=this._line3DMesh,o=-1;n.seriesIndex=e.seriesIndex,n.off("mousemove"),n.off("mouseout"),n.on("mousemove",(function(e){var a=r.pointToData(e.point.array),s=i.indicesOfNearest("x",a[0])[0];s!==o&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get("x",s),i.get("y",s),i.get("z",s)]}),n.dataIndex=s),o=s}),this),n.on("mouseout",(function(e){o=-1,n.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_updateNDCPosition:function(){var e=new u.A,t=this._camera;u.A.multiply(e,t.projectionMatrix,t.viewMatrix);var i=this._positionNDC,r=this._points,n=r.length/3;i&&i.length/2===n||(i=this._positionNDC=new Float32Array(2*n));for(var o=[],a=0;a<n;a++){var s=3*a,l=2*a;o[0]=r[s],o[1]=r[s+1],o[2]=r[s+2],o[3]=1,v.transformMat4(o,o,e.array),i[l]=o[0]/o[3],i[l+1]=o[1]/o[3]}},_pick:function(e,t,i,r,n,o){var a=this._positionNDC,s=this._data.hostModel,l=s.get("lineStyle.width"),h=-1,d=i.viewport.width,u=i.viewport.height,p=.5*d,f=.5*u;e=(e+1)*p,t=(t+1)*f;for(var m=1;m<a.length/2;m++){var v=(a[2*(m-1)]+1)*p,_=(a[2*(m-1)+1]+1)*f,y=(a[2*m]+1)*p,x=(a[2*m+1]+1)*f;if(g.l(v,_,y,x,l,e,t)){var w=(v-e)*(v-e)+(_-t)*(_-t),A=(y-e)*(y-e)+(x-t)*(x-t);h=w<A?m-1:m}}if(h>=0){var S=3*h,b=new c.A(this._points[S],this._points[S+1],this._points[S+2]);o.push({dataIndex:h,point:b,pointWorld:b.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(b)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function y(e){e.registerChartView(_),e.registerSeriesModel(s),e.registerLayout((function(e,t){e.eachSeriesByType("line3D",(function(e){var t=e.getData(),i=e.coordinateSystem;if(i){if("cartesian3D"!==i.type)return void 0;var r=new Float32Array(3*t.count()),n=[],o=[],a=i.dimensions,s=a.map((function(t){return e.coordDimToDataDim(t)[0]}));i&&t.each(s,(function(e,t,a,s){n[0]=e,n[1]=t,n[2]=a,i.dataToPoint(n,o),r[3*s]=o[0],r[3*s+1]=o[1],r[3*s+2]=o[2]})),t.setLayout("points",r)}}))}))}(0,r.Yx)(y)},4991:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(73737)),o=n.A.vec3,a=n.A.vec2,s=o.normalize,l=o.cross,h=o.sub,d=o.add,u=o.create,c=u(),g=u(),p=u(),f=u(),m=[],v=[];function _(e,t){a.copy(m,e[0]),a.copy(v,e[1]);var i=[],r=i[0]=u(),n=i[1]=u(),_=i[2]=u(),y=i[3]=u();t.dataToPoint(m,r),t.dataToPoint(v,y),s(c,r),h(g,y,r),s(g,g),l(p,g,c),s(p,p),l(g,c,p),d(n,c,g),s(n,n),s(c,y),h(g,r,y),s(g,g),l(p,g,c),s(p,p),l(g,c,p),d(_,c,g),s(_,_),d(f,r,y),s(f,f);var x=o.dot(r,f),w=o.dot(f,n),A=(Math.max(o.len(r),o.len(y))-x)/w*2;return o.scaleAndAdd(n,r,n,A),o.scaleAndAdd(_,y,_,A),i}function y(e,t,i){var r=[],n=r[0]=o.create(),a=r[1]=o.create(),s=r[2]=o.create(),l=r[3]=o.create();t.dataToPoint(e[0],n),t.dataToPoint(e[1],l);var h=o.dist(n,l);return o.lerp(a,n,l,.3),o.lerp(s,n,l,.3),o.scaleAndAdd(a,a,i,Math.min(.1*h,10)),o.scaleAndAdd(s,s,i,Math.min(.1*h,10)),r}function x(e,t){for(var i=new Float32Array(3*e.length),r=0,n=[],o=0;o<e.length;o++)t.dataToPoint(e[o],n),i[r++]=n[0],i[r++]=n[1],i[r++]=n[2];return i}function w(e){var t=[];return e.each((function(i){var r=e.getItemModel(i),n=r.option instanceof Array?r.option:r.getShallow("coords",!0);t.push(n)})),{coordsList:t}}function A(e,t){var i=e.getData(),r=e.get("polyline");i.setLayout("lineType",r?"polyline":"cubicBezier");var n=w(i);i.each((function(e){var o=n.coordsList[e],a=r?x:_;i.setItemLayout(e,a(o,t))}))}function S(e,t,i){var r=e.getData(),n=e.get("polyline"),o=w(r);r.setLayout("lineType",n?"polyline":"cubicBezier"),r.each((function(e){var a=o.coordsList[e],s=n?x(a,t):y(a,t,i);r.setItemLayout(e,s)}))}function b(e,t){e.eachSeriesByType("lines3D",(function(e){var t=e.coordinateSystem;"globe"===t.type?A(e,t):"geo3D"===t.type?S(e,t,[0,1,0]):"mapbox3D"!==t.type&&"maptalks3D"!==t.type||S(e,t,[0,0,1])}))}var M=r.rP.extend({type:"series.lines3D",dependencies:["globe"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){var i=new r.B8(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],(function(e,t,r,n){if(e instanceof Array)return NaN;i.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[n]:o:void 0})),i},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}}),D=i(9489),T=i(97758),L="@export ecgl.trail2.vertex\nattribute vec3 position: POSITION;\nattribute vec3 positionPrev;\nattribute vec3 positionNext;\nattribute float offset;\nattribute float dist;\nattribute float distAll;\nattribute float start;\n\nattribute vec4 a_Color : COLOR;\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\nuniform float near : NEAR;\n\nuniform float speed : 0;\nuniform float trailLength: 0.3;\nuniform float time;\nuniform float period: 1000;\n\nuniform float spotSize: 1;\n\nvarying vec4 v_Color;\nvarying float v_Percent;\nvarying float v_SpotPercent;\n\n@import ecgl.common.wireframe.vertexHeader\n\n@import ecgl.lines3D.clipNear\n\nvoid main()\n{\n @import ecgl.lines3D.expandLine\n\n gl_Position = currProj;\n\n v_Color = a_Color;\n\n @import ecgl.common.wireframe.vertexMain\n\n#ifdef CONSTANT_SPEED\n float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;\n#else\n float t = mod((time + start) / period, 1. + trailLength) - trailLength;\n#endif\n\n float trailLen = distAll * trailLength;\n\n v_Percent = (dist - t * distAll) / trailLen;\n\n v_SpotPercent = spotSize / distAll;\n\n }\n@end\n\n\n@export ecgl.trail2.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform float spotIntensity: 5;\n\nvarying vec4 v_Color;\nvarying float v_Percent;\nvarying float v_SpotPercent;\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.util.srgb\n\nvoid main()\n{\n if (v_Percent > 1.0 || v_Percent < 0.0) {\n discard;\n }\n\n float fade = v_Percent;\n\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n gl_FragColor = color * v_Color;\n#endif\n\n @import ecgl.common.wireframe.fragmentMain\n\n if (v_Percent > (1.0 - v_SpotPercent)) {\n gl_FragColor.rgb *= spotIntensity;\n }\n\n gl_FragColor.a *= fade;\n}\n\n@end",C=i(46685),P=n.A.vec3;function E(e){return e>0?1:-1}D.A.Shader.import(L);var I=D.A.Mesh.extend((function(){var e=new D.A.Material({shader:new D.A.Shader(D.A.Shader.source("ecgl.trail2.vertex"),D.A.Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new T.A({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}}),{updateData:function(e,t,i){var r=e.hostModel,n=this.geometry,o=r.getModel("effect"),a=o.get("trailWidth")*t.getDevicePixelRatio(),s=o.get("trailLength"),l=r.get("effect.constantSpeed"),h=1e3*r.get("effect.period"),d=null!=l;d?this.material.set("speed",l/1e3):this.material.set("period",h),this.material[d?"define":"undefine"]("vertex","CONSTANT_SPEED");var u=r.get("polyline");n.trailLength=s,this.material.set("trailLength",s),n.resetOffset(),["position","positionPrev","positionNext"].forEach((function(e){n.attributes[e].value=i.attributes[e].value}));var c=["dist","distAll","start","offset","color"];c.forEach((function(e){n.attributes[e].init(n.vertexCount)})),n.indices=i.indices;var g=[],p=o.get("trailColor"),f=o.get("trailOpacity"),m=null!=p,v=null!=f;this.updateWorldTransform();var _=this.worldTransform.x.len(),y=this.worldTransform.y.len(),x=this.worldTransform.z.len(),w=0,A=0;e.each((function(t){var r=e.getItemLayout(t),o=v?f:(0,C.fz)(e,t),s=(0,C.DQ)(e,t);null==o&&(o=1),g=D.A.parseColor(m?p:s,g),g[3]*=o;for(var l=u?i.getPolylineVertexCount(r):i.getCubicCurveVertexCount(r[0],r[1],r[2],r[3]),c=0,S=[],b=[],M=w;M<w+l;M++)n.attributes.position.get(M,S),S[0]*=_,S[1]*=y,S[2]*=x,M>w&&(c+=P.dist(S,b)),n.attributes.dist.set(M,c),P.copy(b,S);A=Math.max(A,c);var T=Math.random()*(d?c:h);for(M=w;M<w+l;M++)n.attributes.distAll.set(M,c),n.attributes.start.set(M,T),n.attributes.offset.set(M,E(i.attributes.offset.get(M))*a/2),n.attributes.color.set(M,g);w+=l})),this.material.set("spotSize",.1*A*s),this.material.set("spotIntensity",o.get("spotIntensity")),n.dirty()},setAnimationTime:function(e){this.material.set("time",e)}}),O=i(74133);function N(e){return null!=e.radius?e.radius:null!=e.size?Math.max(e.size[0],e.size[1],e.size[2]):100}D.A.Shader.import(O.A);var G=r.OZ.extend({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new D.A.Node,this._meshLinesMaterial=new D.A.Material({shader:D.A.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new D.A.Mesh({geometry:new T.A,material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new I},render:function(e,t,i){this.groupGL.add(this._linesMesh);var r=e.coordinateSystem,n=e.getData();if(r&&r.viewGL){var o=r.viewGL;o.add(this.groupGL),this._updateLines(e,t,i);var a=r.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[a]("fragment","SRGB_DECODE"),this._trailMesh.material[a]("fragment","SRGB_DECODE")}var s=this._trailMesh;if(s.stopAnimation(),e.get("effect.show")){this.groupGL.add(s),s.updateData(n,i,this._linesMesh.geometry),s.__time=s.__time||0;var l=36e5;this._curveEffectsAnimator=s.animate("",{loop:!0}).when(l,{__time:l}).during((function(){s.setAnimationTime(s.__time)})).start()}else this.groupGL.remove(s),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend="lighter"===e.get("blendMode")?D.A.additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,i){var r=e.getData(),n=e.coordinateSystem,o=this._linesMesh.geometry,a=e.get("polyline");o.expandLine=!0;var s=N(n);o.segmentScale=s/20;var l="lineStyle.width".split("."),h=i.getDevicePixelRatio(),d=0;r.each((function(e){var t=r.getItemModel(e),i=t.get(l);null==i&&(i=1),r.setItemVisual(e,"lineWidth",i),d=Math.max(i,d)})),o.useNativeLine=!1;var u=0,c=0;r.each((function(e){var t=r.getItemLayout(e);a?(u+=o.getPolylineVertexCount(t),c+=o.getPolylineTriangleCount(t)):(u+=o.getCubicCurveVertexCount(t[0],t[1],t[2],t[3]),c+=o.getCubicCurveTriangleCount(t[0],t[1],t[2],t[3]))})),o.setVertexCount(u),o.setTriangleCount(c),o.resetOffset();var g=[];r.each((function(e){var t=r.getItemLayout(e),i=(0,C.DQ)(r,e),n=(0,C.fz)(r,e),s=r.getItemVisual(e,"lineWidth")*h;null==n&&(n=1),g=D.A.parseColor(i,g),g[3]*=n,a?o.addPolyline(t,g,s):o.addCubicCurve(t[0],t[1],t[2],t[3],g,s)})),o.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function R(e){e.registerChartView(G),e.registerSeriesModel(M),e.registerLayout(b),e.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},(function(){})),e.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},(function(){})),e.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},(function(){}))}(0,r.Yx)(R)},14659:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(44397)),o=r.rP.extend({type:"series.linesGL",dependencies:["grid","geo"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),o.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),o.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=(0,n.yB)(this._flatCoords,t.flatCoords),this._flatCoordsOffset=(0,n.yB)(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),i=t.option instanceof Array?t.option:t.getShallow("coords");return i},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[2*e+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[2*e],r=this._flatCoordsOffset[2*e+1],n=0;n<r;n++)t[n]=t[n]||[],t[n][0]=this._flatCoords[i+2*n],t[n][1]=this._flatCoords[i+2*n+1];return r}var o=this._getCoordsFromItemModel(e);for(n=0;n<o.length;n++)t[n]=t[n]||[],t[n][0]=o[n][0],t[n][1]=o[n][1];return o.length},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),"number"===typeof e[0]){for(var i=e.length,r=new Uint32Array(i),n=new Float64Array(i),o=0,a=0,s=0,l=0;l<i;){s++;var h=e[l++];r[a++]=o+t,r[a++]=h;for(var d=0;d<h;d++){var u=e[l++],c=e[l++];n[o++]=u,n[o++]=c}}return{flatCoordsOffset:new Uint32Array(r.buffer,0,a),flatCoords:n,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var i=new r.B8(["value"],this);return i.hasItemOption=!1,i.initData(e.data,[],(function(e,t,r,n){if(e instanceof Array)return NaN;i.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[n]:o:void 0})),i},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}}),a=o,s=i(9489),l=i(63858),h=i(1163),d=i(32115),u=i(46685),c=i(69665),g=r.OZ.extend({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new s.A.Node,this.viewGL=new l.A("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new d.A(this.viewGL),this._nativeLinesShader=s.A.createShader("ecgl.lines3D"),this._meshLinesShader=s.A.createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i);var r=this._linesMeshes[0];r||(r=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(r),this._updateLinesMesh(e,r,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){var n=this._linesMeshes[this._currentStep];n||(n=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=n),this._updateLinesMesh(t,n,e.start,e.end),this.groupGL.add(n),r.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,i){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,i)},_createLinesMesh:function(e){var t=new s.A.Mesh({$ignorePicking:!0,material:new s.A.Material({shader:s.A.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new h.A({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:s.A.Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,i,r){var n=e.getData();t.material.blend="lighter"===e.get("blendMode")?s.A.additiveBlend:null;var o=e.get("lineStyle.curveness")||0,a=e.get("polyline"),l=t.geometry,h=e.coordinateSystem,d=c.A.firstNotNull(e.get("lineStyle.width"),1);d>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=s.A.Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=s.A.Mesh.LINES),i=i||0,r=r||n.count(),l.resetOffset();var g=0,p=0,f=[],m=[],v=[],_=[],y=[],x=.3,w=.7;function A(){m[0]=f[0]*w+_[0]*x-(f[1]-_[1])*o,m[1]=f[1]*w+_[1]*x-(_[0]-f[0])*o,v[0]=f[0]*x+_[0]*w-(f[1]-_[1])*o,v[1]=f[1]*x+_[1]*w-(_[0]-f[0])*o}if(a||0!==o)for(var S=i;S<r;S++)if(a){var b=e.getLineCoordsCount(S);g+=l.getPolylineVertexCount(b),p+=l.getPolylineTriangleCount(b)}else e.getLineCoords(S,y),this._glViewHelper.dataToPoint(h,y[0],f),this._glViewHelper.dataToPoint(h,y[1],_),A(),g+=l.getCubicCurveVertexCount(f,m,v,_),p+=l.getCubicCurveTriangleCount(f,m,v,_);else{var M=r-i;g+=M*l.getLineVertexCount(),p+=M*l.getLineVertexCount()}l.setVertexCount(g),l.setTriangleCount(p);var D=i,T=[];for(S=i;S<r;S++){s.A.parseColor((0,u.DQ)(n,D),T);var L=c.A.firstNotNull((0,u.fz)(n,D),1);T[3]*=L;b=e.getLineCoords(S,y);for(var C=0;C<b;C++)this._glViewHelper.dataToPoint(h,y[C],y[C]);a?l.addPolyline(y,T,d,0,b):0!==o?(f=y[0],_=y[1],A(),l.addCubicCurve(f,m,v,_,T,d)):l.addPolyline(y,T,d,0,2),D++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function p(e){e.registerChartView(g),e.registerSeriesModel(a)}(0,r.Yx)(p)},18569:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),i(43376)),o=i(75971),a=i(76238),s=i(59176),l=i(97483),h=i(31550),d=i(195),u=i(99961);function c(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var g=r.rP.extend({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualStyleAccessPath:"itemStyle",optionUpdated:function(e){e=e||{};var t=this.get("coordinateSystem");null!=t&&"geo3D"!==t&&(this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null)},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=r.dw.createDimensions(e.data,{coordDimensions:["value"]}),i=new r.B8(t,this);i.initData(e.data);var n={};return i.each((function(e){var t=i.getName(e),r=i.getItemModel(e);n[t]=r})),this._regionModelMap=n,i},formatTooltip:function(e){return(0,d.A)(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new r.Kx(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getName(e);if(t.transform){var r=t.getRegion(i);return r?r.geometries:[]}this._geo||(this._geo=u.A.createGeo3D(this));r=this._geo.getRegion(i);for(var n=[],o=0;o<r.geometries.length;o++){var a=r.geometries[o],s=[],l=c(t,a.exterior);if(s&&s.length)for(var h=0;h<a.interiors.length;h++)s.push(c(t,s[h]));n.push({interiors:s,exterior:l})}return n},getFormattedLabel:function(e,t){var i=h.A.getFormattedLabel(this,e,t);return null==i&&(i=this.getData().getName(e)),i},defaultOption:{coordinateSystem:"geo3D",data:null}});r.ZS.merge(g.prototype,l.A),r.ZS.merge(g.prototype,n.A),r.ZS.merge(g.prototype,o.A),r.ZS.merge(g.prototype,a.A),r.ZS.merge(g.prototype,s.A);var p=g,f=i(9489),m=i(76800),v=i(99628),_=i(45711),y=r.OZ.extend({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new _.A(t),this.groupGL=new f.A.Node},render:function(e,t,i){var r=e.coordinateSystem;if(r&&r.viewGL){if(this.groupGL.add(this._geo3DBuilder.rootNode),r.viewGL.add(this.groupGL),"geo3D"===r.type){this._sceneHelper||(this._sceneHelper=new v.A,this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var n=this._control;n||(n=this._control=new m.A({zr:i.getZr()}),this._control.init());var o=e.getModel("viewControl");n.setViewGL(r.viewGL),n.setFromViewControlModel(o,0),n.off("update"),n.on("update",(function(){i.dispatchAction({type:"map3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),from:this.uid,map3DId:e.id})})),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,i,0,e.getData().count());var a=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse((function(e){e.material&&e.material[a]("fragment","SRGB_DECODE")}))}},afterRender:function(e,t,i,r){var n=r.renderer,o=e.coordinateSystem;o&&"geo3D"===o.type&&(this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i))},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._geo3DBuilder.dispose()}}),x=i(83931);function w(e){(0,x.a)(e),e.registerChartView(y),e.registerSeriesModel(p),e.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"series",subType:"map3D",query:e},(function(t){t.setView(e)}))}))}(0,r.Yx)(w)},46957:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),i(59176));function o(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.dataToPoint(t[r]));return i}var a=r.rP.extend({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,i=this.getData().getItemModel(e),r=i.option instanceof Array?i.option:i.getShallow("coords");i.get("multiPolygon")||(r=[r]);for(var n=[],a=0;a<r.length;a++){for(var s=[],l=1;l<r[a].length;l++)s.push(o(t,r[a][l]));n.push({exterior:o(t,r[a][0]),interiors:s})}return n},getInitialData:function(e){var t=new r.B8(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],(function(e,i,r,n){if(e instanceof Array)return NaN;t.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[n]:o:void 0})),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});r.ZS.merge(a.prototype,n.A);var s=a,l=i(45711),h=i(9489),d=r.OZ.extend({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new h.A.Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL);var n=this._geo3DBuilderList[0];n||(n=new l.A(i),n.extrudeY="mapbox3D"!==r.type&&"maptalks3D"!==r.type,this._geo3DBuilderList[0]=n),this._updateShaderDefines(r,n),n.update(e,t,i),this._geo3DBuilderList.length=1,this.groupGL.add(n.rootNode)},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,i,r){var n=this._geo3DBuilderList[this._currentStep],o=t.coordinateSystem;n||(n=new l.A(r),n.extrudeY="mapbox3D"!==o.type&&"maptalks3D"!==o.type,this._geo3DBuilderList[this._currentStep]=n),n.update(t,i,r,e.start,e.end),this.groupGL.add(n.rootNode),this._updateShaderDefines(o,n),this._currentStep++},_updateShaderDefines:function(e,t){var i=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse((function(t){t.material&&(t.material[i]("fragment","SRGB_DECODE"),"mapbox3D"!==e.type&&"maptalks3D"!==e.type||(t.material.define("fragment","NORMAL_UP_AXIS",2),t.material.define("fragment","NORMAL_FRONT_AXIS",1)))}))},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll(),this._geo3DBuilderList.forEach((function(e){e.dispose()}))}});function u(e){e.registerChartView(d),e.registerSeriesModel(s)}(0,r.Yx)(u)},83398:function(e,t,i){"use strict";var r=i(85811),n=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(48622),i(31550)),o=i(195),a=i(76621),s=r.rP.extend({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(e,t){return(0,a.A)(this)},getFormattedLabel:function(e,t,i,r){var o=n.A.getFormattedLabel(this,e,t,i,r);if(null==o){var a=this.getData(),s=a.dimensions[a.dimensions.length-1];o=a.get(s,e)}return o},formatTooltip:function(e){return(0,o.A)(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}}),l=i(9489),h=i(69665),d=i(6786),u=r.OZ.extend({type:"scatter3D",hasSymbolVisual:!0,__ecgl__:!0,init:function(e,t){this.groupGL=new l.A.Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,i){if(this.groupGL.removeAll(),e.getData().count()){var r=e.coordinateSystem;if(r&&r.viewGL){r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera;var n=this._pointsBuilderList[0];n||(n=this._pointsBuilderList[0]=new d.A(!1,i)),this._pointsBuilderList.length=1,this.groupGL.add(n.rootNode),n.update(e,t,i),n.updateView(r.viewGL.camera)}else 0}},incrementalPrepareRender:function(e,t,i){var r=e.coordinateSystem;r&&r.viewGL&&(r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera),this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new d.A(!1,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),n.update(t,i,r,e.start,e.end),n.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach((function(e){e.updateView(this._camera)}),this)},highlight:function(e,t,i,r){this._toggleStatus("highlight",e,t,i,r)},downplay:function(e,t,i,r){this._toggleStatus("downplay",e,t,i,r)},_toggleStatus:function(e,t,i,o,a){var s=t.getData(),l=h.A.queryDataIndex(s,a),d="highlight"===e;null!=l?r.ZS.each(n.A.normalizeToArray(l),(function(e){for(var t=0;t<this._pointsBuilderList.length;t++){var i=this._pointsBuilderList[t];d?i.highlight(s,e):i.downplay(s,e)}}),this):s.each((function(e){for(var t=0;t<this._pointsBuilderList.length;t++){var i=this._pointsBuilderList[t];d?i.highlight(s,e):i.downplay(s,e)}}))},dispose:function(){this._pointsBuilderList.forEach((function(e){e.dispose()})),this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function c(e){e.registerChartView(u),e.registerSeriesModel(s),e.registerLayout({seriesType:"scatter3D",reset:function(e){var t=e.coordinateSystem;if(t){var i=t.dimensions;if(i.length<3)return void 0;var r=i.map((function(t){return e.coordDimToDataDim(t)[0]})),n=[],o=[];return{progress:function(e,i){for(var a=new Float32Array(3*(e.end-e.start)),s=e.start;s<e.end;s++){var l=3*(s-e.start);n[0]=i.get(r[0],s),n[1]=i.get(r[1],s),n[2]=i.get(r[2],s),t.dataToPoint(n,o),a[l]=o[0],a[l+1]=o[1],a[l+2]=o[2]}i.setLayout("points",a)}}}}})}(0,r.Yx)(c)},21518:function(e,t,i){"use strict";var r=i(85811),n=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(48622),r.rP.extend({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(){return r.dw.createList(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}})),o=i(9489),a=i(63858),s=i(6786),l=i(32115),h=r.OZ.extend({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new o.A.Node,this.viewGL=new a.A("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new l.A(this.viewGL)},render:function(e,t,i){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,i),e.getData().count()){var r=this._pointsBuilderList[0];r||(r=this._pointsBuilderList[0]=new s.A(!0,i)),this._pointsBuilderList.length=1,this.groupGL.add(r.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),r.update(e,t,i),this.viewGL.setPostEffect(e.getModel("postEffect"),i)}},incrementalPrepareRender:function(e,t,i){this.groupGL.removeAll(),this._glViewHelper.reset(e,i),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),i)},incrementalRender:function(e,t,i,r){if(!(e.end<=e.start)){var n=this._pointsBuilderList[this._currentStep];n||(n=new s.A(!0,r),this._pointsBuilderList[this._currentStep]=n),this.groupGL.add(n.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),n.setSizeScale(this._sizeScale),n.update(t,i,r,e.start,e.end),r.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,i){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,i);var r=this._glViewHelper.getZoom(),n=Math.max((e.get("zoomScale")||0)*(r-1)+1,0);this._sizeScale=n,this._pointsBuilderList.forEach((function(e){e.setSizeScale(n)}))}},_removeTransformInPoints:function(e){if(e)for(var t=[],i=0;i<e.length;i+=2)t[0]=e[i],t[1]=e[i+1],this._glViewHelper.removeTransformInPoint(t),e[i]=t[0],e[i+1]=t[1]},dispose:function(){this.groupGL.removeAll(),this._pointsBuilderList.forEach((function(e){e.dispose()}))},remove:function(){this.groupGL.removeAll()}});function d(e){e.registerChartView(h),e.registerSeriesModel(n),e.registerLayout({seriesType:"scatterGL",reset:function(e){var t,i=e.coordinateSystem,r=e.getData();if(i){var n=i.dimensions.map((function(e){return r.mapDimension(e)})).slice(0,2),o=[];1===n.length?t=function(e){for(var t=new Float32Array(2*(e.end-e.start)),o=e.start;o<e.end;o++){var a=2*(o-e.start),s=r.get(n[0],o),l=i.dataToPoint(s);t[a]=l[0],t[a+1]=l[1]}r.setLayout("points",t)}:2===n.length&&(t=function(e){for(var t=new Float32Array(2*(e.end-e.start)),a=e.start;a<e.end;a++){var s=2*(a-e.start),l=r.get(n[0],a),h=r.get(n[1],a);o[0]=l,o[1]=h,o=i.dataToPoint(o),t[s]=o[0],t[s+1]=o[1]}r.setLayout("points",t)})}return{progress:t}}})}(0,r.Yx)(d)},75386:function(e,t,i){"use strict";var r=i(85811),n=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(48622),i(44114),i(59176)),o=i(195),a=i(76621),s=r.rP.extend({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",formatTooltip:function(e){return(0,o.A)(this,e)},getInitialData:function(e,t){var i=e.data;function n(e){return!(isNaN(e.min)||isNaN(e.max)||isNaN(e.step))}function o(e){var t=r.ai.getPrecisionSafe;return Math.max(t(e.min),t(e.max),t(e.step))+1}if(!i)if(e.parametric){var s=e.parametricEquation||{},l=s.u||{},h=s.v||{};["u","v"].forEach((function(e){n(s[e])})),["x","y","z"].forEach((function(e){s[e]}));var d=Math.floor((l.max+l.step-l.min)/l.step),u=Math.floor((h.max+h.step-h.min)/h.step);i=new Float32Array(d*u*5);var c=o(l),g=o(h);for(M=0,D=0;D<u;D++)for(T=0;T<d;T++){var p=T*l.step+l.min,f=D*h.step+h.min,m=r.ai.round(Math.min(p,l.max),c),v=r.ai.round(Math.min(f,h.max),g);L=s.x(m,v),C=s.y(m,v),I=s.z(m,v);i[M++]=L,i[M++]=C,i[M++]=I,i[M++]=m,i[M++]=v}}else{var _=e.equation||{},y=_.x||{},x=_.y||{};if(["x","y"].forEach((function(e){n(_[e])})),"function"!==typeof _.z)return void 0;var w=Math.floor((y.max+y.step-y.min)/y.step),A=Math.floor((x.max+x.step-x.min)/x.step);i=new Float32Array(w*A*3);for(var S=o(y),b=o(x),M=0,D=0;D<A;D++)for(var T=0;T<w;T++){var L=T*y.step+y.min,C=D*x.step+x.min,P=r.ai.round(Math.min(L,y.max),S),E=r.ai.round(Math.min(C,x.max),b),I=_.z(P,E);i[M++]=P,i[M++]=E,i[M++]=I}}var O=["x","y","z"];e.parametric&&O.push("u","v");var N=(0,a.A)(this,O,i);return N},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},dataShape:null,itemStyle:{},animationDurationUpdate:500}});r.ZS.merge(s.prototype,n.A);var l=s,h=i(9489),d=i(73737),u=i(30510),c=i(46685),g=d.A.vec3;function p(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}var f=r.OZ.extend({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new h.A.Node},render:function(e,t,i){var r=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=r,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var n=e.coordinateSystem,o=e.get("shading"),a=e.getData(),s="ecgl."+o;if(this._surfaceMesh.material&&this._surfaceMesh.material.shader.name===s||(this._surfaceMesh.material=h.A.createMaterial(s,["VERTEX_COLOR","DOUBLE_SIDED"])),h.A.setMaterialFromModel(o,this._surfaceMesh.material,e,i),n&&n.viewGL){n.viewGL.add(this.groupGL);var l=n.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[l]("fragment","SRGB_DECODE")}var d=e.get("parametric"),u=e.get("dataShape");u||(u=this._getDataShape(a,d));var c=e.getModel("wireframe"),g=c.get("lineStyle.width"),p=c.get("show")&&g>0;this._updateSurfaceMesh(this._surfaceMesh,e,u,p);var f=this._surfaceMesh.material;p?(f.define("WIREFRAME_QUAD"),f.set("wireframeLineWidth",g),f.set("wireframeLineColor",h.A.parseColor(c.get("lineStyle.color")))):f.undefine("WIREFRAME_QUAD"),this._initHandler(e,i),this._updateAnimation(e)},_updateAnimation:function(e){h.A.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new h.A.Mesh({geometry:new h.A.Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new h.A.Material({shader:new h.A.Shader(h.A.Shader.source("ecgl.sm.depth.vertex"),h.A.Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),Object.assign(e.geometry,u.A),e},_initHandler:function(e,t){var i=e.getData(),r=this._surfaceMesh,n=e.coordinateSystem;function o(e,t){for(var i=1/0,n=-1,o=[],a=0;a<e.length;a++){r.geometry.attributes.position.get(e[a],o);var s=g.dist(t.array,o);s<i&&(i=s,n=e[a])}return n}r.seriesIndex=e.seriesIndex;var a=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",(function(e){var s=o(e.triangle,e.point);if(s>=0){var l=[];r.geometry.attributes.position.get(s,l);for(var h=n.pointToData(l),d=1/0,u=-1,c=[],p=0;p<i.count();p++){c[0]=i.get("x",p),c[1]=i.get("y",p),c[2]=i.get("z",p);var f=g.squaredDistance(c,h);f<d&&(u=p,d=f)}u!==a&&t.dispatchAction({type:"grid3DShowAxisPointer",value:h}),a=u,r.dataIndex=u}else r.dataIndex=-1}),this),r.on("mouseout",(function(e){a=-1,r.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_updateSurfaceMesh:function(e,t,i,r){var n=e.geometry,o=t.getData(),a=o.getLayout("points"),s=0;o.each((function(e){o.hasValue(e)||s++}));var l=s||r,d=n.attributes.position,u=n.attributes.normal,f=n.attributes.texcoord0,m=n.attributes.barycentric,v=n.attributes.color,_=i[0],y=i[1],x=t.get("shading"),w="color"!==x;if(l){var A=(_-1)*(y-1)*4;d.init(A),r&&m.init(A)}else d.value=new Float32Array(a);v.init(n.vertexCount),f.init(n.vertexCount);var S=[0,3,1,1,3,2],b=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],M=n.indices=new(n.vertexCount>65535?Uint32Array:Uint16Array)((_-1)*(y-1)*6),D=function(e,t,i){i[1]=e*y+t,i[0]=e*y+t+1,i[3]=(e+1)*y+t+1,i[2]=(e+1)*y+t},T=!1;if(l){var L=[],C=[],P=0;w?u.init(n.vertexCount):u.value=null;for(var E=[[],[],[]],I=[],O=[],N=g.create(),G=function(e,t,i){var r=3*t;return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i},R=new Float32Array(a.length),z=new Float32Array(a.length/3*4),B=0;B<o.count();B++)if(o.hasValue(B)){var F=h.A.parseColor((0,c.DQ)(o,B)),k=(0,c.fz)(o,B);null!=k&&(F[3]*=k),F[3]<.99&&(T=!0);for(var V=0;V<4;V++)z[4*B+V]=F[V]}var H=[1e7,1e7,1e7];for(B=0;B<_-1;B++)for(var W=0;W<y-1;W++){var U=B*(y-1)+W,Z=4*U;D(B,W,L);var $=!1;for(V=0;V<4;V++)G(a,L[V],C),p(C)&&($=!0);for(V=0;V<4;V++)$?d.set(Z+V,H):(G(a,L[V],C),d.set(Z+V,C)),r&&m.set(Z+V,b[V]);for(V=0;V<6;V++)M[P++]=S[V]+Z;if(w&&!$)for(V=0;V<2;V++){for(var j=3*V,Y=0;Y<3;Y++){var X=L[S[j]+Y];G(a,X,E[Y])}g.sub(I,E[0],E[1]),g.sub(O,E[1],E[2]),g.cross(N,I,O);for(Y=0;Y<3;Y++){var q=3*L[S[j]+Y];R[q]=R[q]+N[0],R[q+1]=R[q+1]+N[1],R[q+2]=R[q+2]+N[2]}}}if(w)for(B=0;B<R.length/3;B++)G(R,B,N),g.normalize(N,N),R[3*B]=N[0],R[3*B+1]=N[1],R[3*B+2]=N[2];F=[];var Q=[];for(B=0;B<_-1;B++)for(W=0;W<y-1;W++){U=B*(y-1)+W,Z=4*U;D(B,W,L);for(V=0;V<4;V++){for(Y=0;Y<4;Y++)F[Y]=z[4*L[V]+Y];v.set(Z+V,F),w&&(G(R,L[V],N),u.set(Z+V,N));X=L[V];Q[0]=X%y/(y-1),Q[1]=Math.floor(X/y)/(_-1),f.set(Z+V,Q)}U++}}else{for(Q=[],B=0;B<o.count();B++){Q[0]=B%y/(y-1),Q[1]=Math.floor(B/y)/(_-1);F=h.A.parseColor((0,c.DQ)(o,B)),k=(0,c.fz)(o,B);null!=k&&(F[3]*=k),F[3]<.99&&(T=!0),v.set(B,F),f.set(B,Q)}L=[];var J=0;for(B=0;B<_-1;B++)for(W=0;W<y-1;W++){D(B,W,L);for(V=0;V<6;V++)M[J++]=L[S[V]]}w?n.generateVertexNormals():u.value=null}e.material.get("normalMap")&&n.generateTangents(),n.updateBoundingBox(),n.dirty(),e.material.transparent=T,e.material.depthMask=!T},_getDataShape:function(e,t){for(var i=-1/0,r=0,n=0,o=!1,a=t?"u":"x",s=e.count(),l=0;l<s;l++){var h=e.get(a,l);h<i&&(n=0,r++),i=h,n++}if(r&&1!==n||(o=!0),!o)return[r+1,n];var d=Math.floor(Math.sqrt(s));while(d>0){if(Math.floor(s/d)===s/d)return[d,s/d];d--}return d=Math.floor(Math.sqrt(s)),[d,d]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function m(e){e.registerChartView(f),e.registerSeriesModel(l),e.registerLayout((function(e,t){e.eachSeriesByType("surface",(function(e){var t=e.coordinateSystem;t&&t.type;var i=e.getData(),r=new Float32Array(3*i.count()),n=[NaN,NaN,NaN];if(t&&"cartesian3D"===t.type){var o=t.dimensions,a=o.map((function(t){return e.coordDimToDataDim(t)[0]}));i.each(a,(function(e,o,a,s){var l;l=i.hasValue(s)?t.dataToPoint([e,o,a]):n,r[3*s]=l[0],r[3*s+1]=l[1],r[3*s+2]=l[2]}))}i.setLayout("points",r)}))}))}(0,r.Yx)(m)},45711:function(e,t,i){"use strict";i(44114),i(16573),i(78100),i(77936),i(37467),i(44732),i(79577);var r=i(85811),n=i(9489),o=i(21761),a=i(97758),s=i(69665),l=i(73737),h=i(30510),d=i(4678),u=i(74133),c=i(46685),g=l.A.vec3;function p(e){this.rootNode=new n.A.Node,this._triangulationResults={},this._shadersMap=n.A.COMMON_SHADERS.filter((function(e){return"shadow"!==e})).reduce((function(e,t){return e[t]=n.A.createShader("ecgl."+t),e}),{}),this._linesShader=n.A.createShader("ecgl.meshLines3D");var t={};n.A.COMMON_SHADERS.forEach((function(e){t[e]=new n.A.Material({shader:n.A.createShader("ecgl."+e)})})),this._groundMaterials=t,this._groundMesh=new n.A.Mesh({geometry:new n.A.PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new d.A(512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}n.A.Shader.import(u.A),p.prototype={constructor:p,extrudeY:!0,update:function(e,t,i,r,n){var o=e.getData();null==r&&(r=0),null==n&&(n=o.count()),this._startIndex=r,this._endIndex=n-1,this._triangulation(e,r,n);var a=this._getShader(e.get("shading"));this._prepareMesh(e,a,i,r,n),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,i,r,n);var s=e.coordinateSystem;"geo3D"===s.type&&this._updateGroundPlane(e,s,i);var l=this;this._labelsBuilder.updateData(o,r,n),this._labelsBuilder.getLabelPosition=function(e,t,i){var r=o.getName(e),n=i;if("geo3D"===s.type){var a=s.getRegion(r);if(!a)return[NaN,NaN,NaN];u=a.getCenter();var h=s.dataToPoint([u[0],u[1],n]);return h}var d=l._triangulationResults[e-l._startIndex],u=l.extrudeY?[(d.max[0]+d.min[0])/2,d.max[1]+n,(d.max[2]+d.min[2])/2]:[(d.max[0]+d.min[0])/2,(d.max[1]+d.min[1])/2,d.max[2]+n]},this._data=o,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var t=new n.A.Mesh({name:"Polygon",material:new n.A.Material({shader:e._shadersMap.lambert}),geometry:new n.A.Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return Object.assign(t.geometry,h.A),t}var i=t(),r=new n.A.Mesh({material:new n.A.Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new a.A({useNativeLine:!1})});this.rootNode.add(i),this.rootNode.add(r),i.material.define("both","VERTEX_COLOR"),i.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=i,this._linesMesh=r,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,i,r,o){for(var a=0,s=0,l=0,h=0,d=r;d<o;d++){var u=this._getRegionPolygonInfo(d),c=this._getRegionLinesInfo(d,e,this._linesMesh.geometry);a+=u.vertexCount,s+=u.triangleCount,l+=c.vertexCount,h+=c.triangleCount}var g=this._polygonMesh,p=g.geometry;["position","normal","texcoord0","color"].forEach((function(e){p.attributes[e].init(a)})),p.indices=a>65535?new Uint32Array(3*s):new Uint16Array(3*s),g.material.shader!==t&&g.material.attachShader(t,!0),n.A.setMaterialFromModel(t.__shading,g.material,e,i),l>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(l),this._linesMesh.geometry.setTriangleCount(h)),this._dataIndexOfVertex=new Uint32Array(a),this._vertexRangeOfDataIndex=new Uint32Array(2*(o-r))},_updateRegionMesh:function(e,t,i,r){for(var o=e.getData(),a=0,l=0,h=!1,d=this._polygonMesh,u=this._linesMesh,g=i;g<r;g++){var p=e.getRegionModel(g),f=p.getModel("itemStyle"),m=s.A.firstNotNull((0,c.DQ)(o,g),f.get("color"),"#fff"),v=s.A.firstNotNull((0,c.fz)(o,g),f.get("opacity"),1),_=n.A.parseColor(m),y=n.A.parseColor(f.get("borderColor"));_[3]*=v,y[3]*=v;var x=_[3]<.99;d.material.set("color",[1,1,1,1]),h=h||x;for(var w=s.A.firstNotNull(p.get("height",!0),e.get("regionHeight")),A=this._updatePolygonGeometry(e,d.geometry,g,w,a,l,_),S=a;S<A.vertexOffset;S++)this._dataIndexOfVertex[S]=g;this._vertexRangeOfDataIndex[2*(g-i)]=a,this._vertexRangeOfDataIndex[2*(g-i)+1]=A.vertexOffset,a=A.vertexOffset,l=A.triangleOffset;var b=f.get("borderWidth"),M=b>0;M&&(b*=t.getDevicePixelRatio(),this._updateLinesGeometry(u.geometry,e,g,w,b,e.coordinateSystem.transform)),u.invisible=!M,u.material.set({color:y})}d=this._polygonMesh;d.material.transparent=h,d.material.depthMask=!h,d.geometry.updateBoundingBox(),d.frontFace=this.extrudeY?n.A.Mesh.CCW:n.A.Mesh.CW,d.material.get("normalMap")&&d.geometry.generateTangents(),d.seriesIndex=e.seriesIndex,d.on("mousemove",this._onmousemove,this),d.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var i=n.A.parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),r=s.A.firstNotNull(t.get("lineStyle.width"),1),o=this._polygonMesh;o.geometry.generateBarycentric(),o.material.define("both","WIREFRAME_TRIANGLE"),o.material.set("wireframeLineColor",i),o.material.set("wireframeLineWidth",r)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];null==t&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,i){var r=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!r.get("show",!0),!this._groundMesh.invisible){var o=e.get("shading"),a=this._groundMaterials[o];a||(a=this._groundMaterials.lambert),n.A.setMaterialFromModel(o,a,r,i),a.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=a,this._groundMesh.material.set("color",n.A.parseColor(r.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,i){this._triangulationResults=[];for(var r=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0],a=e.coordinateSystem,s=t;s<i;s++){for(var l=[],h=e.getRegionPolygonCoords(s),d=0;d<h.length;d++){var u=h[d].exterior,c=h[d].interiors,p=[],f=[];if(!(u.length<3)){for(var m=0,v=0;v<u.length;v++){var _=u[v];p[m++]=_[0],p[m++]=_[1]}for(v=0;v<c.length;v++)if(!(c[v].length<3)){for(var y=p.length/2,x=0;x<c[v].length;x++){_=c[v][x];p.push(_[0]),p.push(_[1])}f.push(y)}var w=(0,o.A)(p,f),A=new Float64Array(p.length/2*3),S=[],b=[1/0,1/0,1/0],M=[-1/0,-1/0,-1/0],D=0;for(v=0;v<p.length;)g.set(S,p[v++],0,p[v++]),a&&a.transform&&g.transformMat4(S,S,a.transform),g.min(b,b,S),g.max(M,M,S),A[D++]=S[0],A[D++]=S[1],A[D++]=S[2];g.min(r,r,b),g.max(n,n,M),l.push({points:A,indices:w,min:b,max:M})}}this._triangulationResults.push(l)}this._geoBoundingBox=[r,n]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],i=0,r=0,n=0;n<t.length;n++)i+=t[n].points.length/3,r+=t[n].indices.length/3;var o=2*i+4*i,a=2*r+2*i;return{vertexCount:o,triangleCount:a}},_updatePolygonGeometry:function(e,t,i,r,n,o,a){var s=e.get("projectUVOnGround"),l=t.attributes.position,h=t.attributes.normal,d=t.attributes.texcoord0,u=t.attributes.color,c=this._triangulationResults[i-this._startIndex],p=u.value&&a,f=t.indices,m=this.extrudeY?1:2,v=this.extrudeY?2:1,_=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],y=g.mul([],this._geoBoundingBox[0],_),x=g.mul([],this._geoBoundingBox[1],_),w=Math.max(x[0]-y[0],x[2]-y[2]);function A(e,t,i){for(var r=e.points,o=r.length,s=[],h=[],c=0;c<o;c+=3)s[0]=r[c],s[m]=t,s[v]=r[c+2],h[0]=(r[c]*_[0]-y[0])/w,h[1]=(r[c+2]*_[v]-y[2])/w,l.set(n,s),p&&u.set(n,a),d.set(n++,h)}function S(e,t,i){var r=n;A(e,t,i);for(var a=e.indices.length,s=0;s<a;s++)f[3*o+s]=e.indices[s]+r;o+=e.indices.length/3}for(var b=this.extrudeY?[0,1,0]:[0,0,1],M=g.negate([],b),D=0;D<c.length;D++){var T=n,L=c[D];S(L,0,0),S(L,r,0);for(var C=L.points.length/3,P=0;P<C;P++)h.set(T+P,M),h.set(T+P+C,b);var E=[0,3,1,1,3,2],I=[[],[],[],[]],O=[],N=[],G=[],R=[],z=0;for(P=0;P<C;P++){for(var B=(P+1)%C,F=(L.points[3*B]-L.points[3*P])*_[0],k=(L.points[3*B+2]-L.points[3*P+2])*_[v],V=Math.sqrt(F*F+k*k),H=0;H<4;H++){var W=0===H||3===H,U=3*(W?P:B);I[H][0]=L.points[U],I[H][m]=H>1?r:0,I[H][v]=L.points[U+2],l.set(n+H,I[H]),s?(R[0]=(L.points[U]*_[0]-y[0])/w,R[1]=(L.points[U+2]*_[v]-y[v])/w):(R[0]=(W?z:z+V)/w,R[1]=(I[H][m]*_[m]-y[m])/w),d.set(n+H,R)}g.sub(O,I[1],I[0]),g.sub(N,I[3],I[0]),g.cross(G,O,N),g.normalize(G,G);for(H=0;H<4;H++)h.set(n+H,G),p&&u.set(n+H,a);for(H=0;H<6;H++)f[3*o+H]=E[H]+n;n+=4,o+=2,z+=V}}return t.dirty(),{vertexOffset:n,triangleOffset:o}},_getRegionLinesInfo:function(e,t,i){var r=0,n=0,o=t.getRegionModel(e),a=o.getModel("itemStyle"),s=a.get("borderWidth");if(s>0){var l=t.getRegionPolygonCoords(e);l.forEach((function(e){var t=e.exterior,o=e.interiors;r+=i.getPolylineVertexCount(t),n+=i.getPolylineTriangleCount(t);for(var a=0;a<o.length;a++)r+=i.getPolylineVertexCount(o[a]),n+=i.getPolylineTriangleCount(o[a])}),this)}return{vertexCount:r,triangleCount:n}},_updateLinesGeometry:function(e,t,i,r,n,o){function a(e){for(var t=new Float64Array(3*e.length),i=0,n=[],a=0;a<e.length;a++)n[0]=e[a][0],n[1]=r+.1,n[2]=e[a][1],o&&g.transformMat4(n,n,o),t[i++]=n[0],t[i++]=n[1],t[i++]=n[2];return t}var s=[1,1,1,1],l=t.getRegionPolygonCoords(i);l.forEach((function(t){var i=t.exterior,r=t.interiors;e.addPolyline(a(i),s,n);for(var o=0;o<r.length;o++)e.addPolyline(a(r[o]),s,n)}))},highlight:function(e){var t=this._data;if(t){var i=t.getItemModel(e),o=i.getModel(["emphasis","itemStyle"]),a=o.get("color"),l=s.A.firstNotNull(o.get("opacity"),(0,c.fz)(t,e),1);if(null==a){var h=(0,c.DQ)(t,e);a=r.yW.lift(h,-.4)}null==l&&(l=(0,c.fz)(t,e));var d=n.A.parseColor(a);d[3]*=l,this._setColorOfDataIndex(t,e,d)}},downplay:function(e){var t=this._data;if(t){var i=t.getItemModel(e),r=s.A.firstNotNull((0,c.DQ)(t,e),i.get(["itemStyle","color"]),"#fff"),o=s.A.firstNotNull((0,c.fz)(t,e),i.get(["itemStyle","opacity"]),1),a=n.A.parseColor(r);a[3]*=o,this._setColorOfDataIndex(t,e,a)}},dispose:function(){this._labelsBuilder.dispose()},_setColorOfDataIndex:function(e,t,i){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var r=this._vertexRangeOfDataIndex[2*t];r<this._vertexRangeOfDataIndex[2*t+1];r++)this._polygonMesh.geometry.attributes.color.set(r,i);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}},t.A=p},4678:function(e,t,i){"use strict";i(16573),i(78100),i(77936),i(37467),i(44732),i(79577);var r=i(85811),n=i(70756),o=i(14529),a=i(69665),s=i(46685),l=i(53269),h=1,d=2;function u(e,t,i){this._labelsMesh=new o.A,this._labelTextureSurface=new n.A({width:512,height:512,devicePixelRatio:i.getDevicePixelRatio(),onupdate:function(){i.getZr().refresh()}}),this._api=i,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}u.prototype.getLabelPosition=function(e,t,i){return[0,0,0]},u.prototype.getLabelDistance=function(e,t,i){return 0},u.prototype.getMesh=function(){return this._labelsMesh},u.prototype.updateData=function(e,t,i){null==t&&(t=0),null==i&&(i=e.count()),this._labelsVisibilitiesBits&&this._labelsVisibilitiesBits.length===i-t||(this._labelsVisibilitiesBits=new Uint8Array(i-t));for(var r=["label","show"],n=["emphasis","label","show"],o=t;o<i;o++){var a=e.getItemModel(o),s=a.get(r),l=a.get(n);null==l&&(l=s);var u=(s?h:0)|(l?d:0);this._labelsVisibilitiesBits[o-t]=u}this._start=t,this._end=i,this._data=e},u.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,i={},n=0;n<e.length;n++)i[e[n]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var o=["label"],u=["emphasis","label"],c=this._data.hostModel,g=this._data,p=c.getModel(o),f=c.getModel(u,p),m={left:"right",right:"left",top:"center",bottom:"center"},v={left:"middle",right:"middle",top:"bottom",bottom:"top"},_=this._start;_<this._end;_++){var y=!1;t&&i[_]&&(y=!0);var x=this._labelsVisibilitiesBits[_-this._start]&(y?d:h);if(x){var w=g.getItemModel(_),A=w.getModel(y?u:o,y?f:p),S=A.get("distance")||0,b=A.get("position"),M=this._api.getDevicePixelRatio(),D=c.getFormattedLabel(_,y?"emphasis":"normal");if(null==D||""===D)return;var T=new r.fA.EY({style:(0,l.VB)(A,{text:D,fill:A.get("color")||(0,s.DQ)(g,_)||"#000",align:"left",verticalAlign:"top",opacity:a.A.firstNotNull(A.get("opacity"),(0,s.fz)(g,_),1)})}),L=T.getBoundingRect(),C=1.2;L.height*=C;var P=this._labelTextureSurface.add(T),E=m[b]||"center",I=v[b]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(_,b,S),[L.width*M,L.height*M],P,E,I,this.getLabelDistance(_,b,S)*M)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}},u.prototype.dispose=function(){this._labelTextureSurface.dispose()},t.A=u},99628:function(e,t,i){"use strict";var r=i(9489),n=i(36544),o=i(85811);function a(){}a.prototype={constructor:a,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new r.A.DirectionalLight({shadowBias:.005}),this.ambientLight=new r.A.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,i=this.ambientLight,n=e.getModel("light"),o=n.getModel("main"),a=n.getModel("ambient");t.intensity=o.get("intensity"),i.intensity=a.get("intensity"),t.color=r.A.parseColor(o.get("color")).slice(0,3),i.color=r.A.parseColor(a.get("color")).slice(0,3);var s=o.get("alpha")||0,l=o.get("beta")||0;t.position.setArray(r.A.directionFromAlphaBeta(s,l)),t.lookAt(r.A.Vector3.ZERO),t.castShadow=o.get("shadow"),t.shadowResolution=r.A.getShadowResolution(o.get("shadowQuality"))},updateAmbientCubemap:function(e,t,i){var n=t.getModel("light.ambientCubemap"),o=n.get("texture");if(o){this._cubemapLightsCache=this._cubemapLightsCache||{};var a=this._cubemapLightsCache[o];if(!a){var s=this;a=this._cubemapLightsCache[o]=r.A.createAmbientCubemap(n.option,e,i,(function(){s._isSkyboxFromAmbientCubemap&&s._skybox.setEnvironmentMap(a.specular.cubemap),i.getZr().refresh()}))}this._lightRoot.add(a.diffuse),this._lightRoot.add(a.specular),this._currentCubemapLights=a}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,i){var a=t.get("environment"),s=this;function l(){return s._skybox=s._skybox||new n.A,s._skybox}var h=l();if(a&&"none"!==a)if("auto"===a)if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var d=this._currentCubemapLights.specular.cubemap;h.setEnvironmentMap(d),this._scene&&h.attachScene(this._scene),h.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if("object"===typeof a&&a.colorStops||"string"===typeof a&&o.yW.parse(a)){this._isSkyboxFromAmbientCubemap=!1;var u=new r.A.Texture2D({anisotropic:8,flipY:!1});h.setEnvironmentMap(u);var c=u.image=document.createElement("canvas");c.width=c.height=16;var g=c.getContext("2d"),p=new o.fA.rw({shape:{x:0,y:0,width:16,height:16},style:{fill:a}});o.UU(g,p),h.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;u=r.A.loadTexture(a,i,{anisotropic:8,flipY:!1});h.setEnvironmentMap(u),h.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var f=t.coordinateSystem;if(this._skybox)if(!f||!f.viewGL||"auto"===a||a.match&&a.match(/.hdr$/))this._skybox.material.undefine("fragment","SRGB_DECODE");else{var m=f.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[m]("fragment","SRGB_DECODE")}}},t.A=a},76238:function(e,t){"use strict";t.A={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}}},75971:function(e,t){"use strict";t.A={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}}},59176:function(e,t){"use strict";t.A={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}}},43376:function(e,t){"use strict";t.A={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},null!=e.alpha&&(this.option.viewControl.alpha=e.alpha),null!=e.beta&&(this.option.viewControl.beta=e.beta),null!=e.distance&&(this.option.viewControl.distance=e.distance),null!=e.center&&(this.option.viewControl.center=e.center)}}},16882:function(e,t,i){"use strict";var r=i(85811),n=i(83931);(0,r.Yx)(n.a)},83931:function(e,t,i){"use strict";i.d(t,{a:function(){return v}});i(48622);var r=i(85811),n=i(43376),o=i(75971),a=i(76238),s=i(59176),l=i(97483),h=r.jT.extend({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=r.dw.createDimensions(e.data||[],{coordDimensions:["value"],encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),i=new r.B8(t,this);i.initData(e.regions);var n={};i.each((function(e){var t=i.getName(e),r=i.getItemModel(e);n[t]=r})),this._regionModelMap=n,this._data=i},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new r.Kx(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),i=this.coordinateSystem.getRegion(t);return i?i.geometries:[]},getFormattedLabel:function(e,t){var i=this._data.getName(e),r=this.getRegionModel(e),n=r.get("normal"===t?["label","formatter"]:["emphasis","label","formatter"]);null==n&&(n=r.get(["label","formatter"]));var o={name:i};if("function"===typeof n)return o.status=t,n(o);if("string"===typeof n){var a=o.seriesName;return n.replace("{a}",null!=a?a:"")}return i},defaultOption:{regions:[]}});r.ZS.merge(h.prototype,l.A),r.ZS.merge(h.prototype,n.A),r.ZS.merge(h.prototype,o.A),r.ZS.merge(h.prototype,a.A),r.ZS.merge(h.prototype,s.A);var d=h,u=i(45711),c=i(9489),g=i(76800),p=i(99628),f=r.bR.extend({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new u.A(t),this.groupGL=new c.A.Node,this._lightRoot=new c.A.Node,this._sceneHelper=new p.A(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new g.A({zr:t.getZr()}),this._control.init()},render:function(e,t,i){this.groupGL.add(this._geo3DBuilder.rootNode);var r=e.coordinateSystem;if(r&&r.viewGL){r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var o=e.getModel("viewControl");n.setFromViewControlModel(o,0),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,i,0,e.getData().count());var a=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse((function(e){e.material&&e.material[a]("fragment","SRGB_DECODE")})),n.off("update"),n.on("update",(function(){i.dispatchAction({type:"geo3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),center:n.getCenter(),from:this.uid,geo3DId:e.id})})),n.update()}},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},dispose:function(){this._control.dispose(),this._geo3DBuilder.dispose()}}),m=i(99961);function v(e){e.registerComponentModel(d),e.registerComponentView(f),e.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"geo3D",query:e},(function(t){t.setView(e)}))})),e.registerCoordinateSystem("geo3D",m.A)}},55720:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(44114),i(43376)),o=i(75971),a=i(76238),s=i(59176);function l(e,t){e.id=e.id||e.name||t+""}var h=r.jT.extend({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){h.superApply(this,"init",arguments),r.ZS.each(this.option.layers,(function(e,t){r.ZS.merge(e,this.defaultLayerOption),l(e,t)}),this)},mergeOption:function(e){var t=this.option.layers;function i(e){return r.ZS.reduce(e,(function(e,t,i){return l(t,i),e[t.id]=t,e}),{})}if(this.option.layers=null,h.superApply(this,"mergeOption",arguments),t&&t.length){var n=i(e.layers),o=i(t);for(var a in n)o[a]?r.ZS.merge(o[a],n[a],!0):t.push(e.layers[a]);this.option.layers=t}r.ZS.each(this.option.layers,(function(e){r.ZS.merge(e,this.defaultLayerOption)}),this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},atmosphere:{show:!1,offset:5,color:"#ffffff",glowPower:6,innerGlowPower:2},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return e&&"none"!==e||(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});r.ZS.merge(h.prototype,n.A),r.ZS.merge(h.prototype,o.A),r.ZS.merge(h.prototype,a.A),r.ZS.merge(h.prototype,s.A);var d=h,u=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(9489)),c=i(76800),g=i(99628),p=i(42886),f=i(69665),m=i(47595),v="@export ecgl.atmosphere.vertex\nattribute vec3 position: POSITION;\nattribute vec3 normal : NORMAL;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 normalMatrix : WORLDINVERSETRANSPOSE;\n\nvarying vec3 v_Normal;\n\nvoid main() {\n v_Normal = normalize((normalMatrix * vec4(normal, 0.0)).xyz);\n gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n@end\n\n\n@export ecgl.atmosphere.fragment\nuniform mat4 viewTranspose: VIEWTRANSPOSE;\nuniform float glowPower;\nuniform vec3 glowColor;\n\nvarying vec3 v_Normal;\n\nvoid main() {\n float intensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);\n gl_FragColor = vec4(glowColor, intensity * intensity);\n}\n@end";u.A.Shader["import"](m.A),u.A.Shader["import"](v);var _=r.bR.extend({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new u.A.Node,this._sphereGeometry=new u.A.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new u.A.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new u.A.PlaneGeometry,this._earthMesh=new u.A.Mesh({renderNormal:!0}),this._atmosphereMesh=new u.A.Mesh,this._atmosphereGeometry=new u.A.SphereGeometry({widthSegments:80,heightSegments:40}),this._atmosphereMaterial=new u.A.Material({shader:new u.A.Shader(u.A.Shader.source("ecgl.atmosphere.vertex"),u.A.Shader.source("ecgl.atmosphere.fragment")),transparent:!0}),this._atmosphereMesh.geometry=this._atmosphereGeometry,this._atmosphereMesh.material=this._atmosphereMaterial,this._atmosphereMesh.frontFace=u.A.Mesh.CW,this._lightRoot=new u.A.Node,this._sceneHelper=new g.A,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._atmosphereMesh),this.groupGL.add(this._earthMesh),this._control=new c.A({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,i){var r=e.coordinateSystem,n=e.get("shading");r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL),this._sceneHelper.setScene(r.viewGL.scene),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var o=this._earthMesh;o.geometry=this._sphereGeometry;var a="ecgl."+n;o.material&&o.material.shader.name===a||(o.material=u.A.createMaterial(a)),u.A.setMaterialFromModel(n,o.material,e,i),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach((function(e){var t=o.material.get(e);t&&(t.flipY=!1)})),o.material.set("color",u.A.parseColor(e.get("baseColor")));var s=.99*r.radius;if(o.scale.set(s,s,s),e.get("atmosphere.show")){o.material.define("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!1,this._atmosphereMaterial.setUniforms({glowPower:e.get("atmosphere.glowPower")||6,glowColor:e.get("atmosphere.color")||"#ffffff"}),o.material.setUniforms({glowPower:e.get("atmosphere.innerGlowPower")||2,glowColor:e.get("atmosphere.color")||"#ffffff"});var l=e.get("atmosphere.offset")||5;this._atmosphereMesh.scale.set(s+l,s+l,s+l)}else o.material.undefine("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!0;var h=o.material.setTextureImage("diffuseMap",e.get("baseTexture"),i,{flipY:!1,anisotropic:8});h&&h.surface&&h.surface.attachToMesh(o);var d=o.material.setTextureImage("bumpMap",e.get("heightTexture"),i,{flipY:!1,anisotropic:8});d&&d.surface&&d.surface.attachToMesh(o),o.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,i),this._displaceVertices(e,i),this._updateViewControl(e,i),this._updateLayers(e,i)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},_updateLayers:function(e,t){var i=e.coordinateSystem,n=e.get("layers"),o=i.radius,a=[],s=[],l=[],h=[];r.ZS.each(n,(function(e){var n=new r.Kx(e),d=n.get("type"),c=u.A.loadTexture(n.get("texture"),t,{flipY:!1,anisotropic:8});if(c.surface&&c.surface.attachToMesh(this._earthMesh),"blend"===d){var g=n.get("blendTo"),p=f.A.firstNotNull(n.get("intensity"),1);"emission"===g?(l.push(c),h.push(p)):(a.push(c),s.push(p))}else{var m=n.get("id"),v=this._layerMeshes[m];v||(v=this._layerMeshes[m]=new u.A.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var _=n.get("shading");"lambert"===_?(v.material=v.__lambertMaterial||new u.A.Material({autoUpdateTextureStatus:!1,shader:u.A.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),v.__lambertMaterial=v.material):(v.material=v.__colorMaterial||new u.A.Material({autoUpdateTextureStatus:!1,shader:u.A.createShader("ecgl.color"),transparent:!0,depthMask:!1}),v.__colorMaterial=v.material),v.material.enableTexture("diffuseMap");var y=n.get("distance"),x=o+(null==y?i.radius/100:y);v.scale.set(x,x,x),o=x;var w=this._blankTexture||(this._blankTexture=u.A.createBlankTexture("rgba(255, 255, 255, 0)"));v.material.set("diffuseMap",w),u.A.loadTexture(n.get("texture"),t,{flipY:!1,anisotropic:8},(function(e){e.surface&&e.surface.attachToMesh(v),v.material.set("diffuseMap",e),t.getZr().refresh()})),n.get("show")?this.groupGL.add(v):this.groupGL.remove(v)}}),this);var d=this._earthMesh.material;d.define("fragment","LAYER_DIFFUSEMAP_COUNT",a.length),d.define("fragment","LAYER_EMISSIVEMAP_COUNT",l.length),d.set("layerDiffuseMap",a),d.set("layerDiffuseIntensity",s),d.set("layerEmissiveMap",l),d.set("layerEmissionIntensity",h);var c=e.getModel("debug.wireframe");if(c.get("show")){d.define("both","WIREFRAME_TRIANGLE");var g=u.A.parseColor(c.get("lineStyle.color")||"rgba(0,0,0,0.5)"),p=f.A.firstNotNull(c.get("lineStyle.width"),1);d.set("wireframeLineWidth",p),d.set("wireframeLineColor",g)}else d.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var i=e.coordinateSystem,r=e.getModel("viewControl"),n=(i.viewGL.camera,this);function o(){return{type:"globeChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance()-i.radius,center:a.getCenter(),from:n.uid,globeId:e.id}}var a=this._control;a.setViewGL(i.viewGL);var s,l,h=r.get("targetCoord");null!=h&&(l=h[0]+90,s=h[1]),a.setFromViewControlModel(r,{baseDistance:i.radius,alpha:s,beta:l}),a.off("update"),a.on("update",(function(){t.dispatchAction(o())}))},_displaceVertices:function(e,t){var i=e.get("displacementQuality"),r=e.get("debug.wireframe.show"),n=e.coordinateSystem;if(e.isDisplacementChanged()||i!==this._displacementQuality||r!==this._showDebugWireframe){this._displacementQuality=i,this._showDebugWireframe=r;var o=this._sphereGeometry,a={low:100,medium:200,high:400,ultra:800}[i]||200,s=a/2;(o.widthSegments!==a||r)&&(o.widthSegments=a,o.heightSegments=s,o.build()),this._doDisplaceVertices(o,n),r&&o.generateBarycentric()}},_doDisplaceVertices:function(e,t){var i=e.attributes.position.value,r=e.attributes.texcoord0.value,n=e.__originalPosition;n&&n.length===i.length||(n=new Float32Array(i.length),n.set(i),e.__originalPosition=n);for(var o=t.displacementWidth,a=t.displacementHeight,s=t.displacementData,l=0;l<e.vertexCount;l++){var h=3*l,d=2*l,u=n[h+1],c=n[h+2],g=n[h+3],p=r[d++],f=r[d++],m=Math.round(p*(o-1)),v=Math.round(f*(a-1)),_=v*o+m,y=s?s[_]:0;i[h+1]=u+u*y,i[h+2]=c+c*y,i[h+3]=g+g*y}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var i=this._earthMesh;this._sceneHelper.updateLight(e);var n=this._sceneHelper.mainLight,o=e.get("light.main.time")||new Date,a=p.A.getPosition(r.ai.parseDate(o),0,0),s=Math.cos(a.altitude);n.position.y=-s*Math.cos(a.azimuth),n.position.x=Math.sin(a.altitude),n.position.z=s*Math.sin(a.azimuth),n.lookAt(i.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}}),y=i(73737),x=y.A.vec3;function w(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}w.prototype={constructor:w,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,i){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=i},_getDisplacementScale:function(e,t){var i=(e+180)/360*(this.displacementWidth-1),r=(90-t)/180*(this.displacementHeight-1),n=Math.round(i)+Math.round(r)*this.displacementWidth;return this.displacementData[n]},dataToPoint:function(e,t){var i=e[0],r=e[1],n=e[2]||0,o=this.radius;this.displacementData&&(o*=1+this._getDisplacementScale(i,r)),this.altitudeAxis&&(o+=this.altitudeAxis.dataToCoord(n)),i=i*Math.PI/180,r=r*Math.PI/180;var a=Math.cos(r)*o;return t=t||[],t[0]=-a*Math.cos(i+Math.PI),t[1]=Math.sin(r)*o,t[2]=a*Math.sin(i+Math.PI),t},pointToData:function(e,t){var i=e[0],r=e[1],n=e[2],o=x.len(e);i/=o,r/=o,n/=o;var a=Math.asin(r),s=Math.atan2(n,-i);s<0&&(s=2*Math.PI+s);var l=180*a/Math.PI,h=180*s/Math.PI-180;return t=t||[],t[0]=h,t[1]=l,t[2]=o-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}};var A=w,S=i(93398),b=i(63858);function M(e,t){var i=document.createElement("canvas"),r=i.getContext("2d"),n=e.width,o=e.height;i.width=n,i.height=o,r.drawImage(e,0,0,n,o);for(var a=r.getImageData(0,0,n,o).data,s=new Float32Array(a.length/4),l=0;l<a.length/4;l++){var h=a[4*l];s[l]=h/255*t}return{data:s,width:n,height:o}}function D(e,t){var i=e.getBoxLayoutParams(),r=(0,S.dV)(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var n=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,n-this.radius)}function T(e,t){var i=[1/0,-1/0];if(e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData(),r=e.coordDimToDataDim("alt"),n=r&&r[0];if(n){var o=t.getDataExtent(n,!0);i[0]=Math.min(i[0],o[0]),i[1]=Math.max(i[1],o[1])}}}),this),i&&isFinite(i[1]-i[0])){var n=r.dw.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new r._0("altitude",n),this.resize(this.model,t)}}var L={dimensions:A.prototype.dimensions,create:function(e,t){var i=[];return e.eachComponent("globe",(function(e){e.__viewGL=e.__viewGL||new b.A;var r=new A;r.viewGL=e.__viewGL,e.coordinateSystem=r,r.model=e,i.push(r),r.resize=D,r.resize(e,t),r.update=T})),e.eachSeries((function(t){if("globe"===t.get("coordinateSystem")){var i=t.getReferringComponents("globe").models[0];if(i||(i=e.getComponent("globe")),!i)throw new Error('globe "'+f.A.firstNotNull(t.get("globe3DIndex"),t.get("globe3DId"),0)+'" not found');var r=i.coordinateSystem;t.coordinateSystem=r}})),e.eachComponent("globe",(function(e,i){var r=e.coordinateSystem,n=e.getDisplacementTexture(),o=e.getDisplacemenScale();if(e.isDisplacementChanged()){if(e.hasDisplacement()){var a=!0;u.A.loadTexture(n,t,(function(i){var r=i.image,n=M(r,o);e.setDisplacementData(n.data,n.width,n.height),a||t.dispatchAction({type:"globeUpdateDisplacment"})})),a=!1}else r.setDisplacementData(null,0,0);r.setDisplacementData(e.displacementData,e.displacementWidth,e.displacementHeight)}})),i}},C=L;function P(e){e.registerComponentModel(d),e.registerComponentView(_),e.registerCoordinateSystem("globe",C),e.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"globe",query:e},(function(t){t.setView(e)}))})),e.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},(function(e,t){}))}(0,r.Yx)(P)},64837:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(43376)),o=i(75971),a=i(76238),s=r.jT.extend({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});r.ZS.merge(s.prototype,n.A),r.ZS.merge(s.prototype,o.A),r.ZS.merge(s.prototype,a.A);var l=s,h=i(53269),d=i(9489),u=i(76800),c=i(97758),g=i(69665),p=i(70756),f=i(99628),m=i(81986),v=g.A.firstNotNull,_={x:0,y:2,z:1};function y(e,t,i,r){var n=[0,0,0],o=r<0?i.getExtentMin():i.getExtentMax();n[_[i.dim]]=o,e.position.setArray(n),e.rotation.identity(),t.distance=-Math.abs(o),t.normal.set(0,0,0),"x"===i.dim?(e.rotation.rotateY(r*Math.PI/2),t.normal.x=-r):"z"===i.dim?(e.rotation.rotateX(-r*Math.PI/2),t.normal.y=-r):(r>0&&e.rotation.rotateY(Math.PI),t.normal.z=-r)}function x(e,t,i){this.rootNode=new d.A.Node;var r=new d.A.Mesh({geometry:new c.A({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),n=new d.A.Mesh({geometry:new m.A,material:i,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(n),this.rootNode.add(r),this.faceInfo=e,this.plane=new d.A.Plane,this.linesMesh=r,this.quadsMesh=n}x.prototype.update=function(e,t,i){var r=e.coordinateSystem,n=[r.getAxis(this.faceInfo[0]),r.getAxis(this.faceInfo[1])],o=this.linesMesh.geometry,a=this.quadsMesh.geometry;o.convertToDynamicArray(!0),a.convertToDynamicArray(!0),this._updateSplitLines(o,n,e,i),this._udpateSplitAreas(a,n,e,i),o.convertToTypedArray(),a.convertToTypedArray();var s=r.getAxis(this.faceInfo[2]);y(this.rootNode,this.plane,s,this.faceInfo[3])},x.prototype._updateSplitLines=function(e,t,i,n){var o=n.getDevicePixelRatio();t.forEach((function(n,a){var s=n.model,l=t[1-a].getExtent();if(!n.scale.isBlank()){var h=s.getModel("splitLine",i.getModel("splitLine"));if(h.get("show")){var u=h.getModel("lineStyle"),c=u.get("color"),g=v(u.get("opacity"),1),p=v(u.get("width"),1);c=r.ZS.isArray(c)?c:[c];for(var f=n.getTicksCoords({tickModel:h}),m=0,_=0;_<f.length;_++){var y=f[_].coord,x=d.A.parseColor(c[m%c.length]);x[3]*=g;var w=[0,0,0],A=[0,0,0];w[a]=A[a]=y,w[1-a]=l[0],A[1-a]=l[1],e.addLine(w,A,x,p*o),m++}}}}))},x.prototype._udpateSplitAreas=function(e,t,i,n){t.forEach((function(n,o){var a=n.model,s=t[1-o].getExtent();if(!n.scale.isBlank()){var l=a.getModel("splitArea",i.getModel("splitArea"));if(l.get("show")){var h=l.getModel("areaStyle"),u=h.get("color"),c=v(h.get("opacity"),1);u=r.ZS.isArray(u)?u:[u];for(var g=n.getTicksCoords({tickModel:l,clamp:!0}),p=0,f=[0,0,0],m=[0,0,0],_=0;_<g.length;_++){var y=g[_].coord,x=[0,0,0],w=[0,0,0];if(x[o]=w[o]=y,x[1-o]=s[0],w[1-o]=s[1],0!==_){var A=d.A.parseColor(u[p%u.length]);A[3]*=c,e.addQuad([f,x,w,m],A),f=x,m=w,p++}else f=x,m=w}}}}))};var w=x,A=(i(44114),i(14529)),S=g.A.firstNotNull,b={x:0,y:2,z:1};function M(e,t){var i=new d.A.Mesh({geometry:new c.A({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),r=new A.A;r.material.depthMask=!1;var n=new d.A.Node;n.add(i),n.add(r),this.rootNode=n,this.dim=e,this.linesMesh=i,this.labelsMesh=r,this.axisLineCoords=null,this.labelElements=[]}var D={x:"y",y:"x",z:"y"};M.prototype.update=function(e,t,i){var n=e.coordinateSystem,o=n.getAxis(this.dim),a=this.linesMesh.geometry,s=this.labelsMesh.geometry;a.convertToDynamicArray(!0),s.convertToDynamicArray(!0);var l=o.model,u=o.getExtent(),c=i.getDevicePixelRatio(),g=l.getModel("axisLine",e.getModel("axisLine")),p=l.getModel("axisTick",e.getModel("axisTick")),f=l.getModel("axisLabel",e.getModel("axisLabel")),m=g.get("lineStyle.color");if(g.get("show")){var v=g.getModel("lineStyle"),_=[0,0,0],y=[0,0,0],x=b[o.dim];_[x]=u[0],y[x]=u[1],this.axisLineCoords=[_,y];var w=d.A.parseColor(m),A=S(v.get("width"),1),M=S(v.get("opacity"),1);w[3]*=M,a.addLine(_,y,w,A*c)}if(p.get("show")){var T=p.getModel("lineStyle"),L=d.A.parseColor(S(T.get("color"),m));A=S(T.get("width"),1);L[3]*=S(T.get("opacity"),1);for(var C=o.getTicksCoords(),P=p.get("length"),E=0;E<C.length;E++){var I=C[E].coord,O=(_=[0,0,0],y=[0,0,0],x=b[o.dim],b[D[o.dim]]);_[x]=y[x]=I,y[O]=P,a.addLine(_,y,L,A*c)}}this.labelElements=[];c=i.getDevicePixelRatio();if(f.get("show")){C=o.getTicksCoords();var N=l.get("data"),G=f.get("margin"),R=o.getViewLabels();for(E=0;E<R.length;E++){var z=R[E].tickValue,B=R[E].formattedLabel,F=R[E].rawLabel,k=(I=o.dataToCoord(z),[0,0,0]);x=b[o.dim],O=b[D[o.dim]];k[x]=k[x]=I,k[O]=G;var V=f;N&&N[z]&&N[z].textStyle&&(V=new r.Kx(N[z].textStyle,f,l.ecModel));var H=S(V.get("color"),m),W=new r.fA.EY({style:(0,h.VB)(V,{text:B,fill:"function"===typeof H?H("category"===o.type?F:"value"===o.type?z+"":z,E):H,verticalAlign:"top",align:"left"})}),U=t.add(W),Z=W.getBoundingRect();s.addSprite(k,[Z.width*c,Z.height*c],U),this.labelElements.push(W)}}if(l.get("name")){var $=l.getModel("nameTextStyle"),j=(k=[0,0,0],x=b[o.dim],O=b[D[o.dim]],S($.get("color"),m)),Y=$.get("borderColor");A=$.get("borderWidth");k[x]=k[x]=(u[0]+u[1])/2,k[O]=l.get("nameGap");W=new r.fA.EY({style:(0,h.VB)($,{text:l.get("name"),fill:j,stroke:Y,lineWidth:A})}),U=t.add(W),Z=W.getBoundingRect();s.addSprite(k,[Z.width*c,Z.height*c],U),W.__idx=this.labelElements.length,this.nameLabelElement=W}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),a.convertToTypedArray(),s.convertToTypedArray()},M.prototype.setSpriteAlign=function(e,t,i){for(var r=i.getDevicePixelRatio(),n=this.labelsMesh.geometry,o=0;o<this.labelElements.length;o++){var a=this.labelElements[o],s=a.getBoundingRect();n.setSpriteAlign(o,[s.width*r,s.height*r],e,t)}var l=this.nameLabelElement;if(l){s=l.getBoundingRect();n.setSpriteAlign(l.__idx,[s.width*r,s.height*r],e,t),n.dirty()}this.textAlign=e,this.textVerticalAlign=t};var T=M,L=i(74133),C=g.A.firstNotNull;d.A.Shader.import(L.A);var P={x:0,y:2,z:1},E=r.bR.extend({type:"grid3D",__ecgl__:!0,init:function(e,t){var i=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],r=["x","y","z"],n=new d.A.Material({shader:d.A.createShader("ecgl.color"),depthMask:!1,transparent:!0}),o=new d.A.Material({shader:d.A.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});n.define("fragment","DOUBLE_SIDED"),n.define("both","VERTEX_COLOR"),this.groupGL=new d.A.Node,this._control=new u.A({zr:t.getZr()}),this._control.init(),this._faces=i.map((function(e){var t=new w(e,o,n);return this.groupGL.add(t.rootNode),t}),this),this._axes=r.map((function(e){var t=new T(e,o);return this.groupGL.add(t.rootNode),t}),this);var a=t.getDevicePixelRatio();this._axisLabelSurface=new p.A({width:256,height:256,devicePixelRatio:a}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new d.A.Mesh({geometry:new c.A({useNativeLine:!1}),material:o,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new p.A({width:128,height:128,devicePixelRatio:a}),this._axisPointerLabelsMesh=new A.A({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new d.A.Node,this._sceneHelper=new f.A,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,i){this._model=e,this._api=i;var r=e.coordinateSystem;r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var n=this._control;n.setViewGL(r.viewGL);var o=e.getModel("viewControl");n.setFromViewControlModel(o,0),this._axisLabelSurface.clear(),n.off("update"),e.get("show")&&(this._faces.forEach((function(r){r.update(e,t,i)}),this),this._axes.forEach((function(t){t.update(e,this._axisLabelSurface,i)}),this)),n.on("update",this._onCameraChange.bind(this,e,i),this),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),i),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i)},showAxisPointer:function(e,t,i,r){this._doShowAxisPointer(),this._updateAxisPointer(r.value)},hideAxisPointer:function(e,t,i,r){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,i=t.viewGL;e.get("show")&&e.get("axisPointer.show")?i.on("mousemove",this._updateAxisPointerOnMousePosition,this):i.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t,i=this._model,r=i.coordinateSystem,n=r.viewGL,o=n.castRay(e.offsetX,e.offsetY,new d.A.Ray),a=0;a<this._faces.length;a++){var s=this._faces[a];if(!s.rootNode.invisible){s.plane.normal.dot(n.camera.worldTransform.z)<0&&s.plane.normal.negate();var l=o.intersectPlane(s.plane);if(l){var h=r.getAxis(s.faceInfo[0]),u=r.getAxis(s.faceInfo[1]),c=P[s.faceInfo[0]],g=P[s.faceInfo[1]];h.contain(l.array[c])&&u.contain(l.array[g])&&(t=l)}}}if(t){var p=r.pointToData(t.array,[],!0);this._updateAxisPointer(p),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var i=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),center:i.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new d.A.Vector3;e.update();for(var i=0;i<this._faces.length/2;i++){for(var r=[],n=0;n<2;n++){var o=this._faces[2*i+n];o.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),r[n]=t.z}var a=r[0]>r[1]?0:1,s=this._faces[2*i+a],l=this._faces[2*i+1-a];s.rootNode.invisible=!0,l.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),i=e.getAxis("y"),r=e.getAxis("z"),n=r.getExtentMax(),o=r.getExtentMin(),a=t.getExtentMin(),s=t.getExtentMax(),l=i.getExtentMax(),h=i.getExtentMin(),d=this._axes[0].rootNode,u=this._axes[1].rootNode,c=this._axes[2].rootNode,g=this._faces,p=g[4].rootNode.invisible?h:l,f=g[2].rootNode.invisible?n:o,m=g[0].rootNode.invisible?a:s,v=g[2].rootNode.invisible?n:o,_=g[0].rootNode.invisible?s:a,y=g[4].rootNode.invisible?h:l;d.rotation.identity(),u.rotation.identity(),c.rotation.identity(),g[4].rootNode.invisible&&(this._axes[0].flipped=!0,d.rotation.rotateX(Math.PI)),g[0].rootNode.invisible&&(this._axes[1].flipped=!0,u.rotation.rotateZ(Math.PI)),g[4].rootNode.invisible&&(this._axes[2].flipped=!0,c.rotation.rotateY(Math.PI)),d.position.set(0,f,p),u.position.set(m,v,0),c.position.set(_,0,y),d.update(),u.update(),c.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new d.A.Vector4,new d.A.Vector4],i=new d.A.Vector4;this.groupGL.getWorldPosition(i),i.w=1,i.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),i.x/=i.w,i.y/=i.w,this._axes.forEach((function(r){for(var n=r.axisLineCoords,o=(r.labelsMesh.geometry,0);o<t.length;o++)t[o].setArray(n[o]),t[o].w=1,t[o].transformMat4(r.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[o].x/=t[o].w,t[o].y/=t[o].w;var a,s,l=t[1].x-t[0].x,h=t[1].y-t[0].y,d=(t[1].x+t[0].x)/2,u=(t[1].y+t[0].y)/2;Math.abs(h/l)<.5?(a="center",s=u>i.y?"bottom":"top"):(s="middle",a=d>i.x?"left":"right"),r.setSpriteAlign(a,s,this._api)}),this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,i=t.dataToPoint(e),r=this._axisPointerLineMesh,n=r.geometry,o=this._model.getModel("axisPointer"),a=this._api.getDevicePixelRatio();function s(e){return g.A.firstNotNull(e.model.get("axisPointer.show"),o.get("show"))}function l(e){var t=e.model.getModel("axisPointer",o),i=t.getModel("lineStyle"),r=d.A.parseColor(i.get("color")),n=C(i.get("width"),1),a=C(i.get("opacity"),1);return r[3]*=a,{color:r,lineWidth:n}}n.convertToDynamicArray(!0);for(var h=0;h<this._faces.length;h++){var u=this._faces[h];if(!u.rootNode.invisible){for(var c=u.faceInfo,p=c[3]<0?t.getAxis(c[2]).getExtentMin():t.getAxis(c[2]).getExtentMax(),f=P[c[2]],m=0;m<2;m++){var v=c[m],_=c[1-m],y=t.getAxis(v),x=t.getAxis(_);if(s(y)){var w=[0,0,0],A=[0,0,0],S=P[v],b=P[_];w[S]=A[S]=i[S],w[f]=A[f]=p,w[b]=x.getExtentMin(),A[b]=x.getExtentMax();var M=l(y);n.addLine(w,A,M.color,M.lineWidth*a)}}if(s(t.getAxis(c[2]))){w=i.slice(),A=i.slice();A[f]=p;M=l(t.getAxis(c[2]));n.addLine(w,A,M.color,M.lineWidth*a)}}}n.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,i=this._axisPointerLabelsMesh,n=this._axisPointerLabelsSurface,o=t.coordinateSystem,a=t.getModel("axisPointer");i.geometry.convertToDynamicArray(!0),n.clear();var s={x:"y",y:"x",z:"y"};this._axes.forEach((function(t,l){var d=o.getAxis(t.dim),u=d.model,c=u.getModel("axisPointer",a),g=c.getModel("label"),p=c.get("lineStyle.color");if(g.get("show")&&c.get("show")){var f=e[l],m=g.get("formatter"),v=d.scale.getLabel({value:f});if(null!=m)v=m(v,e);else if("interval"===d.scale.type||"log"===d.scale.type){var _=r.ai.getPrecisionSafe(d.scale.getTicks()[0]);v=f.toFixed(_+2)}var y=g.get("color"),x=new r.fA.EY({style:(0,h.VB)(g,{text:v,fill:y||p,align:"left",verticalAlign:"top"})}),w=n.add(x),A=x.getBoundingRect(),S=this._api.getDevicePixelRatio(),b=t.rootNode.position.toArray(),M=P[s[t.dim]];b[M]+=(t.flipped?-1:1)*g.get("margin"),b[P[t.dim]]=d.dataToCoord(e[l]),i.geometry.addSprite(b,[A.width*S,A.height*S],w,t.textAlign,t.textVerticalAlign)}}),this),n.getZr().refreshImmediately(),i.material.set("uvScale",n.getCoordsScale()),i.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._axisLabelSurface.dispose(),this._axisPointerLabelsSurface.dispose()}}),I=i(9528);function O(e){I.A.call(this,e),this.type="cartesian3D",this.dimensions=["x","y","z"],this.size=[0,0,0]}O.prototype={constructor:O,model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],i),t[2]=this.getAxis("y").dataToCoord(e[1],i),t[1]=this.getAxis("z").dataToCoord(e[2],i),t},pointToData:function(e,t,i){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],i),t[1]=this.getAxis("y").coordToData(e[2],i),t[2]=this.getAxis("z").coordToData(e[1],i),t}},r.ZS.inherits(O,I.A);var N=O;function G(e,t,i){r._0.call(this,e,t,i)}G.prototype={constructor:G,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}},r.ZS.inherits(G,r._0);var R=G,z=i(93398),B=i(63858);function F(e,t){var i=e.getBoxLayoutParams(),r=(0,z.dV)(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=e.get("boxWidth"),o=e.get("boxHeight"),a=e.get("boxDepth");this.getAxis("x").setExtent(-n/2,n/2),this.getAxis("y").setExtent(a/2,-a/2),this.getAxis("z").setExtent(-o/2,o/2),this.size=[n,o,a]}function k(e,t){var i={};function n(e,t){i[e]=i[e]||[1/0,-1/0],i[e][0]=Math.min(t[0],i[e][0]),i[e][1]=Math.max(t[1],i[e][1])}e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData();["x","y","z"].forEach((function(e){t.mapDimensionsAll(e,!0).forEach((function(i){n(e,t.getDataExtent(i,!0))}))}))}}),this),["xAxis3D","yAxis3D","zAxis3D"].forEach((function(t){e.eachComponent(t,(function(e){var n=t.charAt(0),o=e.getReferringComponents("grid3D").models[0],a=o.coordinateSystem;if(a===this){var s=a.getAxis(n);if(!s){var l=r.dw.createScale(i[n]||[1/0,-1/0],e);s=new R(n,l),s.type=e.get("type");var h="category"===s.type;s.onBand=h&&e.get("boundaryGap"),s.inverse=e.get("inverse"),e.axis=s,s.model=e,s.getLabelModel=function(){return e.getModel("axisLabel",o.getModel("axisLabel"))},s.getTickModel=function(){return e.getModel("axisTick",o.getModel("axisTick"))},a.addAxis(s)}}}),this)}),this),this.resize(this.model,t)}var V={dimensions:N.prototype.dimensions,create:function(e,t){var i=[];e.eachComponent("grid3D",(function(e){e.__viewGL=e.__viewGL||new B.A;var t=new N;t.model=e,t.viewGL=e.__viewGL,e.coordinateSystem=t,i.push(t),t.resize=F,t.update=k}));var r=["xAxis3D","yAxis3D","zAxis3D"];function n(e,t){return r.map((function(i){var r=e.getReferringComponents(i).models[0];return null==r&&(r=t.getComponent(i)),r}))}return e.eachSeries((function(t){if("cartesian3D"===t.get("coordinateSystem")){var i=t.getReferringComponents("grid3D").models[0];if(null==i){var r=n(t,e);i=r[0].getCoordSysModel();r.forEach((function(e){e.getCoordSysModel()}))}var o=i.coordinateSystem;t.coordinateSystem=o}})),i}},H=V,W=r.jT.extend({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});r.dw.mixinAxisModelCommonMethods(W);var U=W,Z={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},$=r.ZS.merge({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},Z),j=r.ZS.merge({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},Z),Y=r.ZS.defaults({scale:!0,min:"dataMin",max:"dataMax"},j),X=r.ZS.defaults({logBase:10},j);X.scale=!0;var q={categoryAxis3D:$,valueAxis3D:j,timeAxis3D:Y,logAxis3D:X},Q=i(47686),J=["value","category","time","log"];function K(e,t,i,n,o){J.forEach((function(a){var s=i.extend({type:t+"Axis3D."+a,__ordinalMeta:null,mergeDefaultAndTheme:function(e,i){var o=i.getTheme();r.ZS.merge(e,o.get(a+"Axis3D")),r.ZS.merge(e,this.getDefaultOption()),e.type=n(t,e)},optionUpdated:function(){var e=this.option;"category"===e.type&&(this.__ordinalMeta=Q.A.createByAxisModel(this))},getCategories:function(){if("category"===this.option.type)return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:r.ZS.merge(r.ZS.clone(q[a+"Axis3D"]),o||{},!0)});e.registerComponentModel(s)})),e.registerSubTypeDefaulter(t+"Axis3D",r.ZS.curry(n,t))}function ee(e,t){return t.type||(t.data?"category":"value")}function te(e){e.registerComponentModel(l),e.registerComponentView(E),e.registerCoordinateSystem("grid3D",H),["x","y","z"].forEach((function(t){K(e,t,U,ee,{name:t.toUpperCase()});const i=e.ComponentView.extend({type:t+"Axis3D"});e.registerComponentView(i)})),e.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"grid3D",query:e},(function(t){t.setView(e)}))})),e.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},(function(e,t){})),e.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},(function(e,t){}))}(0,r.Yx)(te)},91696:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(75971)),o=i(76238),a=["zoom","center","pitch","bearing"],s=r.jT.extend({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return a.reduce((function(t,i){return t[i]=e.get(i),t}),{})},setMapboxCameraOption:function(e){null!=e&&a.forEach((function(t){null!=e[t]&&(this.option[t]=e[t])}),this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});r.ZS.merge(s.prototype,n.A),r.ZS.merge(s.prototype,o.A);var l=s;function h(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}h.prototype.setUnpainted=function(){},h.prototype.resize=function(){this._mapbox.resize()},h.prototype.getMapbox=function(){return this._mapbox},h.prototype.clear=function(){},h.prototype.refresh=function(){this._mapbox.resize()};var d=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];h.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(e){return e.preventDefault(),!1}},d.forEach((function(t){this._handlers[t]=function(t){var i={};for(var r in t)i[r]=t[r];i.bubbles=!1;var n=new t.constructor(t.type,i);e.dispatchEvent(n)},this.zr.dom.addEventListener(t,this._handlers[t])}),this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)},h.prototype.dispose=function(){d.forEach((function(e){this.zr.dom.removeEventListener(e,this._handlers[e])}),this)};var u=h,c=i(99628),g=i(9489),p=i(94643);g.A.Shader.import(p.A);var f=r.bR.extend({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var i=t.getZr();this._zrLayer=new u("mapbox3D",i),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new g.A.Node,this._sceneHelper=new c.A(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMapbox(),n=this._dispatchInteractAction.bind(this,t,r);["zoom","rotate","drag","pitch","rotate","move"].forEach((function(e){r.on(e,n)})),this._groundMesh=new g.A.Mesh({geometry:new g.A.PlaneGeometry,material:new g.A.Material({shader:new g.A.Shader({vertex:g.A.Shader.source("ecgl.displayShadow.vertex"),fragment:g.A.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,i){var r=this._zrLayer.getMapbox(),n=e.get("style"),o=JSON.stringify(n);o!==this._oldStyleStr&&n&&r.setStyle(n),this._oldStyleStr=o,r.setCenter(e.get("center")),r.setZoom(e.get("zoom")),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMapbox(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),i),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse((function(e){e.material&&(e.material.define("fragment","NORMAL_UP_AXIS",2),e.material.define("fragment","NORMAL_FRONT_AXIS",1))}))},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new g.A.Plane(new g.A.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new g.A.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new g.A.Vector2(1,1)),o=r.intersectPlane(i),a=n.intersectPlane(i),s=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}}),m=i(32121);function v(){m.A.apply(this,arguments)}v.prototype=new m.A,v.prototype.constructor=v,v.prototype.type="mapbox3D";var _=v,y=i(31825),x=(0,y.A)("mapbox3D",_,(function(e){e.forEach((function(e){e.setCameraOption(e.model.getMapboxCameraOption())}))})),w=x;function A(e){e.registerComponentModel(l),e.registerComponentView(f),e.registerCoordinateSystem("mapbox3D",w),e.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},(function(e,t){t.eachComponent({mainType:"mapbox3D",query:e},(function(t){t.setMapboxCameraOption(e)}))}))}(0,r.Yx)(A)},29108:function(e,t,i){"use strict";var r=i(85811),n=(i(48622),i(75971)),o=i(76238),a=["zoom","center","pitch","bearing"],s=r.jT.extend({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return a.reduce((function(t,i){return t[i]=e.get(i),t}),{})},setMaptalksCameraOption:function(e){null!=e&&a.forEach((function(t){null!=e[t]&&(this.option[t]=e[t])}),this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});r.ZS.merge(s.prototype,n.A),r.ZS.merge(s.prototype,o.A);var l=s;function h(e,t,i,r){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:i,zoom:r,doubleClickZoom:!1,fog:!1}),this._initEvents()}h.prototype.setUnpainted=function(){},h.prototype.resize=function(){this._maptalks.checkSize()},h.prototype.getMaptalks=function(){return this._maptalks},h.prototype.clear=function(){},h.prototype.refresh=function(){this._maptalks.checkSize()};var d=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];h.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(e){return e.preventDefault(),!1}},d.forEach((function(t){this._handlers[t]=function(i){var r={};for(var n in i)r[n]=i[n];r.bubbles=!1;var o=new i.constructor(i.type,r);"mousewheel"===t||"DOMMouseScroll"===t?e.dispatchEvent(o):e.firstElementChild.dispatchEvent(o)},this.zr.dom.addEventListener(t,this._handlers[t])}),this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)},h.prototype.dispose=function(){d.forEach((function(e){this.zr.dom.removeEventListener(e,this._handlers[e])}),this),this._maptalks.remove()};var u=h,c=i(99628),g=i(9489),p=i(94643);g.A.Shader.import(p.A);var f=r.bR.extend({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new g.A.Mesh({geometry:new g.A.PlaneGeometry,material:new g.A.Material({shader:new g.A.Shader({vertex:g.A.Shader.source("ecgl.displayShadow.vertex"),fragment:g.A.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var i=t.getZr();this._zrLayer=new u("maptalks3D",i,e.get("center"),e.get("zoom")),i.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new g.A.Node,this._sceneHelper=new c.A(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMaptalks(),n=this._dispatchInteractAction.bind(this,t,r);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend","animating"].forEach((function(e){r.on(e,n)}))},render:function(e,t,i){this._zrLayer||this._initMaptalksLayer(e,i);var r=this._zrLayer.getMaptalks(),n=e.get("urlTemplate"),o=r.getBaseLayer();n!==this._oldUrlTemplate&&(o?o.setOptions({urlTemplate:n,attribution:e.get("attribution")}):(o=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:n,subdomains:["a","b","c"],attribution:e.get("attribution")}),r.setBaseLayer(o))),this._oldUrlTemplate=n,r.setCenter(e.get("center")),r.setZoom(e.get("zoom"),{animation:!1}),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMaptalks(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),i),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,i,r){var n=r.renderer;this._sceneHelper.updateAmbientCubemap(n,e,i),this._sceneHelper.updateSkybox(n,e,i),e.coordinateSystem.viewGL.scene.traverse((function(e){e.material&&(e.material.define("fragment","NORMAL_UP_AXIS",2),e.material.define("fragment","NORMAL_FRONT_AXIS",1))}))},updateCamera:function(e,t,i,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),i.getZr().refresh()},_dispatchInteractAction:function(e,t,i){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:v(t.getResolution())+1,center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var i=new g.A.Plane(new g.A.Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new g.A.Vector2(-1,-1)),n=e.viewGL.camera.castRay(new g.A.Vector2(1,1)),o=r.intersectPlane(i),a=n.intersectPlane(i),s=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}});const m=12756274*Math.PI/(256*Math.pow(2,20));function v(e){return 19-Math.log(e/m)/Math.LN2}var _=i(32121);function y(){_.A.apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}y.prototype=new _.A,y.prototype.constructor=y,y.prototype.type="maptalks3D";var x=y,w=i(31825),A=(0,w.A)("maptalks3D",x,(function(e){e.forEach((function(e){e.setCameraOption(e.model.getMaptalksCameraOption())}))})),S=A;function b(e){e.registerComponentModel(l),e.registerComponentView(f),e.registerCoordinateSystem("maptalks3D",S),e.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},(function(e,t){t.eachComponent({mainType:"maptalks3D",query:e},(function(t){t.setMaptalksCameraOption(e)}))}))}(0,r.Yx)(b)},99961:function(e,t,i){"use strict";i.d(t,{A:function(){return y}});i(44114),i(16573),i(78100),i(77936),i(37467),i(44732),i(79577);var r=i(85811),n=i(73737),o=i(67209),a=i(31867),s=n.A.vec3,l=n.A.mat4,h=[o.A,a.A];function d(e,t,i,r,n){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(i,r,n),this.transform=l.identity(new Float64Array(16)),this.invTransform=l.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}d.prototype={constructor:d,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,i){var n=r.l3||r.zI;try{this.regions=e?n(e):[]}catch(u){throw"Invalid geoJson format\n"+u}t=t||{},i=i||{};for(var o=this.regions,a={},s=0;s<o.length;s++){var l=o[s].name;l=i[l]||l,o[s].name=l,a[l]=o[s],this.addGeoCoord(l,o[s].getCenter());var d=t[l];d&&o[s].transformTo(d.left,d.top,d.width,d.height)}this._regionsMap=a,this._geoRect=null,h.forEach((function(e){e(this)}),this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,i=0;i<t.length;i++){var n=t[i].getBoundingRect();e=e||n.clone(),e.union(n)}return this._geoRect=e||new r.fA.RJ(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,i=0;i<t.length;i++)if(t[i].contain(e))return t[i]},setSize:function(e,t,i){this.size=[e,t,i];var r=this.getGeoBoundingRect(),n=e/r.width,o=-i/r.height,a=-e/2-r.x*n,s=i/2-r.y*o,h=this.extrudeY?[a,0,s]:[a,s,0],d=this.extrudeY?[n,1,o]:[n,o,1],u=this.transform;l.identity(u),l.translate(u,u,h),l.scale(u,u,d),l.invert(this.invTransform,u)},dataToPoint:function(e,t){t=t||[];var i=this.extrudeY?1:2,r=this.extrudeY?2:1,n=e[2];return isNaN(n)&&(n=0),t[0]=e[0],t[r]=e[1],this.altitudeAxis?t[i]=this.altitudeAxis.dataToCoord(n):t[i]=0,t[i]+=this.regionHeight,s.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}};var u=d,c=i(93398),g=i(63858),p=i(69665);function f(e,t){var i=e.getBoxLayoutParams(),r=(0,c.dV)(i,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var n=this.getGeoBoundingRect(),o=n.width/n.height*(e.get("aspectScale")||.75),a=e.get("boxWidth"),s=e.get("boxDepth"),l=e.get("boxHeight");null==l&&(l=5),isNaN(a)&&isNaN(s)&&(a=100),isNaN(s)?s=a/o:isNaN(a)&&(a=s/o),this.setSize(a,l,s),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(l-this.regionHeight,0))}function m(e,t){var i=[1/0,-1/0];if(e.eachSeries((function(e){if(e.coordinateSystem===this&&"series.map3D"!==e.type){var t=e.getData(),r=e.coordDimToDataDim("alt"),n=r&&r[0];if(n){var o=t.getDataExtent(n,!0);i[0]=Math.min(i[0],o[0]),i[1]=Math.max(i[1],o[1])}}}),this),i&&isFinite(i[1]-i[0])){var n=r.dw.createScale(i,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new r._0("altitude",n),this.resize(this.model,t)}}var v=0,_={dimensions:u.prototype.dimensions,create:function(e,t){var i=[];if(!r.ZB)throw new Error("geo3D component depends on geo component");function n(e,r){var n=_.createGeo3D(e);e.__viewGL=e.__viewGL||new g.A,n.viewGL=e.__viewGL,e.coordinateSystem=n,n.model=e,i.push(n),n.resize=f,n.resize(e,t),n.update=m}return e.eachComponent("geo3D",(function(e,t){n(e,t)})),e.eachSeriesByType("map3D",(function(e,t){var i=e.get("coordinateSystem");null==i&&(i="geo3D"),"geo3D"===i&&n(e,t)})),e.eachSeries((function(t){if("geo3D"===t.get("coordinateSystem")){if("series.map3D"===t.type)return;var i=t.getReferringComponents("geo3D").models[0];if(i||(i=e.getComponent("geo3D")),!i)throw new Error('geo "'+p.A.firstNotNull(t.get("geo3DIndex"),t.get("geo3DId"),0)+'" not found');t.coordinateSystem=i.coordinateSystem}})),i},createGeo3D:function(e){var t,i=e.get("map");return"string"===typeof i?(t=i,i=r.ZB(i)):i&&i.features&&(i={geoJson:i}),null==t&&(t="GEO_ANONYMOUS_"+v++),new u(t+v++,t,i&&i.geoJson,i&&i.specialAreas,e.get("nameMap"))}},y=_},97483:function(e,t,i){"use strict";i(44114);var r=i(85811);t.A={getFilledRegions:function(e,t){var i,n=(e||[]).slice();if("string"===typeof t?(t=r.ZB(t),i=t&&t.geoJson):t&&t.features&&(i=t),!i)return[];for(var o={},a=i.features,s=0;s<n.length;s++)o[n[s].name]=n[s];for(s=0;s<a.length;s++){var l=a[s].properties.name;o[l]||n.push({name:l})}return n},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}}},32121:function(e,t,i){"use strict";var r=i(73737),n=r.A.mat4,o=512,a=.6435011087932844,s=Math.PI,l=.1;function h(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}h.prototype={constructor:h,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,o)),null==this._initialZoom&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(a/2)*this.height*l,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,i=a/2,r=Math.PI/2+t,s=Math.sin(i)*e/Math.sin(Math.PI-r-i),h=Math.cos(Math.PI/2-t)*s+e,d=1.1*h;this.pitch>50&&(d=1e3);var u=[];n.perspective(u,a,this.width/this.height,1,d),this.viewGL.camera.projectionMatrix.setArray(u),this.viewGL.camera.decomposeProjectionMatrix();u=n.identity([]);var c=this.dataToPoint(this.center);n.scale(u,u,[1,-1,1]),n.translate(u,u,[0,0,-e]),n.rotateX(u,u,t),n.rotateZ(u,u,-this.bearing/180*Math.PI),n.translate(u,u,[-c[0]*this.getScale()*l,-c[1]*this.getScale()*l,0]),this.viewGL.camera.viewMatrix.array=u;var g=[];n.invert(g,u),this.viewGL.camera.worldTransform.array=g,this.viewGL.camera.decomposeWorldTransform();var p,f=o*this.getScale();if(this.altitudeExtent&&!isNaN(this.boxHeight)){var m=this.altitudeExtent[1]-this.altitudeExtent[0];p=this.boxHeight/m*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else p=f/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*l;this.viewGL.rootNode.scale.set(this.getScale()*l,this.getScale()*l,p)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*o,t)},projectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],o=r*s/180,a=n*s/180,l=t*(o+s)/(2*s),h=t*(s-Math.log(Math.tan(s/4+.5*a)))/(2*s);return i=i||[],i[0]=l,i[1]=h,i},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*o,t)},unprojectOnTileWithScale:function(e,t,i){var r=e[0],n=e[1],o=r/t*(2*s)-s,a=2*(Math.atan(Math.exp(s-n/t*(2*s)))-s/4);return i=i||[],i[0]=180*o/s,i[1]=180*a/s,i},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,o,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}},t.A=h},31825:function(e,t,i){"use strict";i.d(t,{A:function(){return a}});i(44114);var r=i(69665),n=i(9489),o=i(63858);function a(e,t,i){function a(e,t){var i=t.getWidth(),r=t.getHeight(),n=t.getDevicePixelRatio();this.viewGL.setViewport(0,0,i,r,n),this.width=i,this.height=r,this.altitudeScale=e.get("altitudeScale"),this.boxHeight=e.get("boxHeight")}function s(e,t){if("auto"!==this.model.get("boxHeight")){var i=[1/0,-1/0];e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData(),r=e.coordDimToDataDim("alt")[0];if(r){var n=t.getDataExtent(r,!0);i[0]=Math.min(i[0],n[0]),i[1]=Math.max(i[1],n[1])}}}),this),i&&isFinite(i[1]-i[0])&&(this.altitudeExtent=i)}}return{dimensions:t.prototype.dimensions,create:function(l,h){var d=[];return l.eachComponent(e,(function(e){var i=e.__viewGL;i||(i=e.__viewGL=new o.A,i.setRootNode(new n.A.Node));var r=new t;r.viewGL=e.__viewGL,r.resize=a,r.resize(e,h),d.push(r),e.coordinateSystem=r,r.model=e,r.update=s})),l.eachSeries((function(t){if(t.get("coordinateSystem")===e){var i=t.getReferringComponents(e).models[0];if(i||(i=l.getComponent(e)),!i)throw new Error(e+' "'+r.A.firstNotNull(t.get(e+"Index"),t.get(e+"Id"),0)+'" not found');t.coordinateSystem=i.coordinateSystem}})),i&&i(d,l,h),d}}}},9352:function(e,t,i){"use strict";i(44114);var r=i(85811),n=i(68640),o=i(2678),a=i(68718),s=i(9489),l=i(91029),h=i(84438),d=function(e,t){this.id=e,this.zr=t;try{this.renderer=new n.A({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(a){return this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",void console.error(a)}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var i=this.dom.style;i.position="absolute",i.left="0",i.top="0",this.views=[],this._picking=new o.A({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new r.fA.rw({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null,this._disposed=!1};function u(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}d.prototype.setUnpainted=function(){},d.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var i=this.zr;e.scene.traverse((function(e){e.__zr=i,e.addAnimatorsToZr&&e.addAnimatorsToZr(i)}))}},d.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(u,this),e.layer=null,this._viewsToDispose.push(e))}},d.prototype.removeViewsAll=function(){this.views.forEach((function(e){e.scene.traverse(u,this),e.layer=null,this._viewsToDispose.push(e)}),this),this.views.length=0},d.prototype.resize=function(e,t){var i=this.renderer;i.resize(e,t)},d.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)},d.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)},d.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},d.prototype.needsRefresh=function(){this.zr.refresh()},d.prototype.refresh=function(e){this._backgroundColor=e?s.A.parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()},d.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)},d.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()},d.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var c=1;function g(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function p(e,t){for(var i=0;i<t.length;i++)t[i].__used__||t[i].dispose(e)}function f(e,t){e.__used__=e.__used__||0,e.__used__++,1===e.__used__&&t.push(e)}function m(e,t,i){var r,n;e.traverse((function(e){if(e.isRenderable()){var o=e.geometry,s=e.material;if(s!==r)for(var l=s.getTextureUniforms(),h=0;h<l.length;h++){var d=l[h],u=s.uniforms[d].value;if(u)if(u instanceof a.A)f(u,t);else if(u instanceof Array)for(var c=0;c<u.length;c++)u[c]instanceof a.A&&f(u[c],t)}o!==n&&f(o,i),r=s,n=o}}));for(var o=0;o<e.lights.length;o++)e.lights[o].cubemap&&f(e.lights[o].cubemap,t)}d.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var i=!1,r=0;r<this.views.length;r++)i=this.views[r].needsAccumulate()||i;function n(r){if(t._accumulatingId&&r===t._accumulatingId){for(var o=!0,a=0;a<t.views.length;a++)o=t.views[a].isAccumulateFinished()&&i;o||(t._doRender(!0),e?n(r):(0,h.A)((function(){n(r)})))}}i&&(this._accumulatingId=c++,e?n(t._accumulatingId):this._accumulatingTimeout=setTimeout((function(){n(t._accumulatingId)}),50))},d.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(g(this._textureList),g(this._geometriesList));for(var i=0;i<this.views.length;i++)m(this.views[i].scene,e,t);this._textureList&&(p(this.renderer,this._textureList),p(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t},d.prototype.dispose=function(){this._disposed||(this._stopAccumulating(),this._textureList&&(g(this._textureList),g(this._geometriesList),p(this.renderer,this._textureList),p(this.renderer,this._geometriesList)),this.zr.off("globalout",this.onglobalout),this._disposed=!0)},d.prototype.onmousedown=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}},d.prototype.onmousemove=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),i=t&&t.target,r=this._hovered;this._hovered=t,r&&i!==r.target&&(r.relatedTarget=i,this._dispatchEvent("mouseout",e,r),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),r&&i===r.target||this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}},d.prototype.onmouseup=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}},d.prototype.onclick=d.prototype.dblclick=function(e){if(!e.target||!e.target.__isGLToZRProxy){var t=this._upX-this._downX,i=this._upY-this._downY;if(!(Math.sqrt(t*t+i*i)>20)){e=e.event;var r=this.pickObject(e.offsetX,e.offsetY);r&&(this._dispatchEvent(e.type,e,r),this._dispatchDataEvent(e.type,e,r));var n=this._clickToSetFocusPoint(e);if(n){var o=n.view.setDOFFocusOnPoint(n.distance);o&&this.zr.refresh()}}}},d.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,i=t.viewport,r=this.views.length-1;r>=0;r--){var n=this.views[r];if(n.hasDOF()&&n.containPoint(e.offsetX,e.offsetY)){this._picking.scene=n.scene,this._picking.camera=n.camera,t.viewport=n.viewport;var o=this._picking.pick(e.offsetX,e.offsetY,!0);if(o)return o.view=n,o}}t.viewport=i},d.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})},d.prototype.pickObject=function(e,t){for(var i=[],r=this.renderer,n=r.viewport,o=0;o<this.views.length;o++){var a=this.views[o];a.containPoint(e,t)&&(this._picking.scene=a.scene,this._picking.camera=a.camera,r.viewport=a.viewport,this._picking.pickAll(e,t,i))}return r.viewport=n,i.sort((function(e,t){return e.distance-t.distance})),i[0]},d.prototype._dispatchEvent=function(e,t,i){i||(i={});var r=i.target;i.cancelBubble=!1,i.event=t,i.type=e,i.offsetX=t.offsetX,i.offsetY=t.offsetY;while(r)if(r.trigger(e,i),r=r.getParent(),i.cancelBubble)break;this._dispatchToView(e,i)},d.prototype._dispatchDataEvent=function(e,t,i){var n=i&&i.target,o=n&&n.dataIndex,a=n&&n.seriesIndex,s=n&&n.eventData,l=!1,h=this._zrEventProxy;h.x=t.offsetX,h.y=t.offsetY,h.update();var d={target:h};const u=r.dw.getECData(h);"mousemove"===e&&(null!=o?o!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(u.dataIndex=this._lastDataIndex,u.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(d,"mouseout",t)),l=!0):null!=s&&s!==this._lastEventData&&(null!=this._lastEventData&&(u.eventData=this._lastEventData,this.zr.handler.dispatchToElement(d,"mouseout",t)),l=!0),this._lastEventData=s,this._lastDataIndex=o,this._lastSeriesIndex=a),u.eventData=s,u.dataIndex=o,u.seriesIndex=a,(null!=s||parseInt(o,10)>=0&&parseInt(a,10)>=0)&&(this.zr.handler.dispatchToElement(d,e,t),l&&this.zr.handler.dispatchToElement(d,"mouseover",t))},d.prototype._dispatchToView=function(e,t){for(var i=0;i<this.views.length;i++)this.views[i].containPoint(t.offsetX,t.offsetY)&&this.views[i].trigger(e,t)},Object.assign(d.prototype,l.A),t.A=d},63858:function(e,t,i){"use strict";i(44114),i(85811);var r=i(41277),n=i(82472),o=i(82223),a=i(16631),s=i(21647),l=i(504),h=i(34863),d=i(91029),u=i(94521),c=i(58100),g=i(40144);function p(e){e=e||"perspective",this.layer=null,this.scene=new r.A,this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new u.A,this._temporalSS=new c.A,this._shadowMapPass=new n.A;for(var t=[],i=0,o=0;o<30;o++){for(var a=[],s=0;s<6;s++)a.push(4*(0,g.A)(i,2)-2),a.push(4*(0,g.A)(i,3)-2),i++;t.push(a)}this._pcfKernels=t,this.scene.on("beforerender",(function(e,t,i){this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,i)}),this)}p.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),"perspective"===e?this.camera instanceof o.A||(this.camera=new o.A,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof a.A||(this.camera=new a.A,t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3},p.prototype.setViewport=function(e,t,i,r,n){this.camera instanceof o.A&&(this.camera.aspect=i/r),n=n||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=i,this.viewport.height=r,this.viewport.devicePixelRatio=n,this._compositor.resize(i*n,r*n),this._temporalSS.resize(i*n,r*n)},p.prototype.containPoint=function(e,t){var i=this.viewport,r=this.layer.renderer.getHeight();return t=r-t,e>=i.x&&t>=i.y&&e<=i.x+i.width&&t<=i.y+i.height};var f=new h.A;p.prototype.castRay=function(e,t,i){var r=this.layer.renderer,n=r.viewport;return r.viewport=this.viewport,r.screenToNDC(e,t,f),this.camera.castRay(f,i),r.viewport=n,i},p.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var i=e.transparent[t],r=i.geometry;r.needsSortVerticesProgressively&&r.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),r.needsSortTrianglesProgressively&&r.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()},p.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++},p.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively},p.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return"auto"===e&&(e=this._enablePostEffect),e},p.prototype.hasDOF=function(){return this._enableDOF},p.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30},p.prototype._doRender=function(e,t,i){var r=this.scene,n=this.camera;i=i||0,this._updateTransparent(e,r,n,i),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,r,n,!0)),this._updateShadowPCFKernel(i);var o=e.clearColor;if(e.gl.clearColor(o[0],o[1],o[2],o[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,n),this._compositor.updateNormal(e,r,n,this._temporalSS.getFrame())),this._updateSSAO(e,r,n,this._temporalSS.getFrame()),this._enablePostEffect){var a=this._compositor.getSourceFrameBuffer();a.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(r,n,!0,!0),a.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,r,n,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,r,n,null,0))}else if(this.needsTemporalSS()&&t){a=this._temporalSS.getSourceFrameBuffer();a.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(r,n,!0,!0),e.restoreClear(),a.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(r,n,!0,!0)},p.prototype._updateTransparent=function(e,t,i,r){for(var n=new l.A,o=new s.A,a=i.getWorldPosition(),h=t.getRenderList(i).transparent,d=0;d<h.length;d++){var u=h[d],c=u.geometry;s.A.invert(o,u.worldTransform),l.A.transformMat4(n,a,o),c.needsSortTriangles&&c.needsSortTriangles()&&c.doSortTriangles(n,r),c.needsSortVertices&&c.needsSortVertices()&&c.doSortVertices(n,r)}},p.prototype._updateSSAO=function(e,t,i){var r=this._enableSSAO&&this._enablePostEffect;r&&this._compositor.updateSSAO(e,t,i,this._temporalSS.getFrame());for(var n=t.getRenderList(i),o=0;o<n.opaque.length;o++){var a=n.opaque[o];a.renderNormal&&a.material[r?"enableTexture":"disableTexture"]("ssaoMap"),r&&a.material.set("ssaoMap",this._compositor.getSSAOTexture())}},p.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],i=this.scene.getRenderList(this.camera),r=i.opaque,n=0;n<r.length;n++)r[n].receiveShadow&&(r[n].material.set("pcfKernel",t),r[n].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))},p.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)},p.prototype.setPostEffect=function(e,t){var i=this._compositor;this._enablePostEffect=e.get("enable");var r=e.getModel("bloom"),n=e.getModel("edge"),o=e.getModel("DOF",e.getModel("depthOfField")),a=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),l=e.getModel("FXAA"),h=e.getModel("colorCorrection");r.get("enable")?i.enableBloom():i.disableBloom(),o.get("enable")?i.enableDOF():i.disableDOF(),s.get("enable")?i.enableSSR():i.disableSSR(),h.get("enable")?i.enableColorCorrection():i.disableColorCorrection(),n.get("enable")?i.enableEdge():i.disableEdge(),l.get("enable")?i.enableFXAA():i.disableFXAA(),this._enableDOF=o.get("enable"),this._enableSSAO=a.get("enable"),this._enableSSAO?i.enableSSAO():i.disableSSAO(),i.setBloomIntensity(r.get("intensity")),i.setEdgeColor(n.get("color")),i.setColorLookupTexture(h.get("lookupTexture"),t),i.setExposure(h.get("exposure")),["radius","quality","intensity"].forEach((function(e){i.setSSAOParameter(e,a.get(e))})),["quality","maxRoughness","physical"].forEach((function(e){i.setSSRParameter(e,s.get(e))})),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach((function(e){i.setDOFParameter(e,o.get(e))})),["brightness","contrast","saturation"].forEach((function(e){i.setColorCorrection(e,h.get(e))}))},p.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect){if(e>this.camera.far||e<this.camera.near)return;return this._compositor.setDOFParameter("focalDistance",e),!0}},p.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")},p.prototype.isLinearSpace=function(){return this._enablePostEffect},p.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),i=0;i<t.length;i++)e.add(t[i]);e!==this.scene&&this.scene.add(e),this.rootNode=e}},p.prototype.add=function(e){this.rootNode.add(e)},p.prototype.remove=function(e){this.rootNode.remove(e)},p.prototype.removeAll=function(e){this.rootNode.removeAll(e)},Object.assign(p.prototype,d.A),t.A=p}}]);
//# sourceMappingURL=chunk-vendors-bc050c32.7f21ecfb.js.map