"use strict";(self["webpackChunkd1"]=self["webpackChunkd1"]||[]).push([[342],{31506:function(t,e,r){var i=r(55393),n=r(21647),s=r(78174),a=r(56044),o=r(16448),u=r(33301),h=i.A.extend((function(){return{projectionMatrix:new n.A,invProjectionMatrix:new n.A,viewMatrix:new n.A,frustum:new s.A}}),(function(){this.update(!0)}),{update:function(t){i.A.prototype.update.call(this,t),n.A.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),n.A.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(t){n.A.copy(this.viewMatrix,t),n.A.invert(this.worldTransform,t),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(t){n.A.copy(this.projectionMatrix,t),n.A.invert(this.invProjectionMatrix,t),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var t=o.A.create();return function(e,r){var i=void 0!==r?r:new a.A,n=e.array[0],s=e.array[1];return o.A.set(t,n,s,-1,1),o.A.transformMat4(t,t,this.invProjectionMatrix.array),o.A.transformMat4(t,t,this.worldTransform.array),u.A.scale(i.origin.array,t,1/t[3]),o.A.set(t,n,s,1,1),o.A.transformMat4(t,t,this.invProjectionMatrix.array),o.A.transformMat4(t,t,this.worldTransform.array),u.A.scale(t,t,1/t[3]),u.A.sub(i.direction.array,t,i.origin.array),u.A.normalize(i.direction.array,i.direction.array),i.direction._dirty=!0,i.origin._dirty=!0,i}}()});e.A=h},87322:function(t,e,r){var i=r(49350),n=r(68718),s=r(21639),a=r(81307),o="framebuffer",u="renderbuffer",h=u+"_width",f=u+"_height",c=u+"_attached",l="depthtexture_attached",d=s.A.FRAMEBUFFER,v=s.A.RENDERBUFFER,_=s.A.DEPTH_ATTACHMENT,A=s.A.COLOR_ATTACHMENT0,m=i.A.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},(function(){this._cache=new a.A,this._textures={}}),{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(t){if(t.__currentFrameBuffer){if(t.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}t.__currentFrameBuffer=this;var e=t.gl;e.bindFramebuffer(d,this._getFrameBufferGL(t)),this._boundRenderer=t;var r=this._cache;r.put("viewport",t.viewport);var i,n,s=!1;for(var a in this._textures){s=!0;var o=this._textures[a];o&&(i=o.texture.width,n=o.texture.height,this._doAttach(t,o.texture,a,o.target))}this._width=i,this._height=n,!s&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?t.setViewport(this.viewport):t.setViewport(0,0,i,n,1);var A=r.get("attached_textures");if(A)for(var a in A)if(!this._textures[a]){var m=A[a];this._doDetach(e,a,m)}if(!r.get(l)&&this.depthBuffer){r.miss(u)&&r.put(u,e.createRenderbuffer());var p=r.get(u);i===r.get(h)&&n===r.get(f)||(e.bindRenderbuffer(v,p),e.renderbufferStorage(v,e.DEPTH_COMPONENT16,i,n),r.put(h,i),r.put(f,n),e.bindRenderbuffer(v,null)),r.get(c)||(e.framebufferRenderbuffer(d,_,v,p),r.put(c,!0))}},unbind:function(t){t.__currentFrameBuffer=null;var e=t.gl;e.bindFramebuffer(d,null),this._boundRenderer=null,this._cache.use(t.__uid__);var r=this._cache.get("viewport");r&&t.setViewport(r),this.updateMipmap(t)},updateMipmap:function(t){var e=t.gl;for(var r in this._textures){var i=this._textures[r];if(i){var a=i.texture;if(!a.NPOT&&a.useMipmap&&a.minFilter===n.A.LINEAR_MIPMAP_LINEAR){var o="textureCube"===a.textureType?s.A.TEXTURE_CUBE_MAP:s.A.TEXTURE_2D;e.bindTexture(o,a.getWebGLTexture(t)),e.generateMipmap(o),e.bindTexture(o,null)}}}},checkStatus:function(t){return t.checkFramebufferStatus(d)},_getFrameBufferGL:function(t){var e=this._cache;return e.use(t.__uid__),e.miss(o)&&e.put(o,t.gl.createFramebuffer()),e.get(o)},attach:function(t,e,r){if(!t.width)throw new Error("The texture attached to color buffer is not a valid.");e=e||A,r=r||s.A.TEXTURE_2D;var i,n=this._boundRenderer,a=n&&n.gl;if(a){var o=this._cache;o.use(n.__uid__),i=o.get("attached_textures")}var u=this._textures[e];if(!u||u.target!==r||u.texture!==t||!i||null==i[e]){var h=!0;n&&(h=this._doAttach(n,t,e,r),this.viewport||n.setViewport(0,0,t.width,t.height,1)),h&&(this._textures[e]=this._textures[e]||{},this._textures[e].texture=t,this._textures[e].target=r)}},_doAttach:function(t,e,r,i){var n=t.gl,a=e.getWebGLTexture(t),o=this._cache.get("attached_textures");if(o&&o[r]){var h=o[r];if(h.texture===e&&h.target===i)return}r=+r;var f=!0;if(r===_||r===s.A.DEPTH_STENCIL_ATTACHMENT){var A=t.getGLExtension("WEBGL_depth_texture");if(A||(console.error("Depth texture is not supported by the browser"),f=!1),e.format!==s.A.DEPTH_COMPONENT&&e.format!==s.A.DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),f=!1),f){var m=this._cache.get(u);m&&(n.framebufferRenderbuffer(d,_,v,null),n.deleteRenderbuffer(m),this._cache.put(u,!1)),this._cache.put(c,!1),this._cache.put(l,!0)}}return n.framebufferTexture2D(d,r,i,a,0),o||(o={},this._cache.put("attached_textures",o)),o[r]=o[r]||{},o[r].texture=e,o[r].target=i,f},_doDetach:function(t,e,r){t.framebufferTexture2D(d,e,r,null,0);var i=this._cache.get("attached_textures");i&&i[e]&&(i[e]=null),e!==_&&e!==s.A.DEPTH_STENCIL_ATTACHMENT||this._cache.put(l,!1)},detach:function(t,e){if(this._textures[t]=null,this._boundRenderer){var r=this._cache;r.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,t,e)}},dispose:function(t){var e=t.gl,r=this._cache;r.use(t.__uid__);var i=r.get(u);i&&e.deleteRenderbuffer(i);var n=r.get(o);n&&e.deleteFramebuffer(n),r.deleteContext(t.__uid__),this._textures={}}});m.DEPTH_ATTACHMENT=_,m.COLOR_ATTACHMENT0=A,m.STENCIL_ATTACHMENT=s.A.STENCIL_ATTACHMENT,m.DEPTH_STENCIL_ATTACHMENT=s.A.DEPTH_STENCIL_ATTACHMENT,e.A=m},21788:function(t,e,r){r.d(e,{A:function(){return y}});r(16573),r(78100),r(77936),r(37467),r(44732),r(79577);var i=r(2739),n=r(33301),s=r(87064),a=r(47797),o=(r(44114),r(49350)),u=r(21639),h=r(81307);function f(t){return{byte:i.A.Int8Array,ubyte:i.A.Uint8Array,short:i.A.Int16Array,ushort:i.A.Uint16Array}[t]||i.A.Float32Array}function c(t){return"attr_"+t}function l(t,e,r,i){switch(this.name=t,this.type=e,this.size=r,this.semantic=i||"",this.value=null,r){case 1:this.get=function(t){return this.value[t]},this.set=function(t,e){this.value[t]=e},this.copy=function(t,e){this.value[t]=this.value[t]};break;case 2:this.get=function(t,e){var r=this.value;return e[0]=r[2*t],e[1]=r[2*t+1],e},this.set=function(t,e){var r=this.value;r[2*t]=e[0],r[2*t+1]=e[1]},this.copy=function(t,e){var r=this.value;e*=2,t*=2,r[t]=r[e],r[t+1]=r[e+1]};break;case 3:this.get=function(t,e){var r=3*t,i=this.value;return e[0]=i[r],e[1]=i[r+1],e[2]=i[r+2],e},this.set=function(t,e){var r=3*t,i=this.value;i[r]=e[0],i[r+1]=e[1],i[r+2]=e[2]},this.copy=function(t,e){var r=this.value;e*=3,t*=3,r[t]=r[e],r[t+1]=r[e+1],r[t+2]=r[e+2]};break;case 4:this.get=function(t,e){var r=this.value,i=4*t;return e[0]=r[i],e[1]=r[i+1],e[2]=r[i+2],e[3]=r[i+3],e},this.set=function(t,e){var r=this.value,i=4*t;r[i]=e[0],r[i+1]=e[1],r[i+2]=e[2],r[i+3]=e[3]},this.copy=function(t,e){var r=this.value;e*=4,t*=4,r[t]=r[e],r[t+1]=r[e+1],r[t+2]=r[e+2],r[t+3]=r[e+3]}}}function d(t,e,r,i,n){this.name=t,this.type=e,this.buffer=r,this.size=i,this.semantic=n,this.symbol="",this.needsRemove=!1}function v(t){this.buffer=t,this.count=0}l.prototype.init=function(t){if(!this.value||this.value.length!==t*this.size){var e=f(this.type);this.value=new e(t*this.size)}},l.prototype.fromArray=function(t){var e,r=f(this.type);if(t[0]&&t[0].length){var i=0,n=this.size;e=new r(t.length*n);for(var s=0;s<t.length;s++)for(var a=0;a<n;a++)e[i++]=t[s][a]}else e=new r(t);this.value=e},l.prototype.clone=function(t){var e=new l(this.name,this.type,this.size,this.semantic);return t&&console.warn("todo"),e};var _=o.A.extend((function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}}),(function(){this._cache=new h.A,this._attributeList=Object.keys(this.attributes),this.__vaoCache={}}),{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var t=this.getEnabledAttributes(),e=0;e<t.length;e++)this.dirtyAttribute(t[e]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(t){this._cache.dirtyAll(c(t)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(t,e){if(t<this.triangleCount&&t>=0){e||(e=[]);var r=this.indices;return e[0]=r[3*t],e[1]=r[3*t+1],e[2]=r[3*t+2],e}},setTriangleIndices:function(t,e){var r=this.indices;r[3*t]=e[0],r[3*t+1]=e[1],r[3*t+2]=e[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(t){var e,r=this.vertexCount>65535?i.A.Uint32Array:i.A.Uint16Array;if(t[0]&&t[0].length){var n=0,s=3;e=new r(t.length*s);for(var a=0;a<t.length;a++)for(var o=0;o<s;o++)e[n++]=t[a][o]}else e=new r(t);this.indices=e},createAttribute:function(t,e,r,i){var n=new l(t,e,r,i);return this.attributes[t]&&this.removeAttribute(t),this.attributes[t]=n,this._attributeList.push(t),n},removeAttribute:function(t){var e=this._attributeList,r=e.indexOf(t);return r>=0&&(e.splice(r,1),delete this.attributes[t],!0)},getAttribute:function(t){return this.attributes[t]},getEnabledAttributes:function(){var t=this._enabledAttributes,e=this._attributeList;if(t)return t;for(var r=[],i=this.vertexCount,n=0;n<e.length;n++){var s=e[n],a=this.attributes[s];a.value&&a.value.length===i*a.size&&r.push(s)}return this._enabledAttributes=r,r},getBufferChunks:function(t){var e=this._cache;e.use(t.__uid__);var r=e.isDirty("attributes"),i=e.isDirty("indices");if(r||i){this._updateBuffer(t.gl,r,i);for(var n=this.getEnabledAttributes(),s=0;s<n.length;s++)e.fresh(c(n[s]));e.fresh("attributes"),e.fresh("indices")}return e.fresh("any"),e.get("chunks")},_updateBuffer:function(t,e,r){var i=this._cache,n=i.get("chunks"),s=!1;n||(n=[],n[0]={attributeBuffers:[],indicesBuffer:null},i.put("chunks",n),s=!0);var a=n[0],o=a.attributeBuffers,u=a.indicesBuffer;if(e||s){var h=this.getEnabledAttributes(),f={};if(!s)for(var l=0;l<o.length;l++)f[o[l].name]=o[l];for(var _=0;_<h.length;_++){var A,m,p=h[_],g=this.attributes[p];s||(A=f[p]),m=A?A.buffer:t.createBuffer(),i.isDirty(c(p))&&(t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,g.value,this.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW)),o[_]=new d(p,g.type,m,g.size,g.semantic)}for(l=_;l<o.length;l++)t.deleteBuffer(o[l].buffer);o.length=_}this.isUseIndices()&&(r||s)&&(u||(u=new v(t.createBuffer()),a.indicesBuffer=u),u.count=this.indices.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW))},dispose:function(t){var e=this._cache;e.use(t.__uid__);var r=e.get("chunks");if(r)for(var i=0;i<r.length;i++){for(var n=r[i],s=0;s<n.attributeBuffers.length;s++){var a=n.attributeBuffers[s];t.gl.deleteBuffer(a.buffer)}n.indicesBuffer&&t.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var o=t.getGLExtension("OES_vertex_array_object");for(var u in this.__vaoCache){var h=this.__vaoCache[u].vao;h&&o.deleteVertexArrayOES(h)}}this.__vaoCache={},e.deleteContext(t.__uid__)}});Object.defineProperty&&(Object.defineProperty(_.prototype,"vertexCount",{enumerable:!1,get:function(){var t=this.attributes[this.mainAttribute];return t||(t=this.attributes[this._attributeList[0]]),t&&t.value?t.value.length/t.size:0}}),Object.defineProperty(_.prototype,"triangleCount",{enumerable:!1,get:function(){var t=this.indices;return t?t.length/3:0}})),_.STATIC_DRAW=u.A.STATIC_DRAW,_.DYNAMIC_DRAW=u.A.DYNAMIC_DRAW,_.STREAM_DRAW=u.A.STREAM_DRAW,_.AttributeBuffer=d,_.IndicesBuffer=v,_.Attribute=l;var A=_,m=n.A.create,p=n.A.add,g=n.A.set,b=A.Attribute,T=A.extend((function(){return{attributes:{position:new b("position","float",3,"POSITION"),texcoord0:new b("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new b("texcoord1","float",2,"TEXCOORD_1"),normal:new b("normal","float",3,"NORMAL"),tangent:new b("tangent","float",4,"TANGENT"),color:new b("color","float",4,"COLOR"),weight:new b("weight","float",3,"WEIGHT"),joint:new b("joint","float",4,"JOINT"),barycentric:new b("barycentric","float",3,null)},boundingBox:null}}),{mainAttribute:"position",updateBoundingBox:function(){var t=this.boundingBox;t||(t=this.boundingBox=new a.A);var e=this.attributes.position.value;if(e&&e.length){var r=t.min,i=t.max,s=r.array,o=i.array;n.A.set(s,e[0],e[1],e[2]),n.A.set(o,e[0],e[1],e[2]);for(var u=3;u<e.length;){var h=e[u++],f=e[u++],c=e[u++];h<s[0]&&(s[0]=h),f<s[1]&&(s[1]=f),c<s[2]&&(s[2]=c),h>o[0]&&(o[0]=h),f>o[1]&&(o[1]=f),c>o[2]&&(o[2]=c)}r._dirty=!0,i._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var t=this.indices,e=this.attributes,r=e.position.value,s=e.normal.value;if(s&&s.length===r.length)for(var a=0;a<s.length;a++)s[a]=0;else s=e.normal.value=new i.A.Float32Array(r.length);for(var o,u,h,f=m(),c=m(),l=m(),d=m(),v=m(),_=m(),A=t?t.length:this.vertexCount,p=0;p<A;){t?(o=t[p++],u=t[p++],h=t[p++]):(o=p++,u=p++,h=p++),g(f,r[3*o],r[3*o+1],r[3*o+2]),g(c,r[3*u],r[3*u+1],r[3*u+2]),g(l,r[3*h],r[3*h+1],r[3*h+2]),n.A.sub(d,f,c),n.A.sub(v,c,l),n.A.cross(_,d,v);for(a=0;a<3;a++)s[3*o+a]=s[3*o+a]+_[a],s[3*u+a]=s[3*u+a]+_[a],s[3*h+a]=s[3*h+a]+_[a]}for(a=0;a<s.length;)g(_,s[a],s[a+1],s[a+2]),n.A.normalize(_,_),s[a++]=_[0],s[a++]=_[1],s[a++]=_[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var t=this.indices,e=this.attributes,r=e.position.value,i=e.normal.value,s=m(),a=m(),o=m(),u=m(),h=m(),f=m();i||(i=e.normal.value=new Float32Array(r.length));for(var c,l,d,v=t?t.length:this.vertexCount,_=0;_<v;){t?(c=t[_++],l=t[_++],d=t[_++]):(c=_++,l=_++,d=_++),g(s,r[3*c],r[3*c+1],r[3*c+2]),g(a,r[3*l],r[3*l+1],r[3*l+2]),g(o,r[3*d],r[3*d+1],r[3*d+2]),n.A.sub(u,s,a),n.A.sub(h,a,o),n.A.cross(f,u,h),n.A.normalize(f,f);for(var A=0;A<3;A++)i[3*c+A]=f[A],i[3*l+A]=f[A],i[3*d+A]=f[A]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var t=this.vertexCount,e=this.attributes;e.tangent.value||(e.tangent.value=new Float32Array(4*t));var r=e.texcoord0.value,i=e.position.value,s=e.tangent.value,a=e.normal.value;if(r){for(var o=[],u=[],h=0;h<t;h++)o[h]=[0,0,0],u[h]=[0,0,0];var f,c,l,d=[0,0,0],v=[0,0,0],_=this.indices,A=_?_.length:this.vertexCount;for(h=0;h<A;){_?(f=_[h++],c=_[h++],l=_[h++]):(f=h++,c=h++,l=h++);var g=r[2*f],b=r[2*c],T=r[2*l],y=r[2*f+1],x=r[2*c+1],w=r[2*l+1],E=i[3*f],R=i[3*c],D=i[3*l],C=i[3*f+1],N=i[3*c+1],B=i[3*l+1],S=i[3*f+2],M=i[3*c+2],I=i[3*l+2],U=R-E,L=D-E,P=N-C,F=B-C,O=M-S,W=I-S,j=b-g,k=T-g,H=x-y,G=w-y,K=1/(j*G-H*k);d[0]=(G*U-H*L)*K,d[1]=(G*P-H*F)*K,d[2]=(G*O-H*W)*K,v[0]=(j*L-k*U)*K,v[1]=(j*F-k*P)*K,v[2]=(j*W-k*O)*K,p(o[f],o[f],d),p(o[c],o[c],d),p(o[l],o[l],d),p(u[f],u[f],v),p(u[c],u[c],v),p(u[l],u[l],v)}var z=m(),V=m(),Y=m();for(h=0;h<t;h++){Y[0]=a[3*h],Y[1]=a[3*h+1],Y[2]=a[3*h+2];var q=o[h];n.A.scale(z,Y,n.A.dot(Y,q)),n.A.sub(z,q,z),n.A.normalize(z,z),n.A.cross(V,Y,q),s[4*h]=z[0],s[4*h+1]=z[1],s[4*h+2]=z[2],s[4*h+3]=n.A.dot(V,u[h])<0?-1:1}this.dirty()}else console.warn("Geometry without texcoords can't generate tangents.")}},isUniqueVertex:function(){return!this.isUseIndices()||this.vertexCount===this.indices.length},generateUniqueVertex:function(){if(this.vertexCount&&this.indices){this.indices.length>65535&&(this.indices=new i.A.Uint32Array(this.indices));for(var t=this.attributes,e=this.indices,r=this.getEnabledAttributes(),n={},s=0;s<r.length;s++){var a=r[s];n[a]=t[a].value,t[a].init(this.indices.length)}for(var o=0,u=0;u<e.length;u++){var h=e[u];for(s=0;s<r.length;s++){a=r[s];for(var f=t[a].value,c=t[a].size,l=0;l<c;l++)f[o*c+l]=n[a][h*c+l]}e[u]=o,o++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var t=this.attributes,e=t.barycentric.value,r=this.indices;if(!e||e.length!==3*r.length){e=t.barycentric.value=new Float32Array(3*r.length);for(var i=0;i<(r?r.length:this.vertexCount/3);)for(var n=0;n<3;n++){var s=r?r[i++]:3*i+n;e[3*s+n]=1}this.dirty()}}},applyTransform:function(t){var e=this.attributes,r=e.position.value,i=e.normal.value,a=e.tangent.value;t=t.array;var o=s.A.create();s.A.invert(o,t),s.A.transpose(o,o);var u=n.A.transformMat4,h=n.A.forEach;h(r,3,0,null,u,t),i&&h(i,3,0,null,u,o),a&&h(a,4,0,null,u,o),this.boundingBox&&this.updateBoundingBox()},dispose:function(t){var e=this._cache;e.use(t.__uid__);var r=e.get("chunks");if(r)for(var i=0;i<r.length;i++){for(var n=r[i],s=0;s<n.attributeBuffers.length;s++){var a=n.attributeBuffers[s];t.gl.deleteBuffer(a.buffer)}n.indicesBuffer&&t.gl.deleteBuffer(n.indicesBuffer.buffer)}if(this.__vaoCache){var o=t.getGLExtension("OES_vertex_array_object");for(var u in this.__vaoCache){var h=this.__vaoCache[u].vao;h&&o.deleteVertexArrayOES(h)}}this.__vaoCache={},e.deleteContext(t.__uid__)}});T.STATIC_DRAW=A.STATIC_DRAW,T.DYNAMIC_DRAW=A.DYNAMIC_DRAW,T.STREAM_DRAW=A.STREAM_DRAW,T.AttributeBuffer=A.AttributeBuffer,T.IndicesBuffer=A.IndicesBuffer,T.Attribute=b;var y=T},94809:function(t,e,r){var i=r(55393),n=r(50296),s=r(80590);n.A["import"](s.A);var a=i.A.extend((function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}}),{type:"",clone:function(){var t=i.A.prototype.clone.call(this);return t.color=Array.prototype.slice.call(this.color),t.intensity=this.intensity,t.castShadow=this.castShadow,t.shadowResolution=this.shadowResolution,t}});e.A=a},5148:function(t,e,r){r(44114);var i=r(49350),n=r(51869),s=r(11522),a=s.A.parseToFloat,o={};function u(t){var e=Object.keys(t);e.sort();for(var r=[],i=0;i<e.length;i++){var n=e[i],s=t[n];null===s?r.push(n):r.push(n+" "+s.toString())}return r.join("\n")}function h(t,e,r){r.sort();for(var i=[],s=0;s<r.length;s++){var a=r[s];i.push(a)}var h=u(t)+"\n"+u(e)+"\n"+i.join("\n");if(o[h])return o[h];var f=n.A.genGUID();return o[h]=f,f}var f=i.A.extend((function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}}),(function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)}),{precision:"highp",setUniform:function(t,e){void 0===e&&console.warn('Uniform value "'+t+'" is undefined');var r=this.uniforms[t];r&&("string"===typeof e&&(e=a(e)||e),r.value=e,this.autoUpdateTextureStatus&&"t"===r.type&&(e?this.enableTexture(t):this.disableTexture(t)))},setUniforms:function(t){for(var e in t){var r=t[e];this.setUniform(e,r)}},isUniformEnabled:function(t){return this._enabledUniforms.indexOf(t)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(t,e){if("object"===typeof t)for(var r in t){var i=t[r];this.setUniform(r,i)}else this.setUniform(t,e)},get:function(t){var e=this.uniforms[t];if(e)return e.value},attachShader:function(t,e){var r=this.uniforms;this.uniforms=t.createUniforms(),this.shader=t;var i=this.uniforms;this._enabledUniforms=Object.keys(i),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter((function(t){var e=this.uniforms[t].type;return"t"===e||"tv"===e}),this);var s=this.vertexDefines,a=this.fragmentDefines;if(this.vertexDefines=n.A.clone(t.vertexDefines),this.fragmentDefines=n.A.clone(t.fragmentDefines),e){for(var o in r)i[o]&&(i[o].value=r[o].value);n.A.defaults(this.vertexDefines,s),n.A.defaults(this.fragmentDefines,a)}var u={};for(var h in t.textures)u[h]={shaderType:t.textures[h].shaderType,type:t.textures[h].type,enabled:!(!e||!this._textureStatus[h])&&this._textureStatus[h].enabled};this._textureStatus=u,this._programKey=""},clone:function(){var t=new this.constructor({name:this.name,shader:this.shader});for(var e in this.uniforms)t.uniforms[e].value=this.uniforms[e].value;return t.depthTest=this.depthTest,t.depthMask=this.depthMask,t.transparent=this.transparent,t.blend=this.blend,t.vertexDefines=n.A.clone(this.vertexDefines),t.fragmentDefines=n.A.clone(this.fragmentDefines),t.enableTexture(this.getEnabledTextures()),t.precision=this.precision,t},define:function(t,e,r){var i=this.vertexDefines,n=this.fragmentDefines;"vertex"!==t&&"fragment"!==t&&"both"!==t&&arguments.length<3&&(r=e,e=t,t="both"),r=null!=r?r:null,"vertex"!==t&&"both"!==t||i[e]!==r&&(i[e]=r,this._programKey=""),"fragment"!==t&&"both"!==t||n[e]!==r&&(n[e]=r,"both"!==t&&(this._programKey=""))},undefine:function(t,e){"vertex"!==t&&"fragment"!==t&&"both"!==t&&arguments.length<2&&(e=t,t="both"),"vertex"!==t&&"both"!==t||this.isDefined("vertex",e)&&(delete this.vertexDefines[e],this._programKey=""),"fragment"!==t&&"both"!==t||this.isDefined("fragment",e)&&(delete this.fragmentDefines[e],"both"!==t&&(this._programKey=""))},isDefined:function(t,e){switch(t){case"vertex":return void 0!==this.vertexDefines[e];case"fragment":return void 0!==this.fragmentDefines[e]}},getDefine:function(t,e){switch(t){case"vertex":return this.vertexDefines[e];case"fragment":return this.fragmentDefines[e]}},enableTexture:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.enableTexture(t[e]);else{var r=this._textureStatus[t];if(r){var i=r.enabled;i||(r.enabled=!0,this._programKey="")}}},enableTexturesAll:function(){var t=this._textureStatus;for(var e in t)t[e].enabled=!0;this._programKey=""},disableTexture:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.disableTexture(t[e]);else{var r=this._textureStatus[t];if(r){var i=!r.enabled;i||(r.enabled=!1,this._programKey="")}}},disableTexturesAll:function(){var t=this._textureStatus;for(var e in t)t[e].enabled=!1;this._programKey=""},isTextureEnabled:function(t){var e=this._textureStatus;return!!e[t]&&e[t].enabled},getEnabledTextures:function(){var t=[],e=this._textureStatus;for(var r in e)e[r].enabled&&t.push(r);return t},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=h(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}});e.A=f},83992:function(t,e,r){var i=r(85253),n=r(21639),s=i.A.extend({skeleton:null,joints:null},(function(){this.joints||(this.joints=[])}),{offsetMatrix:null,isInstancedMesh:function(){return!1},isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var t=i.A.prototype.clone.call(this);return t.skeleton=this.skeleton,this.joints&&(t.joints=this.joints.slice()),t}});s.POINTS=n.A.POINTS,s.LINES=n.A.LINES,s.LINE_LOOP=n.A.LINE_LOOP,s.LINE_STRIP=n.A.LINE_STRIP,s.TRIANGLES=n.A.TRIANGLES,s.TRIANGLE_STRIP=n.A.TRIANGLE_STRIP,s.TRIANGLE_FAN=n.A.TRIANGLE_FAN,s.BACK=n.A.BACK,s.FRONT=n.A.FRONT,s.FRONT_AND_BACK=n.A.FRONT_AND_BACK,s.CW=n.A.CW,s.CCW=n.A.CCW,e.A=s},55393:function(t,e,r){r(44114);var i=r(49350),n=r(504),s=r(30630),a=r(21647),o=r(87064),u=r(47797),h=0,f=i.A.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},(function(){this.name||(this.name=(this.type||"NODE")+"_"+h++),this.position||(this.position=new n.A),this.rotation||(this.rotation=new s.A),this.scale||(this.scale=new n.A(1,1,1)),this.worldTransform=new a.A,this.localTransform=new a.A,this._children=[]}),{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(t){var e=this._scene;if(e){var r=e._nodeRepository;delete r[this.name],r[t]=this}this.name=t},add:function(t){var e=t._parent;if(e!==this){e&&e.remove(t),t._parent=this,this._children.push(t);var r=this._scene;r&&r!==t.scene&&t.traverse(this._addSelfToScene,this),t._needsUpdateWorldTransform=!0}},remove:function(t){var e=this._children,r=e.indexOf(t);r<0||(e.splice(r,1),t._parent=null,this._scene&&t.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var t=this._children,e=0;e<t.length;e++)t[e]._parent=null,this._scene&&t[e].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(t){t._scene.removeFromScene(t),t._scene=null},_addSelfToScene:function(t){this._scene.addToScene(t),t._scene=this._scene},isAncestor:function(t){var e=t._parent;while(e){if(e===this)return!0;e=e._parent}return!1},children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},getChildByName:function(t){for(var e=this._children,r=0;r<e.length;r++)if(e[r].name===t)return e[r]},getDescendantByName:function(t){for(var e=this._children,r=0;r<e.length;r++){var i=e[r];if(i.name===t)return i;var n=i.getDescendantByName(t);if(n)return n}},queryNode:function(t){if(t){for(var e=t.split("/"),r=this,i=0;i<e.length;i++){var n=e[i];if(n){for(var s=!1,a=r._children,o=0;o<a.length;o++){var u=a[o];if(u.name===n){r=u,s=!0;break}}if(!s)return}}return r}},getPath:function(t){if(!this._parent)return"/";var e=this._parent,r=this.name;while(e._parent){if(r=e.name+"/"+r,e._parent==t)break;e=e._parent}return!e._parent&&t?null:r},traverse:function(t,e){t.call(e,this);for(var r=this._children,i=0,n=r.length;i<n;i++)r[i].traverse(t,e)},eachChild:function(t,e){for(var r=this._children,i=0,n=r.length;i<n;i++){var s=r[i];t.call(e,s,i)}},setLocalTransform:function(t){o.A.copy(this.localTransform.array,t.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(t){var e=t?null:this.scale;this.localTransform.decomposeMatrix(e,this.rotation,this.position)},setWorldTransform:function(t){o.A.copy(this.worldTransform.array,t.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var t=o.A.create();return function(e){var r=this.localTransform,i=this.worldTransform;this._parent?(o.A.invert(t,this._parent.worldTransform.array),o.A.multiply(r.array,t,i.array)):o.A.copy(r.array,i.array);var n=e?null:this.scale;r.decomposeMatrix(n,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var t=this.position,e=this.rotation,r=this.scale;if(this.transformNeedsUpdate()){var i=this.localTransform.array;o.A.fromRotationTranslation(i,e.array,t.array),o.A.scale(i,i,r.array),e._dirty=!1,r._dirty=!1,t._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var t=this.localTransform.array,e=this.worldTransform.array;this._parent?o.A.multiplyAffine(e,this._parent.worldTransform.array,t):o.A.copy(e,t)},updateWorldTransform:function(){var t=this;while(t&&t.getParent()&&t.getParent().transformNeedsUpdate())t=t.getParent();t.update()},update:function(t){this.autoUpdateLocalTransform?this.updateLocalTransform():t=!0,(t||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),t=!0,this._needsUpdateWorldTransform=!1);for(var e=this._children,r=0,i=e.length;r<i;r++)e[r].update(t)},getBoundingBox:function(){function t(t){return!t.invisible&&t.geometry}var e=new u.A,r=new a.A,i=new a.A;return function(n,s){return s=s||new u.A,n=n||t,this._parent?a.A.invert(i,this._parent.worldTransform):a.A.identity(i),this.traverse((function(t){t.geometry&&t.geometry.boundingBox&&(e.copy(t.geometry.boundingBox),a.A.multiply(r,i,t.worldTransform),e.applyTransform(r),s.union(e))}),this,t),s}}(),getWorldPosition:function(t){this.transformNeedsUpdate()&&this.updateWorldTransform();var e=this.worldTransform.array;if(t){var r=t.array;return r[0]=e[12],r[1]=e[13],r[2]=e[14],t}return new n.A(e[12],e[13],e[14])},clone:function(){var t=new this.constructor,e=this._children;t.setName(this.name),t.position.copy(this.position),t.rotation.copy(this.rotation),t.scale.copy(this.scale);for(var r=0;r<e.length;r++)t.add(e[r].clone());return t},rotateAround:function(){var t=new n.A,e=new a.A;return function(r,i,n){t.copy(this.position).subtract(r);var s=this.localTransform;s.identity(),s.translate(r),s.rotate(n,i),e.fromRotationTranslation(this.rotation,t),s.multiply(e),s.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var t=new a.A;return function(e,r){t.lookAt(this.position,e,r||this.localTransform.y).invert(),this.setLocalTransform(t),this.target=e}}()});e.A=f}}]);
//# sourceMappingURL=chunk-vendors-555cab3e.7c215efa.js.map