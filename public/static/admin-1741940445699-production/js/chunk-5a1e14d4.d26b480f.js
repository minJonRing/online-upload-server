(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a1e14d4"],{"40be":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"equip-type scroll"},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleAddOrEdit({handle:"add"})}}},[e._v("新增")]),l("div",{staticClass:"divider"}),l("el-table",{attrs:{data:e.table,border:""}},[l("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[l("div",{staticStyle:{padding:"6px 6px 0 6px"}},e._l(a.child||[],(function(t,a){return l("el-descriptions",{key:a,staticStyle:{"margin-bottom":"6px"},attrs:{column:2,border:""}},[l("el-descriptions-item",{attrs:{label:"装备key"}},[e._v(e._s(t.key))]),l("el-descriptions-item",{attrs:{label:"装备名称"}},[e._v(e._s(t.label))]),l("el-descriptions-item",{attrs:{label:"皮肤"}},e._l(t.skins,(function(e,t){return l("el-image",{key:t,style:{width:"45px",height:"30px","margin-right":"10px"},attrs:{src:e.link,fit:"contain"}})})),1)],1)})),1)]}}])}),l("el-table-column",{attrs:{label:"key",prop:"key"}}),l("el-table-column",{attrs:{label:"名称",prop:"label"}}),l("el-table-column",{attrs:{label:"创建时间",prop:"createdTime",width:"200"}}),l("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[l("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAddOrEdit({handle:"edit",data:a})}}},[e._v(" 编辑 ")]),l("el-popconfirm",{staticClass:"ml10",attrs:{title:"确定删除？",placement:"top"},on:{confirm:function(t){return e.handleDelete(a)}}},[l("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])})],1),l("el-dialog",{attrs:{title:"新增/编辑",visible:e.isShow,width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[l("div",{staticClass:"scroll",staticStyle:{"padding-top":"18px","max-height":"600px"}},[l("el-form",{ref:"form",attrs:{model:e.editForm,rules:e.editRules,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"key",prop:"key"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.editForm.key,callback:function(t){e.$set(e.editForm,"key",t)},expression:"editForm.key"}})],1),l("el-form-item",{attrs:{label:"名称",prop:"label"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.editForm.label,callback:function(t){e.$set(e.editForm,"label",t)},expression:"editForm.label"}})],1),l("el-form-item",{attrs:{label:"装备"}},[l("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{icon:"el-icon-plus"},on:{click:e.handleAddChild}}),e._l(e.editForm.child,(function(t,a){return l("div",{key:a},[l("div",{staticClass:"key-label"},[l("div",{staticStyle:{"padding-bottom":"18px"}},[l("el-button",{attrs:{icon:"el-icon-delete"}})],1),l("el-form-item",{attrs:{label:"装备key"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:t.key,callback:function(l){e.$set(t,"key",l)},expression:"item.key"}})],1),l("el-form-item",{attrs:{label:"装备名称"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:t.label,callback:function(l){e.$set(t,"label",l)},expression:"item.label"}})],1)],1),l("div",{staticClass:"skins"},[l("el-form-item",{attrs:{label:"皮肤"}},[l("div",{staticStyle:{display:"flex"}},e._l(t.skins,(function(t,a){return l("Upload",{key:a,staticStyle:{"margin-right":"10px"},attrs:{url:"/upload/image",width:"45px",height:"30px"},model:{value:t.link,callback:function(l){e.$set(t,"link",l)},expression:"i.link"}})})),1)])],1)])}))],2)],1)],1),l("span",{attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.isShow=!1}}},[e._v("取消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.handleComfirn}},[e._v("确认")])],1)])],1)},i=[],n=l("5530"),o=(l("4ec9"),l("b64b"),l("d3b7"),l("6062"),l("0eb6"),l("b7ef"),l("8bd4"),l("ad1f"),l("14d9"),l("2f62")),r=l("4279"),s=l("0238"),d=l("b81f"),c={name:"ProjectIndex",props:{noBtns:{type:Array,default:function(){return[]}},otherBtns:s["rulesT"].Array,selection:s["rulesT"].Array},components:{Upload:d["a"]},data:function(){return{table:[],isShow:!1,editForm:{key:"",label:"",child:[]},editRules:{key:s["blur"],label:s["blur"]},editFormInit:{}}},computed:Object(n["a"])({},Object(o["b"])([])),created:function(){this.editFormInit=structuredClone(this.editForm),this.handleSearch()},methods:{handleSearch:function(){var e=this;this.$global.loading=!0,Object(r["a"])({url:"/client/weixin/getEquipType"}).then((function(t){var l=t.data;e.table=l})).finally((function(){e.$global.loading=!1}))},handleAddOrEdit:function(e){var t=e.handle,l=e.data,a=l;"add"===t&&(a=structuredClone(this.editFormInit)),this.editForm=structuredClone(a),this.isShow=!0},handleAddChild:function(){this.editForm.child.push({key:"",label:"",skins:[{key:"sk1",link:""},{key:"sk2",link:""},{key:"sk3",link:""},{key:"sk4",link:""}]})},handleDelete:function(e){var t=this,l=e._id;this.$global.loading=!0,Object(r["a"])({url:"/client/weixin/getEquipType/".concat(l),method:"delete"}).then((function(){t.$notify.success("删除成功"),t.handleSearch()})).finally((function(){t.$global.loading=!1}))},handleComfirn:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$notify.warning("必填项未填写完整，请检查！"),!1;e.$global.loading=!0;var l=e.editForm._id;if(l){var a=e.editForm,i=a.key,n=a.label,o=a.child,s={key:i,label:n,child:o};Object(r["a"])({url:"/client/weixin/getEquipType/".concat(l),method:"put",data:s}).then((function(){e.handleSearch(),e.isShow=!1})).finally((function(){e.$global.loading=!1}))}else Object(r["a"])({url:"/client/weixin/getEquipType",method:"post",data:e.editForm}).then((function(){e.handleSearch(),e.isShow=!1})).finally((function(){e.$global.loading=!1}))}))}}},u=c,p=(l("ef66"),l("2877")),h=Object(p["a"])(u,a,i,!1,null,"6cab4992",null);t["default"]=h.exports},"5e37":function(e,t,l){},7907:function(e,t,l){},b81f:function(e,t,l){"use strict";var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"e-upload"},[l("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"e-avatar-uploader",style:{width:e.cwidth,height:e.height},attrs:{"show-file-list":!1,"element-loading-text":e.progress+"%",action:"#","before-upload":e.beforeAvatarUpload,"http-request":e.handleUploadLearnSignVoucherFileChange,"attr-icon":"注:只能上传"+e.type.join()}},[e.image?l("img",{ref:"img",staticClass:"image",attrs:{src:e.image}}):l("i",{staticClass:"el-icon el-icon-upload2"})])],1)},i=[],n=l("5530"),o=(l("a9e3"),l("4de4"),l("d3b7"),l("ac1f"),l("00b4"),l("4d63"),l("c607"),l("2c3e"),l("25f0"),l("5319"),l("b0c0"),l("a15b"),l("b64b"),l("d81d"),l("0238")),r=l("2f62"),s={name:"UploadProT",props:{model:o["rulesT"].Any,read:o["rulesT"].Boolean,url:o["rulesT"].String,deleteUrl:o["rulesT"].String,type:{type:Array,default:function(){return["image"]}},size:{type:Number,default:80},param:o["rulesT"].Object,filterData:{type:Function},width:{type:String,default:"100px"},height:{type:String,default:"100px"},auto:{type:Boolean,default:!1}},model:{prop:"model",event:"change"},data:function(){return{loading:!1,progress:0,cwidth:this.width}},computed:Object(n["a"])({image:{get:function(){return this.model},set:function(e){this.$emit("change",e)}}},Object(r["b"])(["local"])),created:function(){},methods:{beforeAvatarUpload:function(e){var t=this.type.filter((function(t){return new RegExp(t).test(e.type)||t===e.name.replace(/.+(?=\.)|\./g,"")})).length>0,l=e.size/1024/1024<this.size;return t||this.$message.error("请上传格式正确的文件 [ ".concat(this.type.join(",")," ] ")),l||this.$message.error("上传文件大小不能超过".concat(this.size,"MB!")),t&&l},handleUploadLearnSignVoucherFileChange:function(e){var t=this;this.$global.loading=!0;var l=e.file,a=new FormData;a.append("file",l);var i=Object.keys(this.param);i.length&&i.map((function(e){a.append(e,t.param[e])})),this.$AJAX({url:this.url,method:"post",data:a,onUploadProgress:function(e){var l=e.loaded,a=e.total;t.progress=Math.ceil(l/a*100)}}).then((function(e){var l=e.data,a=l[0].filePath;t.image=a})).finally((function(){t.$global.loading=!1}))},handleDelete:function(e,t){this.image=""}}},d=s,c=(l("d1b2"),l("2877")),u=Object(c["a"])(d,a,i,!1,null,"38bc8108",null);t["a"]=u.exports},d1b2:function(e,t,l){"use strict";l("5e37")},ef66:function(e,t,l){"use strict";l("7907")}}]);